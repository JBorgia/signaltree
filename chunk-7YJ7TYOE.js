import{a as Qe,b as Xe,c as Ze,d as et,e as tt,f as K,h as nt,j as rt,n as it,o as ot,p as at,q as st,r as lt,s as ct,t as dt,w as Y,y as mt}from"./chunk-SQ32NL3S.js";import{a as G,b as ut,d as pt}from"./chunk-KKPYYAQN.js";import{$b as ve,Ab as N,Cb as w,Dc as Je,Hb as ye,Ib as $e,Ja as c,Jb as j,Lb as a,Mb as R,Nb as x,Oa as We,Sa as Be,X as De,Ya as Le,Yb as Ge,_a as Ue,ab as h,ac as he,ba as re,cc as xe,gc as S,ha as U,hc as qe,ia as $,na as je,ob as p,p as me,pb as s,qb as i,ra as pe,rb as M,s as ue,sa as k,vb as ge,wb as fe,xc as He,ya as ze,yb as be,yc as Ke,zc as Ye}from"./chunk-HZTNVCQU.js";import{a as H,d as Ie,j as O}from"./chunk-A3ECCK3J.js";function Ce(t,e){if(t===e)return!0;let n=t.split("."),r=e.split(".");return n.length!==r.length?!1:n.every((o,l)=>o==="*"||o===r[l])}function _e(t,e){if(!e||typeof e!="object")return t;let n=t,r=e;for(let[o,l]of Object.entries(r)){if(l===void 0)continue;let d=n[o];if(gt(d)&&gt(l)){n[o]=_e(G(d),l);continue}n[o]=G(l)}return t}function gt(t){return!!t&&typeof t=="object"&&!Array.isArray(t)&&Object.prototype.toString.call(t)==="[object Object]"}var J=class extends Error{constructor(n,r){super("Form validation failed");this.errors=n;this.asyncErrors=r;this.name="FormValidationError"}},vt="signaltree",we="signaltreeAsync";function ht(t,e={}){let Re=e,{validators:n={},asyncValidators:r={},destroyRef:o,fieldConfigs:l={},conditionals:d=[],persistKey:g,storage:b,persistDebounceMs:f=100,validationBatchMs:C=0}=Re,I=Ie(Re,["validators","asyncValidators","destroyRef","fieldConfigs","conditionals","persistKey","storage","persistDebounceMs","validationBatchMs"]),D=jt(n,l),_=zt(r,l),{values:A}=Wt(t,g,b),ae=G(A),B=pt(A,I);Bt(B.state);let y=B.state;xt(y);let u=ie(A,"",D,_),Fe=o??Dt(),L=[],Q=k({}),X=k({}),Pe=k({}),ke=k({}),Me=k(u.dirty),se=k(u.valid&&!u.pending),Z=k(!1),Oe=()=>{let m=It(u);Q.set(m.syncErrors),X.set(m.asyncErrors),Pe.set(m.touched),ke.set(m.pending),Me.set(u.dirty),se.set(u.valid&&!u.pending)},V=null,T=(m=!1)=>{if(m||C<=0){V&&(clearTimeout(V),V=null),Oe();return}V&&clearTimeout(V),V=setTimeout(()=>{V=null,Oe()},C)};T(!0);let ee=Ut(u,g,b,f,L);ee.persistImmediately();let Tt=new Set([...Object.keys(D),...Object.keys(_)]),le={},ce={};Tt.forEach(m=>{le[m]=S(()=>Q()[m]),ce[m]=S(()=>X()[m])});let Ft=m=>Lt(l,m),te=(m,v)=>{if(m instanceof K){Object.entries(m.controls).forEach(([E,P])=>{te(P,z(v,E))});return}if(m instanceof Y){let E=Ee(y,v);E&&Rt(m,E,v,D,_,L,te),m.controls.forEach((P,q)=>{te(P,z(v,String(q)))});return}let F=Ee(y,v);F&&Nt(m,F,L,Ft(v))};te(u,"");let Ve=new Map,de=d.length>0?()=>{let m=u.getRawValue();d.forEach(({when:v,fields:F})=>{let E=!0;try{E=v(m)}catch{E=!0}F.forEach(P=>{let q=u.get(P);!q||Ve.get(P)===E||(Ve.set(P,E),E?q.enable({emitEvent:!1}):q.disable({emitEvent:!1}))})})}:()=>{};de();let ne=[];ne.push(u.valueChanges.subscribe(()=>{T(),ee.schedulePersist(),de()})),ne.push(u.statusChanges.subscribe(()=>T())),u.events&&ne.push(u.events.subscribe(()=>T())),L.push(()=>{ne.forEach(m=>m.unsubscribe()),V&&clearTimeout(V)}),Fe&&Fe.onDestroy(()=>{L.splice(0).forEach(m=>m())});let Ae=(m,v)=>{let F=Ee(y,m),E=u.get(m);if(F&&"set"in F?F.set(v):E&&E.setValue(v,{emitEvent:!0}),E){let P=E;P.markAsTouched(),P.markAsDirty(),P.updateValueAndValidity({emitEvent:!0})}T(!0),ee.schedulePersist()},Pt=m=>{Object.entries(m).forEach(([v,F])=>{Ae(v,F)})},kt=()=>{u.reset(ae),Z.set(!1),T(!0),ee.persistImmediately(),de()},Ne=m=>O(null,null,function*(){if(m){let v=u.get(m);if(!v)return;v.markAsTouched(),v.updateValueAndValidity({emitEvent:!0}),T(!0),yield ft(v),T(!0);return}u.markAllAsTouched(),u.updateValueAndValidity({emitEvent:!0}),T(!0),yield ft(u),T(!0)});return{state:y,$:y,form:u,errors:Q,asyncErrors:X,touched:Pe,asyncValidating:ke,dirty:Me,valid:se,submitting:Z,unwrap:()=>B(),setValue:Ae,setValues:Pt,reset:kt,submit:m=>O(null,null,function*(){Z.set(!0);try{if(yield Ne(),!se())throw new J(Q(),X());let v=u.getRawValue();return yield m(v)}finally{Z.set(!1),T(!0)}}),validate:Ne,getFieldError:m=>le[m]||S(()=>{}),getFieldAsyncError:m=>ce[m]||S(()=>{}),getFieldTouched:m=>S(()=>u.get(m)?.touched??!1),isFieldValid:m=>S(()=>{let v=u.get(m);return!!v&&v.valid&&!v.pending}),isFieldAsyncValidating:m=>S(()=>!!u.get(m)?.pending),fieldErrors:le,fieldAsyncErrors:ce,values:B,destroy:()=>{L.splice(0).forEach(m=>m())}}}function xt(t,e=new WeakSet){if(!e.has(t)){e.add(t);for(let n in t){let r=t[n];if(pe(r)){let o=r();Array.isArray(o)&&(t[n]=Ot(r))}else typeof r=="object"&&r!==null&&!Array.isArray(r)&&xt(r,e)}}}var Ot=t=>{let e=t;return e.push=n=>{t.update(r=>[...r,n])},e.removeAt=n=>{t.update(r=>r.filter((o,l)=>l!==n))},e.setAt=(n,r)=>{t.update(o=>o.map((l,d)=>d===n?r:l))},e.insertAt=(n,r)=>{t.update(o=>[...o.slice(0,n),r,...o.slice(n)])},e.move=(n,r)=>{t.update(o=>{let l=[...o],[d]=l.splice(n,1);return d!==void 0&&l.splice(r,0,d),l})},e.clear=()=>{t.set([])},e};function Ee(t,e){if(!e)return null;let n=ut(e),r=t;for(let o of n){if(!r||typeof r!="object")return null;r=r[o]}return pe(r)?r:null}function z(t,e){return t?`${t}.${e}`:e}function Vt(t){return e=>{let n=t(e.value);return n?{[vt]:n}:null}}function At(t){return e=>O(null,null,function*(){try{let n=t(e.value),r=me(n)?yield ue(n):yield n;return r?{[we]:r}:null}catch{return{[we]:"Validation error"}}})}function ie(t,e,n,r){let o=bt(n,e),l=bt(r,e),d=o?[Vt(o)]:void 0,g=l?[At(l)]:void 0;if(Array.isArray(t)){let b=t.map((f,C)=>ie(f,z(e,String(C)),n,r));return new Y(b,d,g)}if(Ct(t)){let b={};for(let[f,C]of Object.entries(t))b[f]=ie(C,z(e,f),n,r);return new K(b,{validators:d,asyncValidators:g})}return new nt(t,{validators:d,asyncValidators:g,nonNullable:!1})}function Nt(t,e,n,r){let o=t.connect;if(typeof o=="function")try{let y=o.call(t,e);y&&typeof y.unsubscribe=="function"&&n.push(()=>y.unsubscribe());return}catch{}let l=!1,d=!1,g=0,b=0,f=null,C=r?.debounceMs??0,I=e.set.bind(e),D=e.update.bind(e),_=y=>{if(d=!0,!Object.is(t.value,y)){let u=t;u.setValue(y,{emitEvent:!0}),u.markAsDirty()}d=!1};e.set=y=>{let u=++g;I(y),!l&&(b>u||_(y))},e.update=y=>{let u=y(e());e.set(u)};let A=y=>{l=!0,b=++g,I(y),l=!1},ae=y=>{if(!d){if(C>0){f&&clearTimeout(f),f=setTimeout(()=>{f=null,A(y)},C);return}A(y)}},B=t.valueChanges.subscribe(y=>{ae(y)});n.push(()=>{B.unsubscribe(),e.set=I,e.update=D,f&&clearTimeout(f)})}function Rt(t,e,n,r,o,l,d){let g=t.connect;if(typeof g=="function")try{let _=g.call(t,e);_&&typeof _.unsubscribe=="function"&&l.push(()=>_.unsubscribe());return}catch{}let b=!1,f=!1,C=e.set.bind(e),I=e.update.bind(e);e.set=_=>{C(_),!b&&(f=!0,Se(t,_,n,r,o,d),t.markAsDirty(),f=!1)},e.update=_=>{let A=_(e());e.set(A)};let D=t.valueChanges.subscribe(_=>{f||(b=!0,C(_),b=!1)});l.push(()=>{D.unsubscribe(),e.set=C,e.update=I}),Se(t,e(),n,r,o,d)}function Se(t,e,n,r,o,l){for(Array.isArray(e)||(e=[]);t.length>e.length;)t.removeAt(t.length-1);e.forEach((d,g)=>{let b=z(n,String(g)),f=t.at(g);if(!f){let C=ie(d,b,r,o);t.insert(g,C),l(C,b);return}if(f instanceof Y){Se(f,Array.isArray(d)?d:[],b,r,o,l);return}if(f instanceof K){Ct(d)&&f.setValue(d,{emitEvent:!1});return}Object.is(f.value,d)||f.setValue(d,{emitEvent:!1})})}function It(t){let e={syncErrors:{},asyncErrors:{},touched:{},pending:{}};return Te(t,(n,r)=>{if(!n)return;r.touched&&(e.touched[n]=!0),r.pending&&(e.pending[n]=!0);let o=r.errors;if(!o)return;let l=o[vt];typeof l=="string"&&(e.syncErrors[n]=l);let d=o[we];typeof d=="string"&&(e.asyncErrors[n]=d)},""),e}function Te(t,e,n=""){if(e(n,t),t instanceof K){Object.entries(t.controls).forEach(([r,o])=>{Te(o,e,z(n,r))});return}t instanceof Y&&t.controls.forEach((r,o)=>{Te(r,e,z(n,String(o)))})}function ft(t){return t.pending?new Promise(e=>{let n=t.statusChanges.subscribe(()=>{t.pending||(n.unsubscribe(),e())})}):Promise.resolve()}function Ct(t){return!!t&&typeof t=="object"&&!Array.isArray(t)&&Object.prototype.toString.call(t)==="[object Object]"}function Dt(){try{return re(je)}catch{return null}}function jt(t,e){let n=new Map;for(let[o,l]of Object.entries(t)){let d=n.get(o)??[];d.push(l),n.set(o,d)}for(let[o,l]of Object.entries(e)){let d=_t(l.validators);if(d.length===0)continue;let g=n.get(o)??[];g.push(...d),n.set(o,g)}let r={};return n.forEach((o,l)=>{r[l]=d=>{for(let g of o){let b=g(d);if(b)return b}return null}}),H(H({},t),r)}function zt(t,e){let n=new Map;for(let[o,l]of Object.entries(t)){let d=n.get(o)??[];d.push(l),n.set(o,d)}for(let[o,l]of Object.entries(e)){let d=_t(l.asyncValidators);if(d.length===0)continue;let g=n.get(o)??[];g.push(...d),n.set(o,g)}let r={};return n.forEach((o,l)=>{r[l]=d=>O(null,null,function*(){for(let g of o){let b=g(d),f=me(b)?yield ue(b):yield b;if(f)return f}return null})}),H(H({},t),r)}function _t(t){return t?Array.isArray(t)?t:Object.values(t):[]}function Wt(t,e,n){let r=G(t);if(!e||!n)return{values:r};try{let o=n.getItem(e);if(!o)return{values:r};let l=JSON.parse(o);return{values:_e(r,l)}}catch{return{values:r}}}function Bt(t){if(!t||typeof t!="object")throw new Error("Invalid state structure for form tree")}function Lt(t,e){if(t[e])return t[e];let n=Object.keys(t),r;for(let o of n)o.includes("*")&&Ce(o,e)&&(!r||r.key.length<o.length)&&(r={key:o,config:t[o]});return r?r.config:t["*"]}function bt(t,e){if(t[e])return t[e];let n;for(let r of Object.keys(t))r.includes("*")&&Ce(r,e)&&(!n||n.key.length<r.length)&&(n={key:r,value:t[r]});return n?n.value:t["*"]}function Ut(t,e,n,r,o){if(!e||!n)return{schedulePersist:()=>{},persistImmediately:()=>{}};let l=null,d=()=>{try{let b=JSON.stringify(t.getRawValue());n.setItem(e,b)}catch{}},g=()=>{if(r<=0){d();return}l&&clearTimeout(l),l=setTimeout(()=>{l=null,d()},r)};return o.push(()=>{l&&clearTimeout(l)}),{schedulePersist:g,persistImmediately:d}}var yt=class t{signalTreeSignalValue;signalTreeSignalValueChange=new We;elementRef=re(ze);renderer=re(Be);onChange=()=>{};onTouched=()=>{};ngOnInit(){qe(()=>{let e=this.signalTreeSignalValue();this.renderer.setProperty(this.elementRef.nativeElement,"value",e)})}handleChange(e){let r=e.target?.value;r!==void 0&&(this.signalTreeSignalValue.set(r),this.signalTreeSignalValueChange.emit(r),this.onChange(r))}handleBlur(){this.onTouched()}writeValue(e){e!==void 0&&this.signalTreeSignalValue.set(e)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.renderer.setProperty(this.elementRef.nativeElement,"disabled",e)}static \u0275fac=function(n){return new(n||t)};static \u0275dir=Ue({type:t,selectors:[["","signalTreeSignalValue",""]],hostBindings:function(n,r){n&1&&N("input",function(l){return r.handleChange(l)})("change",function(l){return r.handleChange(l)})("blur",function(){return r.handleBlur()})},inputs:{signalTreeSignalValue:"signalTreeSignalValue"},outputs:{signalTreeSignalValueChange:"signalTreeSignalValueChange"},features:[Ge([{provide:Qe,useExisting:De(()=>t),multi:!0}])]})};function W(t="Required"){return e=>e?null:t}function Et(t="Invalid email"){return e=>{let n=e;return n&&!n.includes("@")?t:null}}function oe(t,e){return n=>{let r=n,o=e??`Min ${t} characters`;return r&&r.length<t?o:null}}function wt(t,e="Invalid format"){return n=>{let r=n;return r&&!t.test(r)?e:null}}function $t(t,e){if(t&1&&(s(0,"p",58),a(1),i()),t&2){let n=w();c(),R(n.nameError)}}function Gt(t,e){t&1&&(s(0,"span",59),a(1," Validating\u2026 "),i())}function qt(t,e){if(t&1&&(s(0,"p",58),a(1),i()),t&2){let n=w();c(),R(n.emailError)}}function Ht(t,e){if(t&1&&(s(0,"p",60),a(1),i()),t&2){let n=w();c(),x(" ",n.profile.getFieldAsyncError("email")()," ")}}function Kt(t,e){t&1&&(s(0,"p",61),a(1," Switch to \u201CTeam manager\u201D to activate company planning inputs. "),i())}function Yt(t,e){if(t&1&&(s(0,"p",58),a(1),i()),t&2){let n=w();c(),x(" ",n.profile.getFieldError("company.name")()," ")}}function Jt(t,e){if(t&1&&(s(0,"option",62),a(1),i()),t&2){let n=e.$implicit;p("value",n),c(),x(" ",n," teammates ")}}function Qt(t,e){if(t&1&&(s(0,"p",58),a(1),i()),t&2){let n=w();c(),x(" ",n.profile.getFieldError("company.size")()," ")}}function Xt(t,e){if(t&1&&(s(0,"option",62),a(1),ve(2,"titlecase"),i()),t&2){let n=e.$implicit;p("value",n),c(),x(" ",he(2,2,n)," ")}}function Zt(t,e){if(t&1&&(s(0,"p",70),a(1),i()),t&2){let n=w().index,r=w();c(),R(r.phoneError(n))}}function en(t,e){if(t&1&&(s(0,"p",71),a(1),i()),t&2){let n=w().index,r=w();c(),x(" ",r.phoneAsyncError(n)," ")}}function tn(t,e){if(t&1){let n=be();s(0,"div",63)(1,"label",64),a(2,"Label"),i(),s(3,"select",65),h(4,Xt,3,4,"option",34),i(),s(5,"label",64),a(6,"Number"),i(),M(7,"input",66),s(8,"button",67),N("click",function(){let o=U(n).index,l=w();return $(l.removePhoneNumber(o))}),a(9," Remove "),i(),h(10,Zt,2,1,"p",68)(11,en,2,1,"p",69),i()}if(t&2){let n=e.index,r=w();p("formGroupName",n),c(),p("for","phone-label-"+n),c(2),p("id","phone-label-"+n),c(),p("ngForOf",r.phoneLabelOptions),c(),p("for","phone-value-"+n),c(2),p("id","phone-value-"+n),c(),p("disabled",r.phoneControls.length===1),c(2),p("ngIf",r.phoneError(n)),c(),p("ngIf",r.phoneAsyncError(n))}}function nn(t,e){if(t&1&&(s(0,"p",58),a(1),i()),t&2){let n=w();c(),x(" ",n.profile.getFieldError("notes")()," ")}}function rn(t,e){if(t&1&&(s(0,"li")(1,"code"),a(2),i(),s(3,"span"),a(4),i()()),t&2){let n=e.$implicit;c(2),R(n[0]),c(2),x("\u2014 ",n[1])}}function on(t,e){if(t&1&&(ge(0),s(1,"ul"),h(2,rn,5,2,"li",72),i(),fe()),t&2){let n=w();c(2),p("ngForOf",n.errorEntries())}}function an(t,e){if(t&1&&(s(0,"li")(1,"code"),a(2),i(),s(3,"span"),a(4),i()()),t&2){let n=e.$implicit;c(2),R(n[0]),c(2),x("\u2014 ",n[1])}}function sn(t,e){if(t&1&&(ge(0),s(1,"ul"),h(2,an,5,2,"li",72),i(),fe()),t&2){let n=w();c(2),p("ngForOf",n.asyncErrorEntries())}}function ln(t,e){if(t&1&&(s(0,"article",56)(1,"h3"),a(2,"Last Saved Payload"),i(),s(3,"p")(4,"strong"),a(5,"Name:"),i(),a(6),i(),s(7,"p")(8,"strong"),a(9,"Email:"),i(),a(10),i(),s(11,"p")(12,"strong"),a(13,"Role:"),i(),a(14),ve(15,"titlecase"),i(),s(16,"p")(17,"strong"),a(18,"Updates opt-in:"),i(),a(19),i(),s(20,"p")(21,"strong"),a(22,"Numbers:"),i(),a(23),i()()),t&2){let n=e.ngIf;c(6),x(" ",n.name),c(4),x(" ",n.email),c(4),x(" ",he(15,5,n.role)),c(5),x(" ",n.receiveUpdates?"Enabled":"Disabled"," "),c(4),x(" ",n.phoneNumbers.length," stored ")}}function cn(t,e){t&1&&(s(0,"p",61),a(1,"No sync validation issues detected."),i())}function dn(t,e){t&1&&(s(0,"p",61),a(1,"No async validation issues detected."),i())}var St=class t{storage=typeof window<"u"?window.localStorage:void 0;emailAvailabilityValidator=e=>O(null,null,function*(){let n=String(e??"").trim().toLowerCase();return n?(yield new Promise(r=>setTimeout(r,350)),n.endsWith("@example.dev")?"example.dev addresses are reserved for documentation samples":n.endsWith("@test.invalid")?"test.invalid is blocked for demo purposes":null):null});phoneLabelOptions=["work","personal","support"];companySizeOptions=["1-10","11-50","51-250","251+"];profile=ht({name:"",email:"",role:"individual",receiveUpdates:!0,company:{name:"",size:"1-10"},preferences:{newsletter:!0,productUpdates:!0,betaProgram:!1},phoneNumbers:[{label:"work",value:""}],notes:""},{persistKey:"signaltree-ng-forms-demo",storage:this.storage,validationBatchMs:120,fieldConfigs:{name:{validators:[W("Name is required"),oe(3,"Name must be at least 3 characters")]},email:{validators:[W(),Et()],asyncValidators:[this.emailAvailabilityValidator],debounceMs:180},role:{validators:[W()]},"company.name":{validators:[W("Company name is required when managing a team"),oe(2)]},"company.size":{validators:[W("Select an approximate company size")]},"phoneNumbers.*.value":{validators:[W("Phone number is required"),wt(/^[+\d ()-]{6,}$/)]},notes:{validators:[oe(10,"Share at least 10 characters about your goals")]}},conditionals:[{when:e=>e.role==="manager",fields:["company.name","company.size"]}]});status=k("idle");lastSaved=k(null);errorEntries=S(()=>Object.entries(this.profile.errors()).filter(([,e])=>!!e));asyncErrorEntries=S(()=>Object.entries(this.profile.asyncErrors()).filter(([,e])=>!!e));hasPendingAsync=S(()=>Object.values(this.profile.asyncValidating()).some(Boolean));isManager=S(()=>this.profile.$.role()==="manager");completionPercent=S(()=>{let e=this.profile.unwrap(),n=[!!e.name?.trim(),!!e.email?.trim(),e.role==="individual"||!!e.company.name?.trim(),e.role==="individual"||!!e.company.size,e.phoneNumbers.length>0&&e.phoneNumbers.every(o=>o.value.trim().length>=6),!!e.notes?.trim()],r=n.filter(Boolean).length;return Math.round(r/n.length*100)});preview=S(()=>{let e=this.profile.errors(),n=this.profile.asyncErrors();return JSON.stringify({values:this.profile.unwrap(),valid:this.profile.valid(),dirty:this.profile.dirty(),submitting:this.profile.submitting(),asyncPending:this.profile.asyncValidating(),errors:e,asyncErrors:n,completionPercent:this.completionPercent()},null,2)});calloutCode=`import {
  createFormTree,
  required,
  email,
  minLength,
  pattern,
} from '@signaltree/ng-forms';

const profile = createFormTree({
  name: '',
  email: '',
  role: 'individual',
  phoneNumbers: [{ label: 'work', value: '' }],
}, {
  persistKey: 'team-onboarding',
  fieldConfigs: {
    name: [required(), minLength(3)],
    email: {
      validators: [required(), email()],
      asyncValidators: async (value) => {
        await new Promise((r) => setTimeout(r, 200));
        return String(value).endsWith('@example.dev')
          ? 'Reserved sample domain'
          : null;
      },
    },
    'phoneNumbers.*.value': [required(), pattern(/^[+d ()-]{6,}$/)],
  },
  conditionals: [
    {
      when: (values) => values.role === 'manager',
      fields: ['company.name', 'company.size'],
    },
  ],
});`;get phoneControls(){return this.profile.form.get("phoneNumbers")}get nameError(){return this.profile.getFieldError("name")()}get emailError(){return this.profile.getFieldError("email")()}get submissionLabel(){return this.status()==="saving"?"Saving\u2026":this.hasPendingAsync()?"Waiting for checks\u2026":this.status()==="saved"?"Saved!":this.status()==="needs-attention"?"Fix validation errors":"Save profile"}phoneError(e){return this.profile.getFieldError(`phoneNumbers.${e}.value`)()}phoneAsyncError(e){return this.profile.getFieldAsyncError(`phoneNumbers.${e}.value`)()}save(){return O(this,null,function*(){try{this.status.set("saving"),yield this.profile.submit(e=>O(this,null,function*(){yield new Promise(n=>setTimeout(n,400)),this.lastSaved.set(e)})),this.status.set("saved"),setTimeout(()=>{this.status()==="saved"&&this.status.set("idle")},2e3)}catch(e){if(e instanceof J){this.status.set("needs-attention");return}console.error("Failed to submit form",e),this.status.set("error")}})}validateAll(){return O(this,null,function*(){yield this.profile.validate(),this.status.set(this.profile.valid()?"idle":"needs-attention")})}addPhoneNumber(){this.profile.$.phoneNumbers.update(e=>[...e,{label:"support",value:""}])}removePhoneNumber(e){this.phoneControls.length<=1||this.profile.$.phoneNumbers.update(n=>n.filter((r,o)=>o!==e))}reset(){this.profile.reset(),this.status.set("idle"),this.lastSaved.set(null)}trackByIndex(e){return e}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=Le({type:t,selectors:[["app-ng-forms-demo"]],decls:158,vars:39,consts:[["noSyncErrors",""],["noAsyncErrors",""],["data-testid","ng-forms-demo",1,"ng-forms-demo"],[1,"content-grid"],[1,"form-panel"],[1,"status-row"],[1,"status-chips"],[1,"chip"],[1,"completion"],[1,"meter"],[1,"bar"],["novalidate","",3,"ngSubmit","formGroup"],[1,"field-grid"],[1,"field"],["for","name"],["id","name","type","text","formControlName","name","placeholder","Ada Lovelace","autocomplete","name"],["class","error",4,"ngIf"],["for","email"],[1,"inline-field"],["id","email","type","email","formControlName","email","placeholder","ada@signaltree.dev","autocomplete","email"],["class","hint","aria-live","polite",4,"ngIf"],["class","error async",4,"ngIf"],["for","role"],["id","role","formControlName","role"],["value","individual"],["value","manager"],[1,"field","checkbox"],["type","checkbox","formControlName","receiveUpdates"],["formGroupName","company"],["class","hint",4,"ngIf"],["for","company-name"],["id","company-name","type","text","formControlName","name","placeholder","SignalTree Labs","autocomplete","organization"],["for","company-size"],["id","company-size","formControlName","size"],[3,"value",4,"ngFor","ngForOf"],["formGroupName","preferences"],[1,"field-grid","preferences"],[1,"checkbox"],["type","checkbox","formControlName","newsletter"],["type","checkbox","formControlName","productUpdates"],["type","checkbox","formControlName","betaProgram"],["formArrayName","phoneNumbers"],["class","phone-row",3,"formGroupName",4,"ngFor","ngForOf","ngForTrackBy"],["type","button",1,"add",3,"click"],["for","notes"],["id","notes","rows","4","formControlName","notes","placeholder","Share how your team plans to use SignalTree."],[1,"actions"],["type","submit",3,"disabled"],["type","button",3,"click","disabled"],["type","button",1,"reset",3,"click","disabled"],[1,"status"],[1,"validation-summary"],[4,"ngIf","ngIfElse"],[1,"hint","small"],[1,"inspector"],[1,"summary-card","callout"],[1,"summary-card"],["class","summary-card",4,"ngIf"],[1,"error"],["aria-live","polite",1,"hint"],[1,"error","async"],[1,"hint"],[3,"value"],[1,"phone-row",3,"formGroupName"],[1,"sr-only",3,"for"],["formControlName","label",3,"id"],["type","tel","formControlName","value","placeholder","+1 415 555 0134","autocomplete","tel",3,"id"],["type","button","aria-label","Remove phone number",1,"remove",3,"click","disabled"],["class","error small",4,"ngIf"],["class","error small async",4,"ngIf"],[1,"error","small"],[1,"error","small","async"],[4,"ngFor","ngForOf"]],template:function(n,r){if(n&1){let o=be();s(0,"div",2)(1,"header")(2,"h1"),a(3,"SignalTree + Angular Forms"),i(),s(4,"p"),a(5," Explore a production-style onboarding flow powered by "),s(6,"code"),a(7,"@signaltree/ng-forms"),i(),a(8,". The form demonstrates nested groups, form-array helpers, async validation, conditional sections, and automatic persistence to "),s(9,"code"),a(10,"localStorage"),i(),a(11,". "),i()(),s(12,"div",3)(13,"section",4)(14,"div",5)(15,"div",6)(16,"span",7),a(17,"Dirty"),i(),s(18,"span",7),a(19,"Pristine"),i(),s(20,"span",7),a(21,"Valid"),i(),s(22,"span",7),a(23," Async checks "),i(),s(24,"span",7),a(25," Submitting "),i()(),s(26,"div",8)(27,"label"),a(28,"Completion"),i(),s(29,"div",9),M(30,"div",10),i(),s(31,"span"),a(32),i()()(),s(33,"form",11),N("ngSubmit",function(){return U(o),$(r.save())}),s(34,"fieldset")(35,"legend"),a(36,"Identity"),i(),s(37,"div",12)(38,"div",13)(39,"label",14),a(40,"Full name"),i(),M(41,"input",15),h(42,$t,2,1,"p",16),i(),s(43,"div",13)(44,"label",17),a(45,"Email"),i(),s(46,"div",18),M(47,"input",19),h(48,Gt,2,0,"span",20),i(),h(49,qt,2,1,"p",16)(50,Ht,2,1,"p",21),i(),s(51,"div",13)(52,"label",22),a(53,"Collaboration mode"),i(),s(54,"select",23)(55,"option",24),a(56,"Individual contributor"),i(),s(57,"option",25),a(58,"Team manager"),i()()(),s(59,"div",26)(60,"label"),M(61,"input",27),a(62," Keep me posted on product updates "),i()()()(),s(63,"fieldset",28)(64,"legend"),a(65,"Company context"),i(),h(66,Kt,2,0,"p",29),s(67,"div",12)(68,"div",13)(69,"label",30),a(70,"Company name"),i(),M(71,"input",31),h(72,Yt,2,1,"p",16),i(),s(73,"div",13)(74,"label",32),a(75,"Team size"),i(),s(76,"select",33),h(77,Jt,2,2,"option",34),i(),h(78,Qt,2,1,"p",16),i()()(),s(79,"fieldset",35)(80,"legend"),a(81,"Notification preferences"),i(),s(82,"div",36)(83,"label",37),M(84,"input",38),a(85," Weekly newsletter "),i(),s(86,"label",37),M(87,"input",39),a(88," Product releases "),i(),s(89,"label",37),M(90,"input",40),a(91," Experimental beta program "),i()()(),s(92,"fieldset",41)(93,"legend"),a(94,"Phone numbers"),i(),h(95,tn,12,9,"div",42),s(96,"button",43),N("click",function(){return U(o),$(r.addPhoneNumber())}),a(97," + Add another number "),i()(),s(98,"fieldset")(99,"legend"),a(100,"Notes"),i(),s(101,"div",13)(102,"label",44),a(103,"Collaboration goals"),i(),M(104,"textarea",45),h(105,nn,2,1,"p",16),i()(),s(106,"div",46)(107,"button",47),a(108),i(),s(109,"button",48),N("click",function(){return U(o),$(r.validateAll())}),a(110," Check validation "),i(),s(111,"button",49),N("click",function(){return U(o),$(r.reset())}),a(112," Reset "),i()(),s(113,"p",50),a(114),i(),s(115,"div",51)(116,"div")(117,"h3"),a(118,"Sync validation"),i(),h(119,on,3,1,"ng-container",52),i(),s(120,"div")(121,"h3"),a(122,"Async validation"),i(),h(123,sn,3,1,"ng-container",52),i()(),s(124,"p",53),a(125," The form persists in the browser via "),s(126,"code"),a(127,"localStorage"),i(),a(128," using "),s(129,"code"),a(130,"persistKey"),i(),a(131,". Clear storage or press reset to start fresh. "),i()()(),s(132,"aside",54)(133,"article",55)(134,"h3"),a(135,"Form Tree Setup"),i(),s(136,"pre")(137,"code"),a(138),i()()(),s(139,"article",56)(140,"h3"),a(141,"Live State Preview"),i(),s(142,"p"),a(143," Inspect the entire SignalTree snapshot, including aggregation signals such as "),s(144,"code"),a(145,"valid"),i(),a(146,", "),s(147,"code"),a(148,"dirty"),i(),a(149,", async state, and the current completion heuristic. "),i(),s(150,"pre")(151,"code"),a(152),i()()(),h(153,ln,24,7,"article",57),i()()(),h(154,cn,2,0,"ng-template",null,0,xe)(156,dn,2,0,"ng-template",null,1,xe)}if(n&2){let o=ye(155),l=ye(157);c(16),j("active",r.profile.dirty()),c(2),j("active",!r.profile.dirty()),c(2),j("success",r.profile.valid()),c(2),j("active",r.hasPendingAsync()),c(2),j("active",r.profile.submitting()),c(6),$e("width",r.completionPercent(),"%"),c(2),x("",r.completionPercent(),"%"),c(),p("formGroup",r.profile.form),c(9),p("ngIf",r.nameError),c(6),p("ngIf",r.hasPendingAsync()),c(),p("ngIf",r.emailError),c(),p("ngIf",r.profile.getFieldAsyncError("email")()),c(16),p("ngIf",!r.isManager()),c(6),p("ngIf",r.profile.getFieldError("company.name")()),c(5),p("ngForOf",r.companySizeOptions),c(),p("ngIf",r.profile.getFieldError("company.size")()),c(17),p("ngForOf",r.phoneControls.controls)("ngForTrackBy",r.trackByIndex),c(10),p("ngIf",r.profile.getFieldError("notes")()),c(2),p("disabled",r.status()==="saving"),c(),x(" ",r.submissionLabel," "),c(),p("disabled",r.status()==="saving"),c(2),p("disabled",r.status()==="saving"),c(2),j("error",r.status()==="error"),c(),x(" Status: ",r.status()," "),c(5),p("ngIf",r.errorEntries().length)("ngIfElse",o),c(4),p("ngIf",r.asyncErrorEntries().length)("ngIfElse",l),c(15),R(r.calloutCode),c(14),R(r.preview()),c(),p("ngIf",r.lastSaved())}},dependencies:[Je,He,Ke,mt,rt,ct,dt,Ze,Xe,lt,et,tt,it,st,ot,at,Ye],styles:[".ng-forms-demo[_ngcontent-%COMP%]{display:grid;gap:2rem;padding:2rem;max-width:1240px;margin:0 auto 4rem}.ng-forms-demo[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;margin-bottom:.5rem}.ng-forms-demo[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#475569;max-width:720px}.content-grid[_ngcontent-%COMP%]{display:grid;gap:2rem;grid-template-columns:minmax(0,2fr) minmax(0,1fr);align-items:start}@media (max-width: 1100px){.content-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.form-panel[_ngcontent-%COMP%]{background:#f8fafc;border:1px solid #e2e8f0;border-radius:16px;padding:2rem;display:grid;gap:1.75rem;box-shadow:0 12px 30px -24px #0f172a99}.status-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;justify-content:space-between;align-items:center}.status-chips[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem}.chip[_ngcontent-%COMP%]{display:inline-flex;align-items:center;border-radius:999px;padding:.35rem .85rem;font-size:.8rem;font-weight:600;background:#e2e8f0;color:#334155;border:1px solid #cbd5f5}.chip.active[_ngcontent-%COMP%]{background:#fef3c7;border-color:#facc15;color:#b45309}.chip.success[_ngcontent-%COMP%]{background:#dcfce7;border-color:#4ade80;color:#166534}.completion[_ngcontent-%COMP%]{display:grid;gap:.4rem;min-width:180px;font-size:.85rem;color:#475569}.completion[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600}.meter[_ngcontent-%COMP%]{background:#e2e8f0;border-radius:999px;overflow:hidden;height:.5rem}.meter[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#4f46e5,#6366f1);transition:width .3s ease}form[_ngcontent-%COMP%]{display:grid;gap:1.5rem}fieldset[_ngcontent-%COMP%]{border:1px solid #e2e8f0;border-radius:12px;padding:1.25rem;background:#fff;display:grid;gap:1rem}legend[_ngcontent-%COMP%]{font-size:.95rem;font-weight:600;padding:0 .35rem;color:#1e293b}.field-grid[_ngcontent-%COMP%]{display:grid;gap:1rem;grid-template-columns:repeat(auto-fit,minmax(240px,1fr))}.field[_ngcontent-%COMP%]{display:grid;gap:.45rem}.field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#1e293b}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .field[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:.75rem .9rem;border-radius:10px;border:1px solid #cbd5f5;font-size:.95rem;background:#f8fafc;transition:border-color .2s ease,box-shadow .2s ease}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .field[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#6366f1;box-shadow:0 0 0 3px #6366f126;background:#fff}.field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:vertical;min-height:120px}.inline-field[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.checkbox[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.65rem;font-weight:500;color:#1f2937}.preferences[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}.phone-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:140px minmax(0,1fr) auto;gap:.75rem;align-items:center}@media (max-width: 640px){.phone-row[_ngcontent-%COMP%]{grid-template-columns:1fr}}.phone-row[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]{padding:.55rem 1rem;border-radius:999px;border:1px solid #e11d48;background:transparent;color:#e11d48;font-weight:600;cursor:pointer;transition:background .2s ease}.phone-row[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.phone-row[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]:not(:disabled):hover{background:#e11d4817}.add[_ngcontent-%COMP%]{justify-self:start;padding:.55rem 1.1rem;border-radius:999px;border:1px dashed #6366f1;background:#6366f114;color:#3730a3;font-weight:600;cursor:pointer;transition:background .2s ease}.add[_ngcontent-%COMP%]:hover{background:#6366f124}.actions[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.8rem}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.7rem 1.6rem;border-radius:999px;border:none;font-weight:600;cursor:pointer;background:#312e81;color:#fff;transition:background .2s ease}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background:#94a3b8;cursor:not-allowed}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:nth-child(2){background:#0f172a}.actions[_ngcontent-%COMP%]   .reset[_ngcontent-%COMP%]{background:transparent;color:#312e81;border:1px solid #312e81}.actions[_ngcontent-%COMP%]   .reset[_ngcontent-%COMP%]:hover:not(:disabled){background:#312e8114}.status[_ngcontent-%COMP%]{font-size:.9rem;color:#334155}.status.error[_ngcontent-%COMP%]{color:#dc2626}.error[_ngcontent-%COMP%]{margin-top:-.2rem;color:#b91c1c;font-size:.82rem}.error.small[_ngcontent-%COMP%]{font-size:.75rem}.error.async[_ngcontent-%COMP%]{color:#9d174d}.hint[_ngcontent-%COMP%]{color:#64748b;font-size:.82rem}.hint.small[_ngcontent-%COMP%]{font-size:.75rem}.validation-summary[_ngcontent-%COMP%]{display:grid;gap:1rem;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));background:#eff6ff;border:1px solid #bfdbfe;border-radius:12px;padding:1rem}.validation-summary[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:.5rem;font-size:.9rem;text-transform:uppercase;letter-spacing:.04em;color:#1e3a8a}.validation-summary[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;margin:0;padding:0;display:grid;gap:.4rem}.validation-summary[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background:#1e3a8a14;border-radius:6px;padding:.15rem .4rem;font-size:.76rem}.inspector[_ngcontent-%COMP%]{display:grid;gap:1.25rem}.summary-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e2e8f0;border-radius:14px;padding:1.5rem;display:grid;gap:.8rem;box-shadow:0 10px 24px -22px #0f172a99}.summary-card[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{margin:0;background:#0f172a;color:#e2e8f0;border-radius:10px;padding:1rem;font-size:.82rem;overflow-x:auto}.summary-card.callout[_ngcontent-%COMP%]{background:#1e1b4b;color:#e0e7ff;border-color:#94a3b833}.summary-card.callout[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{background:#0f172ab3}.summary-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1rem;font-weight:600}.sr-only[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"]})};export{St as NgFormsDemoComponent};
