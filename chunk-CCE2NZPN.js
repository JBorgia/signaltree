import{a as H}from"./chunk-AHY4B26Q.js";import{a as b,b as oe}from"./chunk-X4WEGLGO.js";import{a as B,b as _}from"./chunk-FUNM6BPG.js";import{c as q,d as O,e as x}from"./chunk-3C4WTMTA.js";import{e as k}from"./chunk-QBPEN4DG.js";import{_b as $,a as T,b as E,da as ae,j as g,ya as P}from"./chunk-STRTG7VY.js";var w={DATE:"\xA7d",REGEXP:"\xA7r",MAP:"\xA7m",SET:"\xA7s",UNDEFINED:"\xA7u",NAN:"\xA7n",INFINITY:"\xA7i",NEG_INFINITY:"\xA7-i",BIGINT:"\xA7b",SYMBOL:"\xA7y",FUNCTION:"\xA7f",CIRCULAR:"\xA7c"};var ie={includeMetadata:!0,replacer:void 0,reviver:void 0,preserveTypes:!0,maxDepth:50,handleCircular:!0};function L(l,t=new WeakSet,r=0,o=50,a=!0){if(r>o)return"[Max Depth Exceeded]";if(l===null||typeof l!="object")return a?l===void 0?{[w.UNDEFINED]:!0}:typeof l=="number"?Number.isNaN(l)?{[w.NAN]:!0}:l===1/0?{[w.INFINITY]:!0}:l===-1/0?{[w.NEG_INFINITY]:!0}:l:typeof l=="bigint"?{[w.BIGINT]:String(l)}:typeof l=="symbol"?{[w.SYMBOL]:String(l)}:l:l;if(typeof l=="function")try{let e=l();return L(e,t,r+1,o,a)}catch{return"[Function]"}if(t.has(l))return"[Circular Reference]";if(P(l))return l();if(a){if(l instanceof Date)return{[w.DATE]:l.toISOString()};if(l instanceof RegExp)return{[w.REGEXP]:{source:l.source,flags:l.flags}};if(l instanceof Map)return{[w.MAP]:Array.from(l.entries())};if(l instanceof Set)return{[w.SET]:Array.from(l.values())}}else if(l instanceof Date||l instanceof RegExp)return l;t.add(l);try{if(Array.isArray(l)){let n=l.map(i=>L(i,t,r+1,o,a));return t.delete(l),n}let e={};for(let[n,i]of Object.entries(l))if(!((n==="set"||n==="update")&&typeof i=="function"&&!P(i)))if(P(i))e[n]=L(i(),t,r+1,o,a);else if(typeof i=="function"&&n!=="set"&&n!=="update")try{let s=i();e[n]=L(s,t,r+1,o,a)}catch{continue}else e[n]=L(i,t,r+1,o,a);return t.delete(l),e}catch{return t.delete(l),"[Serialization Error]"}}function J(l,t="",r=new WeakSet,o=new Map){let a=[];if(l===null||typeof l!="object")return a;if(r.has(l)){let e=o.get(l)||"";return a.push({path:t,targetPath:e}),a}if(r.add(l),o.set(l,t),Array.isArray(l)){let e=l;for(let n=0;n<e.length;n++){let i=t?`${t}[${n}]`:`[${n}]`,s=J(e[n],i,r,o);a.push(...s)}}else for(let[e,n]of Object.entries(l)){let i=t?`${t}.${e}`:e,s=J(n,i,r,o);a.push(...s)}return r.delete(l),a}function de(l){let t=new WeakSet,r=new Map;return function(a,e){if(l.replacer&&(e=l.replacer.call(this,a,e)),P(e))return e();if(e&&typeof e=="object"){if(t.has(e)){if(l.handleCircular){let i=r.get(e)||"";return{[w.CIRCULAR]:i}}return}t.add(e);let n=a||"";r.set(e,n)}return e}}function se(l,t){for(let{path:r,targetPath:o}of t){let a=r.split(/\.|\[|\]/).filter(Boolean),e=o.split(/\.|\[|\]/).filter(Boolean),n=l;for(let s=0;s<a.length-1&&(n=n[a[s]],!!n);s++);let i=l;for(let s of e)if(i=i[s],!i)break;n&&i&&(n[a[a.length-1]]=i)}}function ee(l={}){let t=r=>{let o=r;o.toJSON=()=>r(),o.fromJSON=(e,n)=>{let i=m=>{if(!m||typeof m!="object")return m;if(w.UNDEFINED in m)return;if(w.NAN in m)return NaN;if(w.INFINITY in m)return 1/0;if(w.NEG_INFINITY in m)return-1/0;if(w.BIGINT in m)return BigInt(m[w.BIGINT]);if(w.SYMBOL in m)return Symbol.for(m[w.SYMBOL]);if(w.DATE in m)return new Date(m[w.DATE]);if(w.REGEXP in m){let y=m[w.REGEXP];return new RegExp(y.source,y.flags)}if(w.MAP in m)return new Map(m[w.MAP]);if(w.SET in m)return new Set(m[w.SET]);if(Array.isArray(m))return m.map(i);let p={};for(let[y,h]of Object.entries(m))p[y]=i(h);return p},s=i(e);function c(m,p){let y=r.$;if(m&&y)for(let f of m.split(".")){if(!f)continue;let S=y[f];if(!S||typeof S!="object"&&typeof S!="function"){y=void 0;break}y=S}let h=y?.[p];return P(h)?h:void 0}function u(m,p,y=""){if(!(!m||!p))for(let h in p){if(!Object.prototype.hasOwnProperty.call(p,h))continue;let f=p[h],S=m[h],M=P(S)||typeof S=="function"&&"set"in S&&typeof S.set=="function"?S:c(y,h);if(M){M.set(f);continue}f&&typeof f=="object"&&!Array.isArray(f)&&S&&(typeof S=="object"||typeof S=="function"&&!("set"in S))&&!P(S)&&u(S,f,y?`${y}.${h}`:h)}}let d=n?.nodeMap;if(d&&Object.keys(d).length>0){if(d[""]==="r"){let m=r.$;m&&typeof m.set=="function"&&m.set(s)}for(let[m,p]of Object.entries(d)){if(m===""||p!=="b")continue;let y=m.split(/\.|\[|\]/).filter(Boolean),h=r.$;for(let f of y){if(!h)break;h=h[f]??void 0}if(h&&(P(h)||typeof h=="function"&&"set"in h&&typeof h.set=="function")){let f=s;for(let S of y){if(f==null){f=void 0;break}if(typeof f=="object")f=f[S];else{f=void 0;break}}try{h.set(f)}catch{}}}u(r.state,s);return}u(r.state,s)};function a(e,n){if(!n)return e;if(e===void 0)return{[w.UNDEFINED]:!0};if(typeof e=="number")return Number.isNaN(e)?{[w.NAN]:!0}:e===1/0?{[w.INFINITY]:!0}:e===-1/0?{[w.NEG_INFINITY]:!0}:e;if(typeof e=="bigint")return{[w.BIGINT]:String(e)};if(typeof e=="symbol")return{[w.SYMBOL]:String(e)};if(e instanceof Date)return{[w.DATE]:e.toISOString()};if(e instanceof RegExp)return{[w.REGEXP]:{source:e.source,flags:e.flags}};if(e instanceof Map)return{[w.MAP]:Array.from(e.entries())};if(e instanceof Set)return{[w.SET]:Array.from(e.values())};if(Array.isArray(e))return e.map(i=>a(i,n));if(e&&typeof e=="object"){let i={};for(let[s,c]of Object.entries(e))i[s]=a(c,n);return i}return e}return o.serialize=e=>{let n=T(T(T({},ie),l),e),i=L(r.state,new WeakSet,0,n.maxDepth,n.preserveTypes),s=a(i,n.preserveTypes),c=n.handleCircular?J(s):[],u={data:s},d={};try{let y=r.$;y&&typeof y.set=="function"&&(d[""]="r");let h=new WeakSet,f=M=>P(M)||typeof M=="function"&&"set"in M&&typeof M.set=="function",S=(M,N="")=>{if(!M||typeof M!="object"&&typeof M!="function")return;let F=M;if(!h.has(F)){h.add(F),N&&f(M)&&(d[N]="b");for(let[C,A]of Object.entries(M)){let X=N?`${N}.${C}`:C;S(A,X)}}};y&&S(y)}catch{}n.includeMetadata&&(u.metadata=T(T({timestamp:Date.now(),version:"1.0.0"},c.length>0&&{circularRefs:c}),Object.keys(d).length>0&&{nodeMap:d}));let m=de(n);return JSON.stringify(u,m,2)},o.deserialize=(e,n)=>{let i=T(T(T({},ie),l),n);try{let s=JSON.parse(e),{data:c,metadata:u}=s;u?.circularRefs&&i.handleCircular&&se(c,u.circularRefs),o.fromJSON(c,u),r.__config?.debugMode&&console.log("[SignalTree] State restored from serialized data",{timestamp:u?.timestamp,version:u?.version})}catch(s){throw console.error("[SignalTree] Failed to deserialize:",s),new Error(`Failed to deserialize SignalTree state: ${s instanceof Error?s.message:"Unknown error"}`)}},o.snapshot=()=>{let e=o.toJSON(),n=J(e);return{data:JSON.parse(JSON.stringify(e)),metadata:T({timestamp:Date.now(),version:"1.0.0"},n.length>0&&{circularRefs:n})}},o.restore=e=>{let{data:n,metadata:i}=e;i?.circularRefs&&se(n,i.circularRefs),o.fromJSON(n,i)},o};return t.metadata={name:"serialization"},t}var U=performance,ce=new Set;function fe(l,t,r){if(t==null)return l;let o=Math.min(l,t);return o<l&&r&&!ce.has(r)&&(console.warn(`[BenchRunner] Cap applied to ${r}: requested=${l}, cap=${t}. You can raise this in configuration for scaling tests.`),ce.add(r)),o}function ge(l){if(typeof queueMicrotask=="function"){queueMicrotask(l);return}if(typeof MessageChannel<"u"){let t=new MessageChannel;t.port1.onmessage=()=>{l()},t.port2.postMessage(0);return}setTimeout(l,0)}function te(){let l=window.requestIdleCallback;return typeof l=="function"?new Promise(t=>{l(()=>t(),{timeout:50})}):new Promise(t=>ge(t))}function he(){let l=!1,t;function r(o,a){t=o,!l&&(l=!0,requestAnimationFrame(()=>{l=!1;try{a?.(t)}finally{t=void 0}}))}return{schedule:r}}var pe=he(),I=class{static percentile(t,r){if(t.length===0)return 0;let o=Math.ceil(r/100*t.length)-1;return t[Math.max(0,Math.min(o,t.length-1))]}static standardDeviation(t){if(t.length===0)return 0;let r=t.reduce((e,n)=>e+n,0)/t.length,a=t.map(e=>Math.pow(e-r,2)).reduce((e,n)=>e+n,0)/t.length;return Math.sqrt(a)}static removeStatisticalOutliers(t,r=.2){if(t.length<4)return t;let o=[...t].sort((u,d)=>u-d),a=this.percentile(o,25),e=this.percentile(o,75),n=e-a,i=a-1.5*n,s=e+1.5*n,c=t.filter(u=>u>=i&&u<=s);return c.length<t.length*(1-r)?t:c}static assessReliability(t,r){if(t.length<10)return{reliability:"low",coefficientOfVariation:0,recommendation:"Sample size too small for reliable measurement"};if(r<50)return{reliability:"low",coefficientOfVariation:0,recommendation:"Total runtime too short for reliable timing measurement"};let o=t.reduce((i,s)=>i+s,0)/t.length,a=o>0?this.standardDeviation(t)/o:0,e,n;return a<.05?(e="high",n="Excellent measurement stability - high confidence in results"):a<.15?(e="medium",n="Good measurement stability - results are likely reliable"):(e="low",n="High variability detected - consider checking for system interference or increasing sample size"),{reliability:e,coefficientOfVariation:a,recommendation:n}}static detectAnomalies(t){if(t.length<10)return{outliers:[],anomalyCount:0,anomalyRate:0,recommendation:"Sample size too small for reliable anomaly detection"};let r=[...t].sort((d,m)=>d-m),o=this.percentile(r,25),a=this.percentile(r,75),e=a-o,n=o-1.5*e,i=a+1.5*e,s=t.filter(d=>d<n||d>i),c=s.length/t.length,u;return c>.2?u="High anomaly rate detected - check for system interference, GC pressure, or thermal throttling":c>.1?u="Moderate anomaly rate - consider increasing sample size or checking environment":c>.05?u="Low anomaly rate - results are likely reliable":u="Very low anomaly rate - high confidence in results",{outliers:s,anomalyCount:s.length,anomalyRate:c,recommendation:u}}};function le(){return g(this,null,function*(){"gc"in window&&typeof window.gc=="function"&&window.gc?.();let l=new Array(1e6).fill(0);yield te(),l.length=0,yield new Promise(t=>setTimeout(t,100))})}function G(l,t){return g(this,null,function*(){let{warmup:r=5,operations:o,yieldEvery:a=0,trackMemory:e=!1,label:n="benchmark",measurementSamples:i=30,maxRuntimeMs:s=3e4,removeOutliers:c=!0,minSamples:u=10,forceGC:d=!1,operationsCap:m,minDurationMs:p=100,onProgress:y}=t,h=fe(o,m,n);d&&(yield le()),console.debug(`[${n}] Starting warmup (${r} iterations)`);for(let v=0;v<r;v++)yield l(v),a&&(v+1)%a===0&&(yield te());d&&(yield le());let f=[],S=e&&U.memory?U.memory.usedJSHeapSize:void 0,M=0,N=0;for(console.debug(`[${n}] Starting measurement phase`);f.length<i&&M<s||M<p&&f.length<i*3;){let v=performance.now();for(let R=0;R<h;R++)yield l(R);let D=performance.now()-v;f.push(D),M+=D,N+=h,typeof y=="function"&&pe.schedule({samplesCollected:f.length,elapsedMs:M},R=>y(R)),f.length%10===0&&(yield te())}let F=e&&U.memory?U.memory.usedJSHeapSize:void 0,C=c?I.removeStatisticalOutliers(f):f;C.length<u&&(console.warn(`[${n}] Insufficient samples after outlier removal, using raw samples`),C=f);let A=[...C].sort((v,D)=>v-D),X=A.reduce((v,D)=>v+D,0)/A.length,Z=I.assessReliability(C,M),ne=I.detectAnomalies(f),V=E(T({median:I.percentile(A,50),mean:X,min:A[0],max:A[A.length-1],p95:I.percentile(A,95),p99:I.percentile(A,99),stdDev:I.standardDeviation(A),samples:C,sampleCount:C.length,totalIterations:N,totalRuntimeMs:M},e&&S!==void 0&&F!==void 0&&{memoryDeltaMB:(F-S)/(1024*1024)}),{reliability:Z.reliability,coefficientOfVariation:Z.coefficientOfVariation,outlierCount:ne.anomalyCount,anomalyRate:ne.anomalyRate,recommendation:Z.recommendation});function me(v,D){if(!v||v.length===0)return!1;let R=v.length;if(v.filter(z=>z===0).length/R>=.25)return!0;let Y=new Map;for(let z of v){let re=Math.round(z*10)/10;Y.set(re,(Y.get(re)??0)+1)}let j=0;for(let z of Y.values())z>j&&(j=z);return j/R>=.35&&D<.5}try{if(!!!t.__adaptiveAttempted&&me(f,V.median)){let R=Math.max(p*4,500),K=Math.max(i*2,i+10);console.warn(`[${n}] Quantization detected in samples \u2014 rerunning with minDurationMs=${R} and measurementSamples=${K}`);let Y=E(T({},t),{minDurationMs:R,measurementSamples:K,__adaptiveAttempted:!0});return yield G(l,Y)}}catch(v){console.warn(`[${n}] Adaptive re-measure failed: ${v.message}`)}return console.debug(`[${n}] Completed: ${N} total iterations, ${f.length} samples, ${M.toFixed(1)}ms total, reliability: ${V.reliability}, CV: ${(V.coefficientOfVariation*100).toFixed(1)}%`),V})}var Q=class{static compareBenchmarks(t,r,o,a,e=.95){let n=t.median-o.median,i=o.median>0?(o.median-t.median)/o.median*100:0,s=this.bootstrapMedianDifference(t.samples,o.samples,1e3,e),c=this.mannWhitneyUTest(t.samples,o.samples),u=this.cohensD(t.samples,o.samples),d;return c.isSignificant?n<0?d=`${r} is significantly faster than ${a}`:d=`${a} is significantly faster than ${r}`:d="No statistically significant difference detected",{library1:r,library2:a,medianDifference:n,percentageImprovement:i,isStatisticallySignificant:c.isSignificant,confidenceInterval:[s.lowerBound,s.upperBound],effectSize:u.effectSize,effectSizeInterpretation:u.interpretation,conclusion:d}}static bootstrapMedianDifference(t,r,o=1e3,a=.95){let e=[];for(let c=0;c<o;c++){let u=this.bootstrapSample(t),d=this.bootstrapSample(r),m=I.percentile([...u].sort((p,y)=>p-y),50)-I.percentile([...d].sort((p,y)=>p-y),50);e.push(m)}e.sort((c,u)=>c-u);let n=1-a,i=Math.floor(n/2*o),s=Math.floor((1-n/2)*o);return{lowerBound:e[i],upperBound:e[s]}}static mannWhitneyUTest(t,r){let o=t.length,a=r.length,e=[...t.map(c=>({value:c,group:1})),...r.map(c=>({value:c,group:2}))].sort((c,u)=>c.value-u.value),n=0;for(let c=0;c<e.length;c++)e[c].group===1&&(n+=c+1);let i=n-o*(o+1)/2,s=Math.min(i,o*a-i);if(o>20&&a>20){let c=o*a/2,u=Math.sqrt(o*a*(o+a+1)/12),d=Math.abs((s-c)/u),m=2*(1-this.normalCDF(d));return{isSignificant:m<.05,pValue:m}}return{isSignificant:!1,pValue:1}}static cohensD(t,r){let o=t.reduce((d,m)=>d+m,0)/t.length,a=r.reduce((d,m)=>d+m,0)/r.length,e=this.variance(t),n=this.variance(r),i=Math.sqrt(((t.length-1)*e+(r.length-1)*n)/(t.length+r.length-2)),s=(o-a)/i,c=Math.abs(s),u;return c<.2?u="Negligible effect":c<.5?u="Small effect":c<.8?u="Medium effect":u="Large effect",{effectSize:s,interpretation:u}}static normalCDF(t){return .5*(1+this.erf(t/Math.sqrt(2)))}static erf(t){let r=.254829592,o=-.284496736,a=1.421413741,e=-1.453152027,n=1.061405429,i=.3275911,s=t<0?-1:1;t=Math.abs(t);let c=1/(1+i*t),u=1-((((n*c+e)*c+a)*c+o)*c+r)*c*Math.exp(-t*t);return s*u}static variance(t){let r=t.reduce((o,a)=>o+a,0)/t.length;return t.reduce((o,a)=>o+Math.pow(a-r,2),0)/(t.length-1)}static bootstrapSample(t){let r=[];for(let o=0;o<t.length;o++){let a=Math.floor(Math.random()*t.length);r.push(t[a])}return r}},W=class{static detectPerformanceThrottling(){return g(this,null,function*(){let r=performance.now(),o=0;for(let s=0;s<1e5;s++)o+=Math.sqrt(s)*Math.sin(s);let e=1e5/(performance.now()-r),n=e<300,i;return n?i="Performance throttling detected. Consider: closing other tabs, plugging in laptop, checking thermal throttling, or running in incognito mode.":e<500?i="Moderate performance detected. Results may have higher variance.":i="Good performance environment detected.",o===1/0&&console.log("Calibration complete"),{isThrottled:n,opsPerMs:e,recommendation:i}})}static validateEnvironment(){return g(this,null,function*(){let t=[],r=[],o=yield this.detectPerformanceThrottling();if(o.isThrottled&&(t.push("Performance throttling detected"),r.push(o.recommendation)),U.memory){let e=U.memory;e.usedJSHeapSize/e.jsHeapSizeLimit*100>80&&(t.push("High memory usage detected"),r.push("Consider closing other tabs or refreshing the page to free memory"))}return"requestIdleCallback"in window||r.push("Browser lacks requestIdleCallback support - timing may be less accurate"),window.outerHeight-window.innerHeight>160&&r.push("Developer tools appear to be open - this may affect performance measurements"),{isReady:t.length===0,issues:t,recommendations:r}})}};var ue=class l{yieldBetweenBenchmarks(){return g(this,null,function*(){return new Promise(t=>{requestAnimationFrame(()=>{setTimeout(t,0)})})})}yieldToUI=oe();getRuntimeMemoMode(){try{let t=window.__SIGNALTREE_MEMO_MODE;if(t==="off"||t==="light"||t==="shallow"||t==="full")return t}catch{}return"light"}runDeepNestedBenchmark(t,r=15){return g(this,null,function*(){let o=performance.now(),a=n=>n===0?{value:0,data:"test"}:{level:a(n-1)},e=k(a(r)).with(B(),x());for(let n=0;n<Math.min(t,b.ITERATIONS.DEEP_NESTED);n++){let i=e.state;for(let s=0;s<r&&i?.level;s++)i=i.level;i?.value&&typeof i.value.set=="function"?i.value.set(n):typeof i?.value=="function"&&i.value(n)}return performance.now()-o})}runArrayBenchmark(t){return g(this,null,function*(){let r=performance.now(),o=k({items:Array.from({length:t},(e,n)=>({id:n,value:Math.random()*1e3}))}).with(_()),a=Math.min(b.ITERATIONS.ARRAY_UPDATES,t);for(let e=0;e<a;e++){let n=e%t;o.state.items.update(i=>(i[n].value=Math.random()*1e3,i))}return performance.now()-r})}runComputedBenchmark(t){return g(this,null,function*(){let r=performance.now(),o=this.getRuntimeMemoMode(),a=[B()];o==="light"?a.push(O()):o==="shallow"?a.push(x()):o==="full"&&a.push(q());let e=k({value:0,factors:Array.from({length:50},(i,s)=>s+1)});a.length&&(e=e.with(...a));let n=$(()=>{let i=e.state.value(),s=0;for(let c of e.state.factors())s+=Math.sin(i*c)*Math.cos(c);return s});for(let i=0;i<Math.min(t,b.ITERATIONS.COMPUTED);i++)e.state.value.set(i),n(),i&1023;return performance.now()-r})}runBatchUpdatesBenchmark(t=100,r=1e3){return g(this,null,function*(){let o=performance.now(),a=k({items:Array.from({length:r},(e,n)=>n)}).with(_());for(let e=0;e<t;e++)a.state.items.update(n=>{for(let i=0;i<r;i++)n[i]=n[i]+1|0;return n});return performance.now()-o})}runSelectorBenchmark(t){return g(this,null,function*(){let r=performance.now(),o=this.getRuntimeMemoMode(),a=[];o==="light"?a.push(O()):o==="shallow"?a.push(x()):o==="full"&&a.push(q());let e=k({items:Array.from({length:t},(c,u)=>({id:u,flag:u%2===0,value:Math.random()*100,metadata:{category:u%5,priority:u%3}}))});a.length&&(e=e.with(...a));let n=$(()=>e.state.items().filter(c=>c.flag).length),i=$(()=>e.state.items().filter(c=>c.value>50).length),s=$(()=>e.state.items().reduce((u,d)=>{let m=d.metadata.category;return u[m]=(u[m]||0)+1,u},{}));for(let c=0;c<b.ITERATIONS.SELECTOR;c++)n(),i(),s(),(c&b.YIELD_FREQUENCY.SELECTOR)===0&&e.state.items.update(u=>{let d=c%u.length;return u[d].flag=!u[d].flag,u});return performance.now()-r})}runSerializationBenchmark(t){return g(this,null,function*(){let r=k({users:Array.from({length:Math.max(b.DATA_SIZE_LIMITS.USER_SIMULATION.MIN,Math.min(b.DATA_SIZE_LIMITS.USER_SIMULATION.MAX,t))},(i,s)=>({id:s,name:`User ${s}`,roles:s%5===0?["admin","user"]:["user"],active:s%3===0,meta:{createdAt:new Date(2020,0,1+s%28)}})),settings:{theme:"dark",flags:{a:!0,b:!1,c:o(8).reduce((i,s)=>E(T({},i),{[s]:s%2===0}),{})}}}).with(q(),_(),ee({preserveTypes:!1,includeMetadata:!1}));function o(i){return Array.from({length:i},(s,c)=>c)}for(let i=0;i<10;i++)r.state.users.update(s=>{let c=i%s.length;return s[c].active=!s[c].active,s});let a=performance.now(),e=r.snapshot();return JSON.stringify({data:e.data}),performance.now()-a})}runConcurrentUpdatesBenchmark(t=50,r=200){return g(this,null,function*(){let o=k({counters:Array.from({length:t},()=>({value:0}))}).with(B()),a=performance.now();for(let e=0;e<r;e++)for(let n=0;n<t;n++){let i=n;o.state.counters.update(s=>s.map((c,u)=>u===i?E(T({},c),{value:c.value+1|0}):c))}return performance.now()-a})}runMemoryEfficiencyBenchmark(t){return g(this,null,function*(){let r=Math.max(b.DATA_SIZE_LIMITS.ENTITY_COUNT.MIN,Math.min(b.DATA_SIZE_LIMITS.ENTITY_COUNT.MAX,t)),o=Math.max(10,Math.min(200,Math.floor(r/250))),a=k({groups:Array.from({length:o},(i,s)=>({id:s,items:Array.from({length:Math.floor(r/o)},(c,u)=>({id:s*1e6+u,score:u*13%997,tags:u%7===0?["hot","new"]:["cold"]}))}))}).with(O(),B()),e=performance.now(),n=Math.max(100,Math.floor(r*.01));for(let i=0;i<n;i++){let s=i%o;a.state.groups.update(c=>{let u=[...c],d=u[s];return d&&d.items&&(u[s]=E(T({},d),{items:d.items.map((m,p)=>{let y=i%d.items.length;return p===y?E(T({},m),{score:m.score+1|0,tags:(i&63)===0?m.tags.includes("hot")?["cold"]:["hot"]:m.tags}):m})})),u})}return performance.now()-e})}runDataFetchingBenchmark(t){return g(this,null,function*(){let r=performance.now(),o=Array.from({length:Math.min(t,b.DATA_SIZE_LIMITS.USER_SIMULATION.MAX)},(e,n)=>({id:n,title:`Item ${n}`,description:`Description for item ${n}`,tags:[`tag${n%10}`,`category${n%5}`],meta:{createdAt:new Date(2023,0,1+n%365),updatedAt:new Date(2023,6,1+n%180),views:Math.floor(Math.random()*1e3),rating:Math.random()*5},relations:{authorId:Math.floor(n/10),parentId:n>0?n-1:null,childIds:n<t-1?[n+1]:[]}})),a=k({items:[],metadata:{total:0,loaded:!1,lastFetch:null},filters:{search:"",category:"",tags:[]},pagination:{page:1,size:50,total:0}}).with(B(),x());a.state.metadata.loaded.set(!1),a.state.items.set(o),a.state.metadata.total.set(o.length),a.state.metadata.lastFetch.set(new Date),a.state.metadata.loaded.set(!0);for(let e=0;e<Math.min(b.ITERATIONS.BATCH_UPDATES,t/10);e++){a.state.filters.search.set(`search${e}`),a.state.filters.category.set(`cat${e%5}`);let n=a.state.items().filter(i=>i.title.includes(a.state.filters.search())||i.tags.includes(a.state.filters.category()));a.state.pagination.total.set(n.length)}return performance.now()-r})}runRealTimeUpdatesBenchmark(t){return g(this,null,function*(){let r=performance.now(),o=k({liveMetrics:{activeUsers:0,totalSessions:0,pageViews:0,serverLoad:0,responseTime:0},recentEvents:[],notifications:[],alerts:[]}).with(_(),O()),a=Math.min(b.ITERATIONS.REAL_TIME_UPDATES,t);for(let e=0;e<a;e++)o.state.liveMetrics.activeUsers.update(n=>n+Math.floor(Math.random()*10-5)),o.state.liveMetrics.pageViews.update(n=>n+Math.floor(Math.random()*20)),o.state.liveMetrics.serverLoad.set(Math.random()),o.state.liveMetrics.responseTime.set(50+Math.random()*200),(e&b.YIELD_FREQUENCY.DATA_FETCHING)===0&&o.state.recentEvents.update(n=>[...n.slice(-99),{id:e,type:"user_action",timestamp:Date.now(),data:`event${e}`}]),(e&b.YIELD_FREQUENCY.REAL_TIME_UPDATES)===0&&o.state.notifications.update(n=>[...n.slice(-9),{id:e,message:`Notification ${e}`,priority:"normal",timestamp:Date.now()}]);return performance.now()-r})}runStateSizeScalingBenchmark(t){return g(this,null,function*(){let r=performance.now(),o=Array.from({length:Math.min(t*b.DATA_SIZE_LIMITS.LARGE_DATASET.MULTIPLIER,b.DATA_SIZE_LIMITS.LARGE_DATASET.MAX)},(n,i)=>({id:i,name:`Entity ${i}`,properties:Array.from({length:20},(s,c)=>({key:`prop_${c}`,value:`value_${i}_${c}`,metadata:{type:"string",indexed:c%3===0}})),relations:Array.from({length:Math.min(5,i)},(s,c)=>({targetId:i-c-1,type:"reference"}))})),a=k({entities:o,indices:{},cache:{},stats:{size:0,lastUpdate:null}}).with(O(),B());a.state.stats.size.set(o.length),a.state.stats.lastUpdate.set(new Date);let e=Math.min(b.ITERATIONS.STATE_SIZE_SCALING,t/5);for(let n=0;n<e;n++){let i=n%o.length;a.state.entities.update(s=>{let c=s[i];return c&&(c.properties[0].value=`updated_${Date.now()}`),s}),(n&b.YIELD_FREQUENCY.REAL_TIME_UPDATES)===0&&a.state.cache.update(s=>E(T({},s),{[`cache_${n}`]:{computed:Math.random(),timestamp:Date.now()}}))}return performance.now()-r})}runAsyncWorkflowBenchmark(t){return g(this,null,function*(){let r=k({items:[],loading:!1,error:null}).with(_()),o=p=>g(null,null,function*(){return yield new Promise(y=>setTimeout(y,b.TIMING.ASYNC_DELAY_MS)),Array.from({length:p},(y,h)=>({id:h,value:h}))}),a=performance.now(),e=Math.min(Math.max(1,Math.floor(t/10)),b.ITERATIONS.ASYNC_WORKFLOW),n=Math.min(8,Math.max(1,e)),i=Math.max(1,Math.floor(t/Math.max(e,10))),s=new Array(t),c=0;function u(p,y){return g(this,null,function*(){let h=0;for(;h<p.length;){let f=p.slice(h,h+n);yield Promise.all(f.map(S=>y(S))),h+=n}})}r.state.loading.set(!0),r.state.error.set(null);let d=()=>g(null,null,function*(){try{let p=yield o(Math.min(i,t)),y=r.preallocateArray;if(y){let h=y("items",s.length);for(let f=0;f<p.length;f++){let S=(c+f)%s.length;h.update(S,p[f])}h.commit(),c=(c+p.length)%s.length}else if(r.batch)r.batch(()=>{for(let h=0;h<p.length;h++){let f=(c+h)%s.length;s[f]=p[h]}r.state.items.set(s),c=(c+p.length)%s.length});else{let h=c;for(let f=0;f<p.length;f++){let S=(h+f)%s.length;s[S]=p[f]}r.state.items.set(s.slice()),c=(c+p.length)%s.length}}catch(p){r.state.error.set(p?.message??String(p))}}),m=Array.from({length:e},(p,y)=>y);return yield u(m,d),r.state.loading.set(!1),performance.now()-a})}runConcurrentAsyncBenchmark(t){return g(this,null,function*(){let r=k({results:[],activeOperations:0}),o=n=>g(null,null,function*(){r.state.activeOperations.update(s=>s+1),yield new Promise(s=>setTimeout(s,Math.random()*b.TIMING.RANDOM_DELAY_MAX_MS));let i={id:n,value:Math.random()};r.state.results.update(s=>[...s,i]),r.state.activeOperations.update(s=>s-1)}),a=performance.now(),e=Array.from({length:t},(n,i)=>o(i));return yield Promise.all(e),performance.now()-a})}runAsyncCancellationBenchmark(t){return g(this,null,function*(){let r=k({activeRequest:null,result:null,cancelled:0}),o=performance.now();for(let a=0;a<t;a++){let e=r.state.activeRequest();e&&(e.abort(),r.state.cancelled.update(i=>i+1));let n=new AbortController;r.state.activeRequest.set(n);try{yield new Promise((i,s)=>{let c=setTimeout(()=>{n.signal.aborted||(r.state.result.set({id:a,data:"completed"}),i(null))},5);n.signal.addEventListener("abort",()=>{clearTimeout(c),s(new Error("Cancelled"))})})}catch{}}return performance.now()-o})}runUndoRedoBenchmark(t){return g(this,null,function*(){let r=k({counter:0,data:{value:"initial"}}).with(H()),o=performance.now();for(let a=0;a<t;a++)r.state.counter.set(a),r.state.data({value:`step_${a}`});for(let a=0;a<t/2;a++)r.undo?.();for(let a=0;a<t/4;a++)r.redo?.();return performance.now()-o})}runHistorySizeBenchmark(t){return g(this,null,function*(){let r=k({value:0,data:{content:"initial"}}).with(H({maxHistorySize:t})),o=performance.now();for(let a=0;a<t;a++)r.state.value.set(a),r.state.data({content:`step_${a}`});return performance.now()-o})}runJumpToStateBenchmark(t){return g(this,null,function*(){let r=k({currentState:0,data:{value:"initial"}}).with(H()),o=performance.now();for(let a=0;a<t;a++)r.state.currentState.set(a),r.state.data({value:`state_${a}`});for(let a=0;a<t;a++){let e=Math.floor(Math.random()*t);r.jumpToStep?.(e)}return performance.now()-o})}runSingleMiddlewareBenchmark(t){return g(this,null,function*(){let r=k({value:0,middlewareLog:[]}),o=(e,n)=>{r.state.middlewareLog.update(i=>[...i.slice(-100),`${e}:${n}`])},a=performance.now();for(let e=0;e<t;e++)o("setValue",e),r.state.value.set(e);return performance.now()-a})}runMultipleMiddlewareBenchmark(t,r){return g(this,null,function*(){let o=k({value:0,logs:Array.from({length:t},()=>[])}),a=Array.from({length:t},(n,i)=>(s,c)=>{o.state.logs()[i].push(`MW${i}:${s}:${c}`)}),e=performance.now();for(let n=0;n<r;n++)a.forEach(i=>i("setValue",n)),o.state.value.set(n);return performance.now()-e})}runConditionalMiddlewareBenchmark(t){return g(this,null,function*(){let r=k({value:0,conditionalLog:[],condition:!0}),o=(e,n)=>{r.state.condition()&&r.state.conditionalLog.update(i=>[...i.slice(-50),`${e}:${n}`])},a=performance.now();for(let e=0;e<t;e++)(e&b.YIELD_FREQUENCY.DATA_FETCHING)===0&&r.state.condition.set(!r.state.condition()),o("setValue",e),r.state.value.set(e);return performance.now()-a})}runAllFeaturesEnabledBenchmark(t){return g(this,null,function*(){let r=k({data:[],loading:!1,history:[],middlewareLog:[]}).with(q(),B(),ee()),o=performance.now(),a=Math.min(t/100,b.ITERATIONS.ASYNC_WORKFLOW);for(let e=0;e<a;e++)r.state.loading.set(!0),yield new Promise(n=>setTimeout(n,b.TIMING.TIMEOUT_DELAY_MS)),r.state.data.update(n=>[...n,{id:e,value:Math.random()}]),r.state.loading.set(!1),r.state.history.update(n=>[...n.slice(-20),{action:"update",id:e}]),r.state.middlewareLog.update(n=>[...n.slice(-30),`action_${e}`]);return performance.now()-o})}runEnhancedArrayBenchmark(t){return g(this,null,function*(){let r={operations:Math.min(b.ITERATIONS.ARRAY_UPDATES,t),warmup:10,measurementSamples:30,yieldEvery:b.YIELD_FREQUENCY.ARRAY_UPDATES,trackMemory:!0,removeOutliers:!0,forceGC:!0,label:"SignalTree Array Updates",minDurationMs:100},o=k({items:Array.from({length:t},(a,e)=>({id:e,value:Math.random()*1e3}))}).with(_());return G(a=>g(null,null,function*(){let e=a%t;o.state.items.update(n=>{let i=[...n];return i[e]=E(T({},i[e]),{value:Math.random()*1e3}),i})}),r)})}runEnhancedSelectorBenchmark(t){return g(this,null,function*(){let r=k({items:Array.from({length:t},(e,n)=>({id:n,flag:n%2===0}))}).with(O()),o=$(()=>r.state.items().filter(e=>e.flag).length);return G(()=>g(null,null,function*(){o()}),{operations:1e3,warmup:5,measurementSamples:50,yieldEvery:64,trackMemory:!1,removeOutliers:!0,label:"SignalTree Selector (Memoized)",minDurationMs:50})})}runEnhancedDeepNestedBenchmark(t,r=15){return g(this,null,function*(){let o=n=>n===0?{value:0,data:"test"}:{level:o(n-1)},a=k(o(r)).with(B(),x()),e={operations:Math.min(t,1e3),warmup:5,measurementSamples:20,yieldEvery:1024,trackMemory:!0,removeOutliers:!0,forceGC:!0,label:"SignalTree Deep Nested Updates",minDurationMs:100};return G(n=>g(null,null,function*(){a.update(i=>{let s=(c,u)=>u===0?E(T({},c),{value:n}):E(T({},c),{level:s(c.level??{},u-1)});return s(i,r-1)})}),e)})}runPureArrayBenchmark(t){return g(this,null,function*(){let r=k({items:Array.from({length:t},(e,n)=>({id:n,value:Math.random()*1e3}))}).with(_()),o=Math.min(b.ITERATIONS.ARRAY_UPDATES,t),a=performance.now();for(let e=0;e<o;e++){let n=e%t;r.state.items.update(i=>{let s=[...i];return s[n]=E(T({},s[n]),{value:Math.random()*1e3}),s})}return performance.now()-a})}runPureSelectorBenchmark(t){return g(this,null,function*(){let r=k({items:Array.from({length:t},(e,n)=>({id:n,flag:n%2===0}))}).with(O()),o=$(()=>r.state.items().filter(e=>e.flag).length),a=performance.now();for(let e=0;e<b.ITERATIONS.SELECTOR;e++)o();return performance.now()-a})}runPureDeepNestedBenchmark(t,r=15){return g(this,null,function*(){let o=i=>i===0?{value:0,data:"test"}:{level:o(i-1)},a=k(o(r)).with(B(),x()),e=Math.min(t,b.ITERATIONS.DEEP_NESTED),n=performance.now();for(let i=0;i<e;i++)a.update(s=>{let c=(u,d)=>d===0?E(T({},u),{value:i}):E(T({},u),{level:c(u.level??{},d-1)});return c(s,r-1)});return performance.now()-n})}runPureBenchmarkSuite(t){return g(this,null,function*(){let r=performance.now();yield this.yieldBetweenBenchmarks(),console.log("\u{1F3AF} Starting Pure Array Benchmark...");let o=yield this.runPureArrayBenchmark(t);yield this.yieldBetweenBenchmarks(),console.log("\u{1F3AF} Starting Pure Selector Benchmark...");let a=yield this.runPureSelectorBenchmark(t);yield this.yieldBetweenBenchmarks(),console.log("\u{1F3AF} Starting Pure Deep Nested Benchmark...");let e=yield this.runPureDeepNestedBenchmark(t),n=performance.now()-r;return console.log(`\u2705 Pure Benchmark Suite Complete:
      \u2022 Array: ${o.toFixed(2)}ms
      \u2022 Selector: ${a.toFixed(2)}ms
      \u2022 Deep Nested: ${e.toFixed(2)}ms
      \u2022 Total: ${n.toFixed(2)}ms`),{arrayBenchmark:o,selectorBenchmark:a,deepNestedBenchmark:e,totalTime:n}})}validateBenchmarkEnvironment(){return g(this,null,function*(){let t=yield W.validateEnvironment(),r=yield W.detectPerformanceThrottling();return E(T({},t),{performanceMetrics:{isThrottled:r.isThrottled,opsPerMs:r.opsPerMs}})})}static compareWithLibrary(t,r,o){return Q.compareBenchmarks(t,"SignalTree",r,o,.95)}runComprehensiveBenchmarkSuite(t){return g(this,null,function*(){let r=yield this.validateBenchmarkEnvironment();r.isReady||console.warn("Benchmark environment validation failed:",r.issues);let[o,a,e]=yield Promise.all([this.runEnhancedArrayBenchmark(t),this.runEnhancedSelectorBenchmark(t),this.runEnhancedDeepNestedBenchmark(t)]),n=[o,a,e],i=n.map(m=>m.reliability),s=i.includes("low")?"low":i.includes("medium")?"medium":"high",c=n.reduce((m,p)=>m+p.sampleCount,0),u=n.reduce((m,p)=>m+p.totalRuntimeMs,0),d=[];return n.forEach(m=>{m.reliability==="low"&&d.push(m.recommendation),m.anomalyRate>.1&&d.push(`High anomaly rate in ${m.samples.length>0?"benchmark":"unknown benchmark"} - check for interference`)}),r.performanceMetrics.isThrottled&&d.push("Performance throttling detected - results may not reflect optimal performance"),{arrayBenchmark:o,selectorBenchmark:a,deepNestedBenchmark:e,environment:r,summary:{overallReliability:s,totalSamples:c,totalRuntime:u,recommendations:[...new Set(d)]}}})}demonstrateEnhancedBenchmarking(t=1e3){return g(this,null,function*(){console.log("\u{1F680} Starting Enhanced SignalTree Benchmark Demonstration");let r=yield this.validateBenchmarkEnvironment();console.log("Environment Check:",r),r.isReady||(console.warn("\u26A0\uFE0F Environment issues detected:",r.issues),console.log("\u{1F4A1} Recommendations:",r.recommendations)),console.log(`
\u{1F4CA} Running Enhanced Array Benchmark...`);let o=yield this.runEnhancedArrayBenchmark(t);console.log(`\u2705 Array Benchmark Complete:
      \u2022 Median: ${o.median.toFixed(2)}ms
      \u2022 Reliability: ${o.reliability}
      \u2022 CV: ${(o.coefficientOfVariation*100).toFixed(1)}%
      \u2022 Samples: ${o.sampleCount}
      \u2022 Memory \u0394: ${o.memoryDeltaMB?.toFixed(2)??"N/A"}MB`),console.log(`
\u{1F3AF} Running Enhanced Selector Benchmark...`);let a=yield this.runEnhancedSelectorBenchmark(t);console.log(`\u2705 Selector Benchmark Complete:
      \u2022 Median: ${a.median.toFixed(2)}ms
      \u2022 Reliability: ${a.reliability}
      \u2022 CV: ${(a.coefficientOfVariation*100).toFixed(1)}%
      \u2022 Samples: ${a.sampleCount}`),console.log(`
\u{1F4C8} Statistical Comparison Example:`);let e=l.compareWithLibrary(o,a,"Selector Benchmark");console.log(`Comparison Result:
      \u2022 Difference: ${e.medianDifference.toFixed(2)}ms
      \u2022 Improvement: ${e.percentageImprovement.toFixed(1)}%
      \u2022 Significant: ${e.isStatisticallySignificant}
      \u2022 Effect Size: ${e.effectSizeInterpretation}
      \u2022 Conclusion: ${e.conclusion}`),console.log(`
\u{1F389} Enhanced Benchmark Demonstration Complete!`)})}static \u0275fac=function(r){return new(r||l)};static \u0275prov=ae({token:l,factory:l.\u0275fac,providedIn:"root"})};export{ue as a};
