import{a as x,b as I,j as R}from"./chunk-A3ECCK3J.js";var v=performance,G=new Set;function F(l,e,n){if(e==null)return l;let t=Math.min(l,e);return t<l&&n&&!G.has(n)&&G.add(n),t}function Q(l){if(typeof queueMicrotask=="function"){queueMicrotask(l);return}if(typeof MessageChannel<"u"){let e=new MessageChannel;e.port1.onmessage=()=>{l()},e.port2.postMessage(0);return}setTimeout(l,0)}function q(){let l=window.requestIdleCallback;return typeof l=="function"?new Promise(e=>{l(()=>e(),{timeout:50})}):new Promise(e=>Q(e))}function j(){let l=!1,e;function n(t,r){e=t,!l&&(l=!0,requestAnimationFrame(()=>{l=!1;try{r?.(e)}finally{e=void 0}}))}return{schedule:n}}var K=j(),g=class{static percentile(e,n){if(e.length===0)return 0;let t=Math.ceil(n/100*e.length)-1;return e[Math.max(0,Math.min(t,e.length-1))]}static standardDeviation(e){if(e.length===0)return 0;let n=e.reduce((i,a)=>i+a,0)/e.length,r=e.map(i=>Math.pow(i-n,2)).reduce((i,a)=>i+a,0)/e.length;return Math.sqrt(r)}static removeStatisticalOutliers(e,n=.2){if(e.length<4)return e;let t=[...e].sort((s,u)=>s-u),r=this.percentile(t,25),i=this.percentile(t,75),a=i-r,c=r-1.5*a,m=i+1.5*a,o=e.filter(s=>s>=c&&s<=m);return o.length<e.length*(1-n)?e:o}static assessReliability(e,n){if(e.length<10)return{reliability:"low",coefficientOfVariation:0,recommendation:"Sample size too small for reliable measurement"};if(n<50)return{reliability:"low",coefficientOfVariation:0,recommendation:"Total runtime too short for reliable timing measurement"};let t=e.reduce((c,m)=>c+m,0)/e.length,r=t>0?this.standardDeviation(e)/t:0,i,a;return r<.05?(i="high",a="Excellent measurement stability - high confidence in results"):r<.15?(i="medium",a="Good measurement stability - results are likely reliable"):(i="low",a="High variability detected - consider checking for system interference or increasing sample size"),{reliability:i,coefficientOfVariation:r,recommendation:a}}static detectAnomalies(e){if(e.length<10)return{outliers:[],anomalyCount:0,anomalyRate:0,recommendation:"Sample size too small for reliable anomaly detection"};let n=[...e].sort((u,p)=>u-p),t=this.percentile(n,25),r=this.percentile(n,75),i=r-t,a=t-1.5*i,c=r+1.5*i,m=e.filter(u=>u<a||u>c),o=m.length/e.length,s;return o>.2?s="High anomaly rate detected - check for system interference, GC pressure, or thermal throttling":o>.1?s="Moderate anomaly rate - consider increasing sample size or checking environment":o>.05?s="Low anomaly rate - results are likely reliable":s="Very low anomaly rate - high confidence in results",{outliers:m,anomalyCount:m.length,anomalyRate:o,recommendation:s}}};function J(){return R(this,null,function*(){"gc"in window&&typeof window.gc=="function"&&window.gc?.();let l=new Array(1e6).fill(0);yield q(),l.length=0,yield new Promise(e=>setTimeout(e,100))})}function Y(l,e){return R(this,null,function*(){let n=Math.max(0,e.warmup??0),t=Math.max(0,e.yieldEvery??0),r=F(e.operations,e.operationsCap,e.label),i=new Set;try{for(let f=0;f<n;f++)yield l(f),t&&(f+1)%t===0&&(yield q());let a=e.trackMemory&&v.memory?v.memory.usedJSHeapSize:void 0;e.trackMemory&&(yield q(),"requestIdleCallback"in window&&(yield new Promise(f=>{let h=()=>f(),b=setTimeout(h,50);i.add(b),window.requestIdleCallback(()=>{i.delete(b),clearTimeout(b),h()},{timeout:50})})));let c=1,m=0,o=Math.max(0,e.minDurationMs??0),s=!0;do{let f=performance.now();for(let b=0;b<r;b++)yield l(b),t&&(b+1)%t===0&&(yield q());let h=performance.now();m+=h-f,m<o?(c++,c>64&&(s=!1)):s=!1}while(s);let u=e.trackMemory&&v.memory?v.memory.usedJSHeapSize:void 0,p=a!==void 0&&u!==void 0?(u-a)/(1024*1024):void 0;return{durationMs:m/c,memoryDeltaMB:p}}finally{i.forEach(a=>clearTimeout(a)),i.clear()}})}function X(l,e){return R(this,null,function*(){let{warmup:n=5,operations:t,yieldEvery:r=0,trackMemory:i=!1,label:a="benchmark",measurementSamples:c=30,maxRuntimeMs:m=3e4,removeOutliers:o=!0,minSamples:s=10,forceGC:u=!1,operationsCap:p,minDurationMs:f=100,onProgress:h}=e,b=F(t,p,a);u&&(yield J());for(let d=0;d<n;d++)yield l(d),r&&(d+1)%r===0&&(yield q());u&&(yield J());let y=[],P=i&&v.memory?v.memory.usedJSHeapSize:void 0,k=0,T=0;for(;y.length<c&&k<m||k<f&&y.length<c*3;){let d=performance.now();for(let w=0;w<b;w++)yield l(w);let S=performance.now()-d;y.push(S),k+=S,T+=b,typeof h=="function"&&K.schedule({samplesCollected:y.length,elapsedMs:k},w=>h(w)),y.length%10===0&&(yield q())}let A=i&&v.memory?v.memory.usedJSHeapSize:void 0,C=o?g.removeStatisticalOutliers(y):y;C.length<s&&(C=y);let M=[...C].sort((d,S)=>d-S),W=M.reduce((d,S)=>d+S,0)/M.length,z=g.assessReliability(C,k),E=g.detectAnomalies(y),H=I(x({median:g.percentile(M,50),mean:W,min:M[0],max:M[M.length-1],p95:g.percentile(M,95),p99:g.percentile(M,99),stdDev:g.standardDeviation(M),samples:C,sampleCount:C.length,totalIterations:T,totalRuntimeMs:k},i&&P!==void 0&&A!==void 0&&{memoryDeltaMB:(A-P)/(1024*1024)}),{reliability:z.reliability,coefficientOfVariation:z.coefficientOfVariation,outlierCount:E.anomalyCount,anomalyRate:E.anomalyRate,recommendation:z.recommendation});function $(d,S){if(!d||d.length===0)return!1;let w=d.length;if(d.filter(D=>D===0).length/w>=.25)return!0;let B=new Map;for(let D of d){let U=Math.round(D*10)/10;B.set(U,(B.get(U)??0)+1)}let O=0;for(let D of B.values())D>O&&(O=D);return O/w>=.35&&S<.5}try{if(!!!e.__adaptiveAttempted&&$(y,H.median)){let w=Math.max(f*4,500),V=Math.max(c*2,c+10),B=I(x({},e),{minDurationMs:w,measurementSamples:V,__adaptiveAttempted:!0});return yield X(l,B)}}catch{}return H})}var L=class{static compareBenchmarks(e,n,t,r,i=.95){let a=e.median-t.median,c=t.median>0?(t.median-e.median)/t.median*100:0,m=this.bootstrapMedianDifference(e.samples,t.samples,1e3,i),o=this.mannWhitneyUTest(e.samples,t.samples),s=this.cohensD(e.samples,t.samples),u;return o.isSignificant?a<0?u=`${n} is significantly faster than ${r}`:u=`${r} is significantly faster than ${n}`:u="No statistically significant difference detected",{library1:n,library2:r,medianDifference:a,percentageImprovement:c,isStatisticallySignificant:o.isSignificant,confidenceInterval:[m.lowerBound,m.upperBound],effectSize:s.effectSize,effectSizeInterpretation:s.interpretation,conclusion:u}}static bootstrapMedianDifference(e,n,t=1e3,r=.95){let i=[];for(let o=0;o<t;o++){let s=this.bootstrapSample(e),u=this.bootstrapSample(n),p=g.percentile([...s].sort((f,h)=>f-h),50)-g.percentile([...u].sort((f,h)=>f-h),50);i.push(p)}i.sort((o,s)=>o-s);let a=1-r,c=Math.floor(a/2*t),m=Math.floor((1-a/2)*t);return{lowerBound:i[c],upperBound:i[m]}}static mannWhitneyUTest(e,n){let t=e.length,r=n.length,i=[...e.map(o=>({value:o,group:1})),...n.map(o=>({value:o,group:2}))].sort((o,s)=>o.value-s.value),a=0;for(let o=0;o<i.length;o++)i[o].group===1&&(a+=o+1);let c=a-t*(t+1)/2,m=Math.min(c,t*r-c);if(t>20&&r>20){let o=t*r/2,s=Math.sqrt(t*r*(t+r+1)/12),u=Math.abs((m-o)/s),p=2*(1-this.normalCDF(u));return{isSignificant:p<.05,pValue:p}}return{isSignificant:!1,pValue:1}}static cohensD(e,n){let t=e.reduce((u,p)=>u+p,0)/e.length,r=n.reduce((u,p)=>u+p,0)/n.length,i=this.variance(e),a=this.variance(n),c=Math.sqrt(((e.length-1)*i+(n.length-1)*a)/(e.length+n.length-2)),m=(t-r)/c,o=Math.abs(m),s;return o<.2?s="Negligible effect":o<.5?s="Small effect":o<.8?s="Medium effect":s="Large effect",{effectSize:m,interpretation:s}}static normalCDF(e){return .5*(1+this.erf(e/Math.sqrt(2)))}static erf(e){let n=.254829592,t=-.284496736,r=1.421413741,i=-1.453152027,a=1.061405429,c=.3275911,m=e<0?-1:1;e=Math.abs(e);let o=1/(1+c*e),s=1-((((a*o+i)*o+r)*o+t)*o+n)*o*Math.exp(-e*e);return m*s}static variance(e){let n=e.reduce((t,r)=>t+r,0)/e.length;return e.reduce((t,r)=>t+Math.pow(r-n,2),0)/(e.length-1)}static bootstrapSample(e){let n=[];for(let t=0;t<e.length;t++){let r=Math.floor(Math.random()*e.length);n.push(e[r])}return n}},_=class{static detectPerformanceThrottling(){return R(this,null,function*(){let n=performance.now(),t=0;for(let m=0;m<1e5;m++)t+=Math.sqrt(m)*Math.sin(m);let i=1e5/(performance.now()-n),a=i<300,c;return a?c="Performance throttling detected. Consider: closing other tabs, plugging in laptop, checking thermal throttling, or running in incognito mode.":i<500?c="Moderate performance detected. Results may have higher variance.":c="Good performance environment detected.",{isThrottled:a,opsPerMs:i,recommendation:c}})}static validateEnvironment(){return R(this,null,function*(){let e=[],n=[],t=yield this.detectPerformanceThrottling();if(t.isThrottled&&(e.push("Performance throttling detected"),n.push(t.recommendation)),v.memory){let i=v.memory;i.usedJSHeapSize/i.jsHeapSizeLimit*100>80&&(e.push("High memory usage detected"),n.push("Consider closing other tabs or refreshing the page to free memory"))}return"requestIdleCallback"in window||n.push("Browser lacks requestIdleCallback support - timing may be less accurate"),window.outerHeight-window.innerHeight>160&&n.push("Developer tools appear to be open - this may affect performance measurements"),{isReady:e.length===0,issues:e,recommendations:n}})}};export{q as a,g as b,J as c,Y as d,X as e,L as f,_ as g};
