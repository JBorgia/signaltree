import{a as i,ba as l,xa as f}from"./chunk-M6ZH6AMU.js";var d=class c{metrics=f({signalTree:{operations:[],averageOperationTime:0,totalOperations:0,memoryUsage:0},pageLoad:{totalTime:0,domContentLoaded:0,firstContentfulPaint:0,largestContentfulPaint:0},bundleSize:{main:0,polyfills:0,styles:0,lazy:{}},userInteractions:{clickResponsiveness:[],navigationTime:[]},systemInfo:{userAgent:"",memory:0,cores:0,connection:""}});constructor(){this.initializeSystemInfo(),this.monitorPagePerformance()}recordSignalTreeOperation(e,n,t){let r=this.metrics(),a={operation:e,duration:n,timestamp:Date.now(),metadata:t};r.signalTree.operations.push(a),r.signalTree.totalOperations++;let o=r.signalTree.operations.slice(-100);r.signalTree.averageOperationTime=o.reduce((s,m)=>s+m.duration,0)/o.length,this.metrics.set(i({},r))}recordUserInteraction(e,n){let t=this.metrics();e==="click"?(t.userInteractions.clickResponsiveness.push({duration:n,timestamp:Date.now()}),t.userInteractions.clickResponsiveness.length>50&&t.userInteractions.clickResponsiveness.shift()):(t.userInteractions.navigationTime.push({duration:n,timestamp:Date.now()}),t.userInteractions.navigationTime.length>20&&t.userInteractions.navigationTime.shift()),this.metrics.set(i({},t))}updateMemoryUsage(){if(typeof window<"u"&&"memory"in performance){let e=performance.memory,n=this.metrics();n.signalTree.memoryUsage=e.usedJSHeapSize,this.metrics.set(i({},n))}}getMetrics(){return this.metrics()}getPerformanceScore(){let e=this.metrics(),n=e.signalTree.averageOperationTime,t=Math.min(100,Math.max(0,n<=50?100:100-(n-50)/150*100)),r=e.userInteractions.clickResponsiveness.map(g=>g.duration),a=r.length>0?r.reduce((g,y)=>g+y,0)/r.length:100,o=Math.min(100,Math.max(0,a<=100?100:100-(a-100)/400*100)),s=e.pageLoad.totalTime,m=Math.min(100,Math.max(0,s<=1e3?100:100-(s-1e3)/9e3*100)),p=e.signalTree.memoryUsage/(1024*1024),u=Math.min(100,Math.max(0,p<=50?100:100-(p-50)/150*100)),h=(t+o+m+u)/4;return{overall:Math.round(h),operation:Math.round(t),responsiveness:Math.round(o),loading:Math.round(m),memory:Math.round(u)}}generateReport(){let e=this.metrics(),n=this.getPerformanceScore();return{timestamp:new Date().toISOString(),score:n,metrics:e,recommendations:this.getRecommendations(n,e),summary:{totalOperations:e.signalTree.totalOperations,averageResponseTime:e.signalTree.averageOperationTime,memoryUsageMB:Math.round(e.signalTree.memoryUsage/(1024*1024)),pageLoadTime:e.pageLoad.totalTime}}}exportData(){return JSON.stringify(this.generateReport(),null,2)}initializeSystemInfo(){let e=this.metrics();typeof window<"u"&&(e.systemInfo.userAgent=navigator.userAgent,e.systemInfo.cores=navigator.hardwareConcurrency||0,"memory"in performance&&(e.systemInfo.memory=performance.memory.jsHeapSizeLimit),"connection"in navigator&&(e.systemInfo.connection=navigator.connection?.effectiveType||"unknown")),this.metrics.set(i({},e))}monitorPagePerformance(){typeof window<"u"&&(window.addEventListener("load",()=>{setTimeout(()=>{let e=performance.getEntriesByType("navigation")[0],n=this.metrics();n.pageLoad.totalTime=e.loadEventEnd-e.fetchStart,n.pageLoad.domContentLoaded=e.domContentLoadedEventEnd-e.fetchStart,this.metrics.set(i({},n))},0)}),"getEntriesByType"in performance&&new PerformanceObserver(n=>{let t=this.metrics();n.getEntries().forEach(r=>{r.name==="first-contentful-paint"?t.pageLoad.firstContentfulPaint=r.startTime:r.name==="largest-contentful-paint"&&(t.pageLoad.largestContentfulPaint=r.startTime)}),this.metrics.set(i({},t))}).observe({entryTypes:["paint","largest-contentful-paint"]}))}getRecommendations(e,n){let t=[];return e.operation<80&&t.push("Consider optimizing SignalTree operations or reducing operation frequency"),e.responsiveness<80&&t.push("User interactions are slow. Check for blocking operations in event handlers"),e.loading<80&&t.push("Page load time is high. Consider code splitting or bundle optimization"),e.memory<80&&t.push("High memory usage detected. Check for memory leaks or optimize data structures"),n.signalTree.operations.length>1e3&&t.push("High operation count. Consider implementing operation batching"),t}static \u0275fac=function(n){return new(n||c)};static \u0275prov=l({token:c,factory:c.\u0275fac,providedIn:"root"})};export{d as a};
