<div class="container">
  <h1>üöÄ SignalTree Callable Syntax</h1>

  <!-- Info Banner -->
  <div class="info-banner">
    <h3>
      ‚ú® Comprehensive Callable Syntax with &#64;signaltree/callable-syntax
    </h3>
    <p>
      This demo showcases the complete callable syntax that transforms at build
      time:
    </p>
    <ul>
      <li>
        <code>tree.$.name('value')</code>
        ‚Üí
        <code>tree.$.name.set('value')</code>
      </li>
      <li>
        <code>tree.$.age(n => n + 1)</code>
        ‚Üí
        <code>tree.$.age.update(n => n + 1)</code>
      </li>
      <li>
        <code>tree.$.profile.email('new&#64;email.com')</code>
        ‚Üí
        <code>tree.$.profile.email.set('new&#64;email.com')</code>
      </li>
      <li>
        <code>tree.$.items(arr => [...arr, item])</code>
        ‚Üí
        <code>tree.$.items.update(arr => [...arr, item])</code>
      </li>
    </ul>
    <p>
      <strong>Note:</strong> TypeScript may show errors in the IDE - that's
      expected! The &#64;signaltree/callable-syntax transform fixes them at
      build time.
    </p>
  </div>

  <!-- Section Tabs -->
  <div class="section-tabs">
    <button
      [class.active]="activeSection === 'basic'"
      (click)="activeSection = 'basic'"
    >
      Basic Patterns
    </button>
    <button
      [class.active]="activeSection === 'complex'"
      (click)="activeSection = 'complex'"
    >
      Complex Objects
    </button>
    <button
      [class.active]="activeSection === 'arrays'"
      (click)="activeSection = 'arrays'"
    >
      Array Operations
    </button>
    <button
      [class.active]="activeSection === 'performance'"
      (click)="activeSection = 'performance'"
    >
      Performance Demo
    </button>
  </div>

  <!-- Basic Patterns Section -->
  <div *ngIf="activeSection === 'basic'" class="demo-grid">
    <div class="card">
      <h3>üë§ Basic Profile</h3>
      <div class="state-display">
        <p><strong>Name:</strong> {{ basicProfile.$.name() }}</p>
        <p><strong>Age:</strong> {{ basicProfile.$.age() }}</p>
        <p><strong>Email:</strong> {{ basicProfile.$.profile.email() }}</p>
        <p>
          <strong>Active:</strong> {{ basicProfile.$.active() ? 'Yes' : 'No' }}
        </p>
        <p><strong>Tags:</strong> {{ basicProfile.$.tags().join(', ') }}</p>
        <p>
          <strong>Theme:</strong> {{ basicProfile.$.profile.settings.theme() }}
        </p>
      </div>
      <div class="action-buttons">
        <button (click)="updateBasicProfile()" class="btn-primary">
          Update Profile
        </button>
        <button (click)="incrementAge()" class="btn-secondary">+1 Age</button>
        <button (click)="addTag()" class="btn-success">Add Tag</button>
        <button (click)="toggleTheme()" class="btn-purple">Toggle Theme</button>
      </div>
    </div>
  </div>

  <!-- Complex Objects Section -->
  <div *ngIf="activeSection === 'complex'" class="demo-grid">
    <div class="card">
      <h3>üè¢ Professional Profile</h3>
      <div class="state-display">
        <p>
          <strong>Name:</strong>
          {{ complexTree.$.user.profile.personal.firstName() }}
          {{ complexTree.$.user.profile.personal.lastName() }}
        </p>
        <p>
          <strong>Age:</strong> {{ complexTree.$.user.profile.personal.age() }}
        </p>
        <p>
          <strong>Title:</strong>
          {{ complexTree.$.user.profile.professional.title() }}
        </p>
        <p>
          <strong>Company:</strong>
          {{ complexTree.$.user.profile.professional.company() }}
        </p>
        <p>
          <strong>Skills:</strong>
          {{ complexTree.$.user.profile.professional.skills().join(', ') }}
        </p>
      </div>
      <div class="action-buttons">
        <button (click)="updateProfessional()" class="btn-primary">
          Promote
        </button>
        <button (click)="addSkill()" class="btn-secondary">Add Skill</button>
        <button (click)="agePerson()" class="btn-secondary">Birthday</button>
      </div>
    </div>

    <div class="card">
      <h3>üé® UI Preferences</h3>
      <div class="state-display">
        <p>
          <strong>Theme:</strong>
          {{ complexTree.$.user.preferences.ui.theme() }}
        </p>
        <p>
          <strong>Language:</strong>
          {{ complexTree.$.user.preferences.ui.language() }}
        </p>
        <p>
          <strong>Sidebar Width:</strong>
          {{ complexTree.$.user.preferences.ui.sidebar.width() }}px
        </p>
        <p>
          <strong>Collapsed:</strong>
          {{
            complexTree.$.user.preferences.ui.sidebar.collapsed() ? 'Yes' : 'No'
          }}
        </p>
        <p>
          <strong>Notification Frequency:</strong>
          {{ complexTree.$.user.preferences.notifications.frequency() }}
        </p>
      </div>
      <div class="action-buttons">
        <button (click)="toggleComplexTheme()" class="btn-primary">
          Toggle Theme
        </button>
        <button (click)="toggleSidebar()" class="btn-secondary">
          Toggle Sidebar
        </button>
        <button (click)="changeNotificationFreq()" class="btn-secondary">
          Change Frequency
        </button>
      </div>
    </div>
  </div>

  <!-- Array Operations Section -->
  <div *ngIf="activeSection === 'arrays'" class="performance-stats">
    <div class="card">
      <h3>üî¢ Number Array</h3>
      <div class="state-display">
        <p>
          <strong>Numbers:</strong> [{{ arrayTree.$.numbers().join(', ') }}]
        </p>
        <p><strong>Count:</strong> {{ arrayTree.$.numbers().length }}</p>
        <p><strong>Sum:</strong> {{ getSum() }}</p>
      </div>
      <div class="action-buttons">
        <button (click)="replaceNumbers()" class="btn-primary">
          Replace All
        </button>
        <button (click)="addNumbers()" class="btn-secondary">
          Add Numbers
        </button>
        <button (click)="filterNumbers()" class="btn-secondary">
          Filter > 25
        </button>
      </div>
    </div>

    <div class="card">
      <h3>üë• User Array</h3>
      <div class="user-list">
        <div
          *ngFor="let user of arrayTree.$.users(); trackBy: trackUser"
          class="user-item"
        >
          <strong>{{ user.name }}</strong> - {{ user.role }}
        </div>
      </div>
      <div class="action-buttons">
        <button (click)="addUser()" class="btn-primary">Add User</button>
        <button (click)="promoteUser()" class="btn-secondary">
          Promote First
        </button>
      </div>
    </div>

    <div class="card">
      <h3>üóÇÔ∏è Nested Collections</h3>
      <div class="state-display">
        <p>
          <strong>Tags:</strong>
          {{ arrayTree.$.nested.collections.tags().join(', ') }}
        </p>
        <p>
          <strong>Categories:</strong>
          {{ arrayTree.$.nested.collections.categories().join(', ') }}
        </p>
        <p><strong>Matrix:</strong></p>
        <div
          *ngFor="let row of arrayTree.$.nested.matrix(); trackBy: trackRow"
          class="matrix-row"
        >
          [{{ row.join(', ') }}]
        </div>
      </div>
      <div class="action-buttons">
        <button (click)="addMatrixTag()" class="btn-primary">Add Tag</button>
        <button (click)="sortTags()" class="btn-secondary">Sort Tags</button>
        <button (click)="addMatrixRow()" class="btn-secondary">Add Row</button>
      </div>
    </div>
  </div>

  <!-- Performance Section -->
  <div *ngIf="activeSection === 'performance'" class="demo-grid">
    <div class="card">
      <h3>‚ö° Performance Counter</h3>
      <div class="state-display">
        <p><strong>Counter:</strong> {{ performanceDemo.$.counter() }}</p>
        <p>
          <strong>Batch Operations:</strong>
          {{ performanceDemo.$.batchCount() }}
        </p>
        <p>
          <strong>Last Update:</strong>
          {{ performanceDemo.$.lastUpdate().toLocaleTimeString() }}
        </p>
        <p>
          <strong>Update History:</strong>
          {{ performanceDemo.$.updateHistory().length }} entries
        </p>
      </div>
      <div class="action-buttons">
        <button (click)="incrementCounter()" class="btn-primary">
          +1 Counter
        </button>
        <button (click)="batchUpdate()" class="btn-secondary">
          Batch +100
        </button>
        <button (click)="resetCounter()" class="btn-secondary">
          Reset All
        </button>
      </div>
    </div>

    <div class="card">
      <h3>üìä Stress Test</h3>
      <div class="state-display">
        <p><strong>Operations:</strong> {{ stressTest.$.operations() }}</p>
        <p>
          <strong>Deep Value:</strong>
          {{ stressTest.$.deep.level1.level2.level3.value() }}
        </p>
        <p>
          <strong>Array Length:</strong> {{ stressTest.$.largeArray().length }}
        </p>
      </div>
      <div class="action-buttons">
        <button (click)="runStressTest()" class="btn-primary">
          Run Stress Test
        </button>
        <button (click)="updateDeepValue()" class="btn-secondary">
          Update Deep
        </button>
        <button (click)="growArray()" class="btn-secondary">Grow Array</button>
      </div>
    </div>
  </div>

  <!-- Code Examples -->
  <div class="example-section">
    <h3>üíª Code Examples</h3>

    <div class="code-tabs">
      <button
        [class.active]="activeTab === 'callable'"
        (click)="activeTab = 'callable'"
      >
        New Callable Syntax
      </button>
      <button
        [class.active]="activeTab === 'current'"
        (click)="activeTab = 'current'"
      >
        Current Explicit Syntax
      </button>
    </div>

    <div>
      <pre
        *ngIf="activeTab === 'callable'"
        class="code-block"
      ><code>// ‚ú® New Callable Syntax (transforms at build time)

// Basic value setting
tree.$.name('Jane');                           // ‚Üí .set('Jane')
tree.$.age(25);                               // ‚Üí .set(25)
tree.$.active(true);                          // ‚Üí .set(true)

// Functional updates
tree.$.age(current => current + 1);          // ‚Üí .update(fn)
tree.$.tags(tags => [...tags, 'new']);       // ‚Üí .update(fn)

// Deep nested objects
tree.$.user.profile.email('new&#64;email.com');  // ‚Üí .set('new&#64;email.com')
tree.$.settings.ui.theme('dark');            // ‚Üí .set('dark')

// Complex updates
tree.$.user.profile(profile => updateProfile(profile));  // ‚Üí .update(fn)

// Array operations
tree.$.numbers([10, 20, 30]);                // ‚Üí .set([10, 20, 30])
tree.$.users(users => users.filter(u => u.active)); // ‚Üí .update(fn)

// Reading values (unchanged)
const name = tree.$.name();                  // Always works
const age = tree.$.user.profile.age();      // Deep access</code></pre>

      <pre
        *ngIf="activeTab === 'current'"
        class="code-block"
      ><code>// üîß Current Explicit Syntax (always works)

// Basic value setting
tree.$.name.set('Jane');
tree.$.age.set(25);
tree.$.active.set(true);

// Functional updates
tree.$.age.update(current => current + 1);
tree.$.tags.update(tags => [...tags, 'new']);

// Deep nested objects
tree.$.user.profile.email.set('new&#64;email.com');
tree.$.settings.ui.theme.set('dark');

// Complex updates
tree.$.user.profile.update(profile => updateProfile(profile));

// Array operations
tree.$.numbers.set([10, 20, 30]);
tree.$.users.update(users => users.filter(u => u.active));

// Reading values
const name = tree.$.name();
const age = tree.$.user.profile.age();</code></pre>
    </div>
  </div>
</div>
