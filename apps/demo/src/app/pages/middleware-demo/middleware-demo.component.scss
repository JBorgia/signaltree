// Middleware Demo - Using Global Design System
@import '../../../styles.scss';

.container {
  max-width: 1600px;
  margin: 0 auto;
  padding: var(--space-8) var(--space-4);

  h1 {
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: var(--space-8);
    color: var(--color-neutral-900);
  }

  h2 {
    font-size: 1.5rem;
    font-weight: 600;
    margin-bottom: var(--space-6);
    color: var(--color-neutral-900);
  }

  h3 {
    font-weight: 500;
    margin-bottom: var(--space-3);
    color: var(--color-neutral-700);
  }
}

.demo-grid-3col {
  display: grid;
  grid-template-columns: 1fr;
  gap: var(--space-8);

  @include desktop {
    grid-template-columns: repeat(3, 1fr);
  }
}

.card {
  @include card;
}

.section-card {
  @include card;
  margin-top: var(--space-8);
}

.middleware-section {
  display: flex;
  flex-direction: column;
  gap: var(--space-6);

  .middleware-toggles {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);

    .middleware-toggle {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: var(--space-2);
      border-radius: var(--radius-md);
      transition: all var(--transition-fast);
      cursor: pointer;

      &.active {
        background: var(--color-success-50);
        border: 1px solid var(--color-success-300);
      }

      &:not(.active) {
        border: 1px solid transparent;
      }

      .toggle-content {
        display: flex;
        align-items: center;
        gap: var(--space-2);

        input[type='checkbox'] {
          cursor: pointer;
        }

        span {
          font-size: 0.875rem;
        }
      }

      .toggle-badge {
        font-size: 0.75rem;
        padding: var(--space-1) var(--space-2);
        border-radius: var(--radius-md);
        font-weight: 600;

        &.on {
          background: var(--color-success-200);
          color: var(--color-success-800);
        }

        &.off {
          background: var(--color-neutral-200);
          color: var(--color-neutral-600);
        }
      }
    }
  }

  .chain-panel {
    background: var(--color-neutral-50);
    border: 1px solid var(--color-neutral-200);
    border-radius: var(--radius-lg);
    padding: var(--space-4);
    margin-top: var(--space-4);

    h3 {
      font-weight: 500;
      margin-bottom: var(--space-3);
    }

    .chain-info {
      font-size: 0.75rem;
      color: var(--color-neutral-600);
      margin-bottom: var(--space-2);
    }

    .chain-flow {
      display: flex;
      flex-direction: column;
      gap: var(--space-2);

      .chain-step {
        display: flex;
        align-items: center;
        gap: var(--space-2);

        &::after {
          content: 'â†’';
          color: var(--color-neutral-400);
          margin-left: auto;
        }

        &:last-child::after {
          content: '';
        }
      }

      .chain-badge {
        display: inline-block;
        padding: var(--space-1) var(--space-3);
        border-radius: var(--radius-md);
        font-size: 0.75rem;
        font-weight: 600;

        &.start,
        &.end {
          background: var(--color-primary-500);
          color: white;
        }

        &.middleware {
          background: var(--color-success-100);
          color: var(--color-success-800);
          border: 1px solid var(--color-success-300);
        }

        &.core {
          background: var(--color-purple-100);
          color: var(--color-purple-800);
          border: 1px solid var(--color-purple-300);
          font-weight: 600;
        }
      }

      .indent-1 {
        margin-left: var(--space-4);
      }
      .indent-2 {
        margin-left: var(--space-8);
      }
      .indent-3 {
        margin-left: var(--space-12);
      }
    }
  }

  .actions-panel {
    .action-buttons {
      display: flex;
      flex-direction: column;
      gap: var(--space-2);
    }
  }

  .undo-panel {
    .undo-controls {
      display: flex;
      gap: var(--space-2);
      margin-bottom: var(--space-3);
    }

    .undo-info {
      font-size: 0.875rem;

      p {
        margin: 0;
      }
    }
  }
}

.filter-tabs {
  display: flex;
  border-bottom: 1px solid var(--color-neutral-200);
  margin-bottom: var(--space-4);

  .filter-tab,
  button {
    padding: var(--space-2) var(--space-4);
    border-bottom: 2px solid transparent;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--color-neutral-500);
    background: none;
    border-top: none;
    border-left: none;
    border-right: none;
    cursor: pointer;
    transition: all var(--transition-fast);

    &:hover {
      color: var(--color-neutral-700);
    }

    &.active,
    &[class*='border-blue'] {
      border-bottom-color: var(--color-primary-500);
      color: var(--color-primary-600);
    }
  }
}

.add-todo-form {
  display: flex;
  gap: var(--space-2);
  margin-bottom: var(--space-4);

  input {
    flex: 1;
    @include input;
  }
}

.todos-list {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
  max-height: 16rem;
  overflow-y: auto;

  .todo-item {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-3);
    border: 1px solid var(--color-neutral-200);
    border-radius: var(--radius-lg);
    transition: background var(--transition-fast);

    &:hover {
      background: var(--color-neutral-50);
    }

    input[type='checkbox'] {
      cursor: pointer;
    }

    span {
      flex: 1;
      font-size: 0.875rem;

      &.completed {
        text-decoration: line-through;
        color: var(--color-neutral-500);
      }
    }
  }

  .empty-state {
    text-align: center;
    color: var(--color-neutral-500);
    padding: var(--space-8) var(--space-4);
  }
}

.stats-section {
  margin-top: var(--space-4);
  padding-top: var(--space-4);
  border-top: 1px solid var(--color-neutral-200);
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--space-4);
  text-align: center;
  font-size: 0.875rem;

  .stat-item {
    .stat-value {
      font-weight: 600;
      font-size: 1.5rem;

      &.primary {
        color: var(--color-primary-600);
      }

      &.success {
        color: var(--color-success-600);
      }

      &.warning {
        color: var(--color-warning-600);
      }
    }

    .stat-label {
      color: var(--color-neutral-500);
      margin-top: var(--space-1);
    }
  }
}

.logs-list {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
  max-height: 20rem;
  overflow-y: auto;

  .log-item {
    padding: var(--space-3);
    border-radius: var(--radius-lg);
    font-size: 0.875rem;
    border: 1px solid var(--color-neutral-200);

    &.before {
      background: var(--color-info-50);
      border-left: 3px solid var(--color-info-500);
    }

    &.after {
      background: var(--color-success-50);
      border-left: 3px solid var(--color-success-500);
    }

    &.error {
      background: var(--color-danger-50);
      border-left: 3px solid var(--color-danger-500);
    }

    .log-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--space-1);

      .log-action {
        font-weight: 500;
      }

      .log-time {
        font-size: 0.75rem;
        opacity: 0.75;
      }
    }

    .log-details {
      font-size: 0.75rem;
      opacity: 0.9;
    }

    .log-message {
      font-size: 0.75rem;
      margin-top: var(--space-1);
      opacity: 0.75;
    }
  }

  .empty-state {
    text-align: center;
    color: var(--color-neutral-500);
    padding: var(--space-8) var(--space-4);
  }
}

.undo-stack-list {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);

  .undo-entry {
    display: flex;
    align-items: center;
    gap: var(--space-4);
    padding: var(--space-3);
    background: var(--color-neutral-50);
    border-radius: var(--radius-lg);

    .entry-badge {
      width: 2rem;
      height: 2rem;
      background: var(--color-primary-500);
      color: white;
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.875rem;
      font-weight: 500;
      flex-shrink: 0;
    }

    .entry-content {
      flex: 1;

      .entry-action {
        font-weight: 500;
        font-size: 0.875rem;
      }

      .entry-details {
        font-size: 0.75rem;
        color: var(--color-neutral-500);
      }
    }

    .entry-change {
      font-size: 0.75rem;
      color: var(--color-neutral-400);
    }
  }
}

.features-card {
  background: var(--color-indigo-50) !important;

  .features-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--space-4);

    @include desktop {
      grid-template-columns: repeat(2, 1fr);
    }

    .feature-item {
      .feature-title,
      h3 {
        font-weight: 500;
        color: var(--color-indigo-800);
        margin-bottom: var(--space-2);
      }

      .feature-description,
      p {
        font-size: 0.875rem;
        color: var(--color-indigo-700);
      }
    }
  }
}

.arrow {
  color: var(--color-neutral-400);
}

.state-section {
  display: flex;
  flex-direction: column;
  gap: var(--space-4);

  .state-item {
    .state-value {
      font-size: 2rem;
      font-weight: 700;
      color: var(--color-primary-600);
    }

    .state-display {
      background: var(--color-neutral-50);
      padding: var(--space-3);
      border-radius: var(--radius-md);

      pre {
        margin: 0;
        font-size: 0.875rem;
        white-space: pre-wrap;
      }
    }

    .todos-list {
      list-style: none;
      padding: 0;
      margin: 0;
      display: flex;
      flex-direction: column;
      gap: var(--space-1);

      li {
        font-size: 0.875rem;
        padding: var(--space-1);
        background: var(--color-neutral-50);
        border-radius: var(--radius-sm);
      }
    }
  }
}

.pipeline-section {
  .pipeline-flow {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
    flex-wrap: wrap;
    padding: var(--space-4);

    .pipeline-step {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--space-2);
      padding: var(--space-4);
      border-radius: var(--radius-lg);
      border: 2px solid var(--color-neutral-300);
      background: white;
      min-width: 120px;
      transition: all var(--transition-fast);

      &.active {
        border-color: var(--color-success-500);
        background: var(--color-success-50);
        transform: translateY(-4px);
        box-shadow: 0 4px 12px rgba(34, 197, 94, 0.2);
      }

      .step-icon {
        font-size: 2rem;
      }

      .step-name {
        font-weight: 600;
        font-size: 0.875rem;
      }

      .step-status {
        font-size: 0.75rem;
        padding: var(--space-1) var(--space-2);
        border-radius: var(--radius-full);
        background: var(--color-neutral-100);
        color: var(--color-neutral-700);
      }

      &.active .step-status {
        background: var(--color-success-200);
        color: var(--color-success-800);
      }
    }

    .pipeline-arrow {
      font-size: 1.5rem;
      color: var(--color-neutral-400);
      font-weight: 700;
    }
  }
}

.btn-sm {
  padding: var(--space-1) var(--space-3);
  font-size: 0.875rem;
}
