<div class="container">
  <h1>SignalTree DevTools Demo</h1>

  <div class="demo-grid">
    <!-- State Controls -->
    <div class="card">
      <h2>State Management</h2>

      <div class="controls-section">
        <!-- Counter -->
        <div>
          <label for="counterValue" class="label"
            >Counter: {{ counter() }}</label
          >
          <div class="button-group">
            <button (click)="increment()" class="btn-primary">+1</button>
            <button (click)="decrement()" class="btn-danger">-1</button>
            <button (click)="reset()" class="btn-secondary">Reset</button>
          </div>
        </div>

        <!-- User Info -->
        <div class="user-info-section">
          <h3>User Information</h3>
          <div>
            <label for="userName" class="label">Name:</label>
            <input
              id="userName"
              type="text"
              [value]="this.store.$.user.name()"
              (input)="updateUserName($event)"
              class="form-input"
            />
          </div>
          <div>
            <label for="userEmail" class="label">Email:</label>
            <input
              id="userEmail"
              type="email"
              [value]="this.store.$.user.email()"
              (input)="updateUserEmail($event)"
              class="form-input"
            />
          </div>
          <div>
            <label for="theme" class="label">Theme:</label>
            <select
              id="theme"
              [value]="this.store.$.user.preferences.theme()"
              (change)="updateTheme($event)"
              class="form-select"
            >
              <option value="light">Light</option>
              <option value="dark">Dark</option>
            </select>
          </div>
          <div class="checkbox-group">
            <input
              id="notifications"
              type="checkbox"
              [checked]="this.store.$.user.preferences.notifications()"
              (change)="toggleNotifications()"
            />
            <label for="notifications">Enable Notifications</label>
          </div>
        </div>

        <!-- Todo Management -->
        <div>
          <h3>Todos</h3>
          <div class="input-group">
            <input
              type="text"
              [(ngModel)]="newTodoText"
              placeholder="Enter todo..."
              class="form-input"
            />
            <button
              (click)="addTodo()"
              [disabled]="!newTodoText.trim()"
              class="btn-success"
            >
              Add
            </button>
          </div>
          <button (click)="addMultipleTodos()" class="btn-purple full-width">
            Add 5 Random Todos
          </button>
        </div>
      </div>
    </div>

    <!-- DevTools Info -->
    <div class="card">
      <h2>DevTools Information</h2>

      <div class="devtools-section">
        <!-- Performance Metrics -->
        <div>
          <h3>Performance Metrics</h3>
          <div class="metrics-list">
            <p><strong>Updates:</strong> {{ getMetrics().updates }}</p>
            <p>
              <strong>Average Update Time:</strong>
              {{ getMetrics().averageUpdateTime }}ms
            </p>
            <p>
              <strong>Last Update Time:</strong>
              {{ getMetrics().averageUpdateTime }}ms
            </p>
            <p>
              <strong>Total Execution Time:</strong>
              {{ getMetrics().computations }}
            </p>
          </div>
        </div>

        <!-- State Info -->
        <div>
          <h3>State Information</h3>
          <div class="metrics-list">
            <p><strong>State Size:</strong> {{ getStateSize() }} properties</p>
            <p><strong>Deep Update Path:</strong> {{ getDeepestPath() }}</p>
            <p><strong>Last Action:</strong> {{ lastAction }}</p>
          </div>
        </div>

        <!-- DevTools Actions -->
        <div>
          <h3>DevTools Actions</h3>
          <div class="action-buttons">
            <button (click)="logState()" class="btn-info">
              Log Current State
            </button>
            <button (click)="takeSnapshot()" class="btn-purple">
              üì∏ Take Snapshot ({{ snapshots.length }})
            </button>
            <button (click)="resetMetrics()" class="btn-orange">
              Reset Metrics
            </button>
          </div>
        </div>

        <!-- State Snapshots -->
        <div *ngIf="snapshots.length > 0">
          <h3>Saved Snapshots</h3>
          <div class="snapshots-list">
            <div
              *ngFor="let snapshot of snapshots; let i = index"
              class="snapshot-item"
            >
              <div class="snapshot-info">
                <div class="snapshot-title">Snapshot #{{ i + 1 }}</div>
                <div class="snapshot-time">
                  {{ formatTimestamp(snapshot.timestamp) }}
                </div>
              </div>
              <div class="snapshot-actions">
                <button
                  (click)="restoreSnapshot(i)"
                  class="btn-primary btn-xs"
                  title="Restore this snapshot"
                >
                  ‚Üª Restore
                </button>
                <button
                  (click)="deleteSnapshot(i)"
                  class="btn-danger btn-xs"
                  title="Delete this snapshot"
                >
                  √ó
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Action History Timeline -->
  <div class="section-card">
    <h2>Action History Timeline</h2>
    <div class="history-section">
      <div class="history-header">
        <span class="history-count"
          >{{ actionHistory.length }} actions recorded</span
        >
        <div class="history-controls">
          <button
            (click)="replayActions()"
            [disabled]="actionHistory.length === 0 || replaying"
            class="btn-success btn-sm"
          >
            {{ replaying ? '‚ñ∂Ô∏è Replaying...' : '‚ñ∂Ô∏è Replay All' }}
          </button>
          <button
            (click)="clearHistory()"
            [disabled]="actionHistory.length === 0"
            class="btn-secondary btn-sm"
          >
            Clear History
          </button>
        </div>
      </div>

      <div class="history-list">
        <div
          *ngFor="let action of actionHistory; let i = index"
          class="history-item"
        >
          <div class="history-badge">{{ i + 1 }}</div>
          <div class="history-details">
            <div class="history-name">{{ action.name }}</div>
            <div class="history-meta">
              {{ formatTimestamp(action.timestamp) }} ‚Ä¢ {{ action.duration }}ms
            </div>
          </div>
          <button
            (click)="replaySingleAction(i)"
            class="btn-info btn-xs"
            title="Replay this action"
          >
            ‚Üª
          </button>
        </div>
        <div *ngIf="actionHistory.length === 0" class="no-history">
          No actions recorded yet
        </div>
      </div>
    </div>
  </div>

  <!-- Current State Display -->
  <div class="section-card">
    <h2>Live State View</h2>
    <div class="state-grid">
      <div>
        <h3>User & Counter</h3>
        <div class="state-display">
          <pre>{{ formatUserState() }}</pre>
        </div>
      </div>
      <div>
        <h3>Todos ({{ todos().length }})</h3>
        <div class="todos-display">
          <ul class="todos-list">
            <li *ngFor="let todo of todos(); let i = index" class="todo-item">
              <span [class.completed]="todo.completed">
                {{ todo.text }}
              </span>
              <div class="todo-actions">
                <button
                  (click)="toggleTodo(todo.id)"
                  class="btn-info btn-xs"
                  [attr.aria-pressed]="todo.completed"
                >
                  {{ todo.completed ? 'Undo' : 'Done' }}
                </button>
                <button (click)="removeTodo(todo.id)" class="btn-danger btn-xs">
                  √ó
                </button>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
