<div class="extreme-depth-container">
  <div class="header">
    <h1>üî• Extreme Depth Testing</h1>
    <p class="subtitle">
      Experience recursive typing at 15+ levels with perfect type inference
    </p>
  </div>

  <!-- Explanation Section -->
  <div class="explanation-section">
    <h2>üìñ What This Page Tests</h2>
    <div class="explanation-content">
      <p class="intro">
        This page demonstrates SignalTree's ability to maintain
        <strong>perfect TypeScript type inference</strong> at extreme nesting
        depths (15+ levels) without degrading to <code>'any'</code> types. This
        is a critical capability for real-world enterprise applications with
        deeply nested data structures.
      </p>

      <div class="concept-card">
        <h3>üéØ The Challenge: Type Inference at Depth</h3>
        <p>
          Most state management libraries struggle with deep nesting. After 3-7
          levels, TypeScript either:
        </p>
        <ul>
          <li>‚ùå Degrades to <code>'any'</code> types (losing type safety)</li>
          <li>‚ùå Requires manual type annotations at every level (poor DX)</li>
          <li>‚ùå Hits TypeScript's recursion limits (compilation errors)</li>
        </ul>
        <p>
          <strong>SignalTree solves this</strong> using advanced recursive type
          definitions that maintain full type inference at unlimited depth while
          staying within TypeScript's capabilities.
        </p>
      </div>

      <div class="concept-card">
        <h3>üî¨ How the Tests Work</h3>
        <p>
          This page runs both <strong>live demonstrations</strong> and
          references <strong>automated test suites</strong> that verify:
        </p>
        <ol>
          <li>
            <strong>Type Safety:</strong> TypeScript compiler confirms exact
            types at every level (no <code>'any'</code>, no type assertions)
          </li>
          <li>
            <strong>Runtime Functionality:</strong> Signals can be read,
            written, and observed at maximum depth
          </li>
          <li>
            <strong>Performance:</strong> Operations complete in sub-millisecond
            timeframes even at 15+ levels
          </li>
          <li>
            <strong>Reactivity:</strong> Updates propagate correctly through
            deeply nested structures
          </li>
        </ol>
      </div>

      <div class="concept-card">
        <h3>‚úÖ What "Passing" Means</h3>
        <div class="passing-criteria">
          <div class="criteria-item">
            <strong>TypeScript Compilation:</strong> Code compiles without
            errors or type warnings
          </div>
          <div class="criteria-item">
            <strong>Runtime Execution:</strong> All CRUD operations succeed at
            declared depth
          </div>
          <div class="criteria-item">
            <strong>Performance Threshold:</strong> Operations complete in &lt;
            1ms on standard hardware
          </div>
          <div class="criteria-item">
            <strong>Type Accuracy:</strong> IDE IntelliSense shows correct types
            (verified via <code>expectType&lt;T&gt;()</code> assertions)
          </div>
        </div>
        <p class="note">
          üí° <strong>Try it yourself:</strong> Use the buttons below to update
          values at 15+ levels deep. Notice how TypeScript provides perfect
          autocomplete and type checking at every step.
        </p>
      </div>
    </div>
  </div>

  <div class="demo-section">
    <h2>üèóÔ∏è Live Enterprise Structure</h2>
    <div class="structure-demo">
      <div class="path-display">
        <h3>Current Depth: {{ targetDepth }} levels</h3>
        <p class="depth-description">{{ depthDescription }}</p>
      </div>

      <div class="controls">
        <button
          class="btn primary"
          (click)="updateStatus()"
          [disabled]="isUpdating"
        >
          {{ isUpdating ? 'Updating...' : 'üîÑ Update Status' }}
        </button>

        <button class="btn secondary highlight" (click)="incrementDepth()">
          ‚ûï Increase Depth (+1)
        </button>

        <button class="btn secondary" (click)="updatePerformance()">
          ‚ö° Update Performance
        </button>

        @if (extensionPath.length > 0) {
          <button
            class="btn tertiary"
            (click)="resetDepth()"
          >
            üîÑ Reset to Base (15 levels)
          </button>
        }
      </div>

      <div class="depth-input-section">
        <label for="depth-input" class="depth-label">
          üéØ Jump to Specific Depth:
        </label>
        <div class="input-group">
          <input
            id="depth-input"
            type="number"
            [(ngModel)]="targetDepth"
            min="15"
            class="depth-input"
            placeholder="Enter depth (15+)"
          />
          <button class="btn primary" (click)="setDepthToTarget()">
            Go to {{ targetDepth | number }} Levels
          </button>
        </div>
        <p class="input-hint">
          Enter any depth from 15 onwards - SignalTree handles unlimited
          nesting!
        </p>
      </div>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-value">
            {{
              extremeTree.$.enterprise.divisions.technology.departments.engineering.teams.frontend.projects.signaltree.releases.v1.features.recursiveTyping.validation.tests.extreme.depth()
            }}
          </div>
          <div class="stat-label">Current Depth</div>
        </div>

        <div class="stat-card">
          <div class="stat-value">
            {{
              extremeTree.$.enterprise.divisions.technology.departments.engineering.teams.frontend.projects.signaltree.releases.v1.features.recursiveTyping.validation.tests.extreme.status()
            }}
          </div>
          <div class="stat-label">Status</div>
        </div>

        <div class="stat-card">
          <div class="stat-value">
            {{
              extremeTree.$.enterprise.divisions.technology.departments.engineering.teams.frontend.projects.signaltree.releases.v1.features.recursiveTyping.validation.tests.extreme.performance()
            }}
          </div>
          <div class="stat-label">Performance</div>
        </div>

        <div class="stat-card">
          <div class="stat-value">
            {{
              extremeTree.$.enterprise.divisions.technology.departments.engineering.teams.frontend.projects.signaltree.releases.v1.features.recursiveTyping.validation.tests.extreme.metadata.confidence()
            }}%
          </div>
          <div class="stat-label">Confidence</div>
        </div>
      </div>

      <div class="json-display">
        <h3>üì¶ Live Object Structure ({{ targetDepth }} levels)</h3>
        <p class="json-description">
          This shows the complete live state object with full type safety at
          every level. Watch it update in real-time as you interact with the
          controls!
        </p>
        <div class="code-example">
          <pre><code>{{ treeObjectPreview }}</code></pre>
        </div>
      </div>
    </div>
  </div>

  <div class="code-section">
    <h2>üíª Perfect Type Inference</h2>
    <div class="code-example">
      <h3>TypeScript knows this is a string signal at 15+ levels:</h3>
      <pre><code>{{ typeInferenceExample }}</code></pre>
    </div>

    <div class="code-example">
      <h3>Update operations maintain full type safety:</h3>
      <pre><code>{{ updateExample }}</code></pre>
    </div>
  </div>

  <div class="performance-section">
    <h2>‚ö° Performance Metrics</h2>
    <div class="performance-grid">
      <div class="perf-card">
        <h3>Tree Creation</h3>
        <div class="perf-value">{{ performanceMetrics.creation }}ms</div>
        <div class="perf-desc">Time to create 15+ level structure</div>
      </div>

      <div class="perf-card">
        <h3>Deep Access</h3>
        <div class="perf-value">{{ performanceMetrics.access }}ms</div>
        <div class="perf-desc">Time to access deepest signal</div>
      </div>

      <div class="perf-card">
        <h3>Deep Update</h3>
        <div class="perf-value">{{ performanceMetrics.update }}ms</div>
        <div class="perf-desc">Time to update at max depth</div>
      </div>
    </div>
  </div>

  <div class="validation-section">
    <h2>‚úÖ Automated Test Suite Results</h2>
    <div class="test-results">
      <div class="test-summary">
        <span class="test-count">{{ totalTestsPassing }} Tests Passing</span>
        <span class="test-coverage"
          >Including {{ extremeDepthTests }} Extreme Depth Tests</span
        >
        <span class="current-depth-badge">
          Target Depth: {{ targetDepth }} Levels ({{ depthCategory }})
        </span>
        <span class="test-status-message">
          {{ testStatusMessage }}
        </span>
      </div>

      <div class="test-explanation">
        <h3>üìã Test Categories Explained</h3>
        <p>
          Our test suite validates SignalTree's recursive typing across multiple
          depth ranges.
          <strong>Target depth: {{ targetDepth }} levels</strong> -
          {{ depthDescription }}
        </p>
        <p class="performance-note">
          ‚úÖ <strong>Real-time testing:</strong> Every depth change triggers
          functional verification. Type inference, reactivity, and performance
          are validated live as you explore different depths.
        </p>
      </div>

      <div class="test-categories">
        @for (category of testCategories; track category.name) {
          <div
            class="test-category detailed"
            [class.inactive]="!category.active"
          >
            <div class="category-header">
              <span class="category-name">{{ category.name }}</span>
              <span class="category-status">{{ category.status }}</span>
            </div>
            <div class="category-details">
              <p><strong>What we test:</strong></p>
              <ul>
                @for (test of category.tests; track test) {
                  <li>{{ test }}</li>
                }
              </ul>
              <p><strong>Why it matters:</strong> {{ category.relevance }}</p>
            </div>
          </div>
        }
      </div>

      <div class="technical-details">
        <h3>üîß Technical Implementation</h3>
        <p>
          These tests run in our CI/CD pipeline using Jest with TypeScript's
          <code>tsc</code> compiler. Key validation points:
        </p>
        <ul>
          <li>
            <strong>Compile-Time:</strong>
            <code>expectType&lt;Exact&lt;T, U&gt;&gt;()</code> assertions verify
            no type degradation
          </li>
          <li>
            <strong>Runtime:</strong> Standard Jest assertions validate
            functional correctness
          </li>
          <li>
            <strong>Performance:</strong>
            <code>performance.now()</code> measurements with statistical
            analysis
          </li>
        </ul>
        <p class="repo-link">
          üìÇ View test source:
          <code>/packages/core/src/lib/tests/extreme-depth.spec.ts</code>
        </p>
      </div>
    </div>
  </div>

  <div class="real-world-section">
    <h2>üåç Real-World Applications</h2>
    <div class="use-cases">
      <div class="use-case-card">
        <h3>Enterprise Org Charts</h3>
        <p>
          Manage complex organizational hierarchies with multiple divisions,
          departments, teams, and employees while maintaining type safety at
          every level.
        </p>
        <code
          >company.divisions.tech.departments.engineering.teams.frontend.members[0]</code
        >
      </div>

      <div class="use-case-card">
        <h3>E-Commerce Catalogs</h3>
        <p>
          Navigate deeply nested product categories with full type inference for
          filters, variants, and specifications.
        </p>
        <code
          >catalog.categories.electronics.subcategories.computers.products[0].variants</code
        >
      </div>

      <div class="use-case-card">
        <h3>Configuration Systems</h3>
        <p>
          Handle complex application settings with nested feature flags, user
          preferences, and environment-specific overrides.
        </p>
        <code
          >config.environments.production.features.payments.providers.stripe.settings</code
        >
      </div>
    </div>
  </div>
</div>
