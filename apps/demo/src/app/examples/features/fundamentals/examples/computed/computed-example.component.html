<div class="computed-example">
  <header class="example-header">
    <h1>⚡ Computed Values</h1>
    <p class="description">
      Computed values automatically derive new values from existing signals.
      They update reactively whenever their dependencies change.
    </p>
  </header>

  <section class="concept-section">
    <h2>Basic Computed Values</h2>
    <p>
      Computed values are created using the <code>computed()</code> function and
      automatically track their dependencies.
    </p>

    <div class="demo-grid">
      <div class="demo-card">
        <h3>Counter Computations</h3>
        <div class="counter-display">
          <span class="counter-value">{{ counter() }}</span>
          <span class="counter-label">Counter</span>
        </div>
        <div class="computed-values">
          <div class="computed-item">
            <strong>Double:</strong> {{ doubleCounter() }}
          </div>
          <div class="computed-item">
            <strong>Is Even:</strong>
            <span [class]="isEven() ? 'even' : 'odd'">
              {{ isEven() ? '✅ Even' : '❌ Odd' }}
            </span>
          </div>
          <div class="computed-item">
            <strong>Description:</strong> {{ counterDescription() }}
          </div>
        </div>
        <div class="button-group">
          <button (click)="decrement()" class="btn btn-secondary">-</button>
          <button (click)="increment()" class="btn btn-primary">+</button>
        </div>
      </div>

      <div class="demo-card">
        <h3>Dynamic Multiplier</h3>
        <div class="multiplier-display">
          <span class="multiplier-value">{{ multiplier() }}</span>
          <span class="multiplier-label"
            >× Counter = {{ counter() * multiplier() }}</span
          >
        </div>
        <input
          type="range"
          min="1"
          max="10"
          [ngModel]="multiplier()"
          (ngModelChange)="updateMultiplier($event)"
          class="multiplier-slider"
        />
        <div class="multiplier-labels">
          <span>1</span>
          <span>10</span>
        </div>
      </div>
    </div>
  </section>

  <section class="concept-section">
    <h2>Shopping Cart with Computed Totals</h2>
    <p>
      Real-world example showing computed values for totals, tax, and discounts.
    </p>

    <div class="demo-card">
      <h3>Cart Items</h3>
      <div class="cart-items">
        @for (item of cartItems(); track item.name) {
        <div class="cart-item">
          <span class="item-name">{{ item.name }}</span>
          <span class="item-details"
            >{{ item.quantity }} × ${{ item.price }}</span
          >
          <span class="item-total">${{ item.price * item.quantity }}</span>
        </div>
        }
      </div>

      <div class="cart-summary">
        <div class="summary-row">
          <span>Subtotal:</span>
          <span>${{ subtotal() | number : '1.2-2' }}</span>
        </div>
        <div class="summary-row">
          <span>Tax ({{ taxRate * 100 }}%):</span>
          <span>${{ tax() | number : '1.2-2' }}</span>
        </div>
        @if (discount() > 0) {
        <div class="summary-row">
          <span>Discount:</span>
          <span>-${{ discount() | number : '1.2-2' }}</span>
        </div>
        }
        <div class="summary-row total">
          <span><strong>Total:</strong></span>
          <span
            ><strong>${{ total() | number : '1.2-2' }}</strong></span
          >
        </div>
      </div>

      <div class="add-item-form">
        <input
          [(ngModel)]="newItemName"
          placeholder="Item name"
          class="form-input"
        />
        <input
          type="number"
          [(ngModel)]="newItemPrice"
          placeholder="Price"
          min="0"
          step="0.01"
          class="form-input"
        />
        <input
          type="number"
          [(ngModel)]="newItemQuantity"
          placeholder="Quantity"
          min="1"
          class="form-input"
        />
        <button (click)="addCartItem()" class="btn btn-success">
          Add Item
        </button>
      </div>
    </div>
  </section>

  <section class="concept-section">
    <h2>SignalTree with Computed Values</h2>
    <p>
      Computed values work seamlessly with SignalTree for complex derived state.
    </p>

    <div class="demo-card">
      <h3>User Profile</h3>
      <div class="user-info">
        <p><strong>Full Name:</strong> {{ fullName() }}</p>
        <p><strong>Display Name:</strong> {{ displayName() }}</p>
        <p><strong>Theme:</strong> {{ tree.state.preferences().theme }}</p>
      </div>

      <div class="update-form">
        <input
          [(ngModel)]="userFirstName"
          placeholder="First name"
          class="form-input"
        />
        <input
          [(ngModel)]="userLastName"
          placeholder="Last name"
          class="form-input"
        />
        <button
          (click)="updateUser(userFirstName, userLastName)"
          class="btn btn-primary"
        >
          Update User
        </button>
      </div>
    </div>
  </section>

  <section class="code-section">
    <h2>Code Example</h2>
    <pre><code>// Basic computed values
const counter = signal(5);
const doubleCounter = computed(() => counter() * 2);
const isEven = computed(() => counter() % 2 === 0);

// Computed with multiple dependencies
const total = computed(() => {{ '{' }}
  const subtotal = items().reduce((sum, item) => sum + item.price, 0);
  const tax = subtotal * taxRate();
  const discount = subtotal * (discountPercent() / 100);
  return subtotal + tax - discount;
{{ '}' }});

// SignalTree with computed
const tree = signalTree({{ '{' }}
  user: {{ '{' }} firstName: 'John', lastName: 'Doe' {{ '}' }}
{{ '}' }});

const fullName = computed(() =>
  `${{ '{' }}tree.state.user().firstName{{ '}' }} ${{ '{' }}tree.state.user().lastName{{ '}' }}`
);</code></pre>
  </section>
</div>
