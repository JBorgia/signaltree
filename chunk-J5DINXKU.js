import{a as C}from"./chunk-3XX2APIE.js";var x=1e3,A=5*60*1e3,E=new Map;function I(n,t){if(n===t)return!0;if(n==null||t==null||typeof n!=typeof t)return!1;if(typeof n=="object"&&typeof t=="object"){let i=n,o=t,f=Object.keys(i),h=Object.keys(o);if(f.length!==h.length)return!1;for(let r of f)if(i[r]!==o[r])return!1;return!0}return!1}function z(n,t){if(n===t)return!0;if(n==null||t==null||typeof n!=typeof t)return!1;if(typeof n=="object"){let i=Object.keys(n),o=Object.keys(t);if(i.length!==o.length)return!1;for(let f of i)if(!o.includes(f)||!z(n[f],t[f]))return!1;return!0}return!1}function v(n,t){try{return`${n.name||"anonymous"}_${JSON.stringify(t)}`}catch{return`${n.name||"anonymous"}_${t.length}`}}function R(n){switch(n){case"shallow":return I;case"reference":return(t,i)=>t===i;case"deep":default:return z}}function S(n,t,i={}){let o=new Map,f=i.maxCacheSize??x,h=i.ttl??A,r=R(i.equality??"shallow"),a=i.enableLRU??!1,p=()=>{if(!h)return;let l=Date.now();for(let[c,e]of o.entries())e.timestamp&&l-e.timestamp>h&&o.delete(c)},w=()=>{if(!a||o.size<f)return;let l="",c=1/0;for(let[e,s]of o.entries())s.hitCount<c&&(c=s.hitCount,l=e);l&&o.delete(l)};return(...l)=>{h&&Math.random()<.01&&p();let c=t?t(...l):v(n,l),e=o.get(c);if(e&&(t||r(e.deps,l)))return a&&(e.hitCount+=1),e.value;a&&w();let s=n(...l);return o.set(c,{value:s,deps:l,timestamp:Date.now(),hitCount:1}),s}}function U(n,t){return S(n,t,{equality:"shallow",enableLRU:!1,ttl:void 0,maxCacheSize:100})}function q(n,t){return S(n,t,{equality:"reference",enableLRU:!1,ttl:void 0,maxCacheSize:50})}function M(n={}){let{enabled:t=!0,maxCacheSize:i=1e3,ttl:o,equality:f="deep",enableLRU:h=!0}=n;return r=>{if(!t)return r;let a=new Map;E.set(r,a);let p=R(f),w=()=>{if(!h||a.size<=i)return;let e=Array.from(a.entries());e.sort((u,m)=>(u[1].timestamp||0)-(m[1].timestamp||0)),e.slice(0,a.size-i+1).forEach(([u])=>a.delete(u))},l=r.bind(r);r.memoizedUpdate=(e,s)=>{let u=l(),m=s||v(e,[u]),g=a.get(m);if(g&&p(g.deps,[u])){let k=g.value;Object.entries(k).forEach(([y,d])=>{let T=r.state[y];T&&"set"in T?T.set(d):C(T)&&T(d)});return}let b=e(u);a.set(m,{value:b,deps:[u],timestamp:Date.now(),hitCount:1}),Object.entries(b).forEach(([k,y])=>{let d=r.state[k];d&&"set"in d?d.set(y):C(d)&&d(y)}),w()},r.clearMemoCache=e=>{e?a.delete(e):a.clear()},r.getCacheStats=()=>{let e=0,s=0;for(let m of a.values())e+=m.hitCount||0,s+=Math.floor((m.hitCount||0)/2);let u=e+s>0?e/(e+s):0;return{size:a.size,hitRate:u,totalHits:e,totalMisses:s,keys:Array.from(a.keys())}};let c=r._memoCleanupInterval;if(c&&typeof c=="number"){let e=r.clearMemoCache.bind(r);r.clearMemoCache=s=>{e(s);try{clearInterval(c)}catch{}}}if(o){let s=setInterval(()=>{let u=Date.now();for(let[m,g]of a.entries())g.timestamp&&u-g.timestamp>o&&a.delete(m)},o);r._memoCleanupInterval=s}return r}}function _(){return M({enabled:!0,maxCacheSize:100,ttl:void 0,equality:"reference",enableLRU:!1})}function H(){return M({enabled:!0,maxCacheSize:1e3,ttl:6e4,equality:"shallow",enableLRU:!0})}export{U as a,q as b,M as c,_ as d,H as e};
