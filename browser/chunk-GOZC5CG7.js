import{w as T}from"./chunk-AQ5ZLTRX.js";import{f as I,g as L,h as x,i as V,j as F,u as R}from"./chunk-3DDI6FWM.js";import{$b as k,Ab as l,Ac as D,Cb as p,Ec as z,Hc as U,Ja as a,Jb as m,Lb as e,Mb as c,Nb as f,Ya as E,ac as O,bc as S,ha as _,hc as M,ia as C,ib as g,jb as u,mb as y,nb as w,ob as b,pb as n,qb as t,rb as $,yb as P}from"./chunk-YYEXL5C7.js";import{j as v}from"./chunk-A3ECCK3J.js";var N=(s,i,o)=>({state:s,isReady:i,userCount:o}),B=(s,i,o)=>({"demo-theme":s,"demo-fontSize":i,"demo-lastViewedUserId":o}),j=(s,i)=>i.id;function W(s,i){s&1&&($(0,"span",29),e(1," Loading... "))}function J(s,i){s&1&&e(0," Load Users ")}function q(s,i){if(s&1){let o=P();n(0,"div",14)(1,"strong"),e(2,"Error:"),t(),e(3),n(4,"button",30),l("click",function(){_(o);let d=p();return C(d.loadUsers())}),e(5,"Retry"),t()()}if(s&2){let o,r=p();a(3),f(" ",(o=r.store.$.users.status.error())==null?null:o.message," ")}}function H(s,i){if(s&1){let o=P();n(0,"li",32),l("click",function(){let d=_(o).$implicit,h=p(2);return C(h.selectUser(d.id))})("keydown.enter",function(){let d=_(o).$implicit,h=p(2);return C(h.selectUser(d.id))}),n(1,"span",33),e(2),t(),n(3,"span",34),e(4),t()()}if(s&2){let o=i.$implicit,r=p(2);m("selected",r.store.$.lastViewedUserId()===o.id),a(2),c(o.name),a(2),c(o.email)}}function G(s,i){if(s&1&&(n(0,"div",15)(1,"h4"),e(2),t(),n(3,"ul"),y(4,H,5,4,"li",31,j),t()()),s&2){let o=p();a(2),f("Users (",o.store.$.users.entities.all().length,")"),a(2),w(o.store.$.users.entities.all())}}function K(s,i){s&1&&e(0),s&2&&f(" ",i.name," ")}function Q(s,i){s&1&&e(0," None selected ")}var A=class s{LoadingState=I;store=V({users:{entities:F({selectId:i=>i.id}),status:L()},theme:x("demo-theme","light"),fontSize:x("demo-fontSize",14),lastViewedUserId:x("demo-lastViewedUserId",null)}).with(R()).derived(i=>({isReady:M(()=>i.users.status.isLoaded()&&i.users.entities.all().length>0),selectedUser:M(()=>{let o=i.lastViewedUserId();return o!=null?i.users.entities.byId(o)?.()??null:null}),themeStyles:M(()=>({background:i.theme()==="dark"?"#1e1e1e":"#ffffff",color:i.theme()==="dark"?"#ffffff":"#1e1e1e",fontSize:`${i.fontSize()}px`}))}));loadUsers(){return v(this,null,function*(){if(this.store.$.users.status.setLoading(),yield new Promise(r=>setTimeout(r,1500)),Math.random()<.2){this.store.$.users.status.setError(new Error("Network error"));return}let o=[{id:1,name:"Alice Johnson",email:"alice@example.com"},{id:2,name:"Bob Smith",email:"bob@example.com"},{id:3,name:"Carol Davis",email:"carol@example.com"},{id:4,name:"David Wilson",email:"david@example.com"}];this.store.$.users.entities.setAll(o),this.store.$.users.status.setLoaded()})}resetUsers(){this.store.$.users.entities.removeAll(),this.store.$.users.status.reset()}selectUser(i){this.store.$.lastViewedUserId.set(i)}toggleTheme(){let i=this.store.$.theme();this.store.$.theme.set(i==="light"?"dark":"light")}increaseFontSize(){this.store.$.fontSize.update(i=>Math.min(i+2,24))}decreaseFontSize(){this.store.$.fontSize.update(i=>Math.max(i-2,10))}clearPreferences(){this.store.$.theme.clear(),this.store.$.fontSize.clear(),this.store.$.lastViewedUserId.clear()}statusExample=`// status() marker - async operation state
const tree = signalTree({
  users: {
    entities: entityMap<User>(),
    status: status(),  // Async state tracking
  },
});

// Derived boolean signals (lazy-created)
tree.$.users.status.isNotLoaded();  // true initially
tree.$.users.status.isLoading();    // false
tree.$.users.status.isLoaded();     // false
tree.$.users.status.isError();      // false

// Helper methods
tree.$.users.status.setLoading();   // Start loading
tree.$.users.status.setLoaded();    // Mark complete
tree.$.users.status.setError(err);  // Set error
tree.$.users.status.reset();        // Back to NotLoaded`;storedExample=`// stored() marker - localStorage persistence
const tree = signalTree({
  theme: stored('app-theme', 'light'),
  fontSize: stored('app-fontSize', 14),
  lastViewed: stored('last-viewed', null),
});

// Auto-loads from localStorage on init
tree.$.theme();  // 'light' or restored value

// Auto-saves on change (debounced 100ms default)
tree.$.theme.set('dark');  // Immediate signal update

// Methods
tree.$.theme.clear();   // Reset to default
tree.$.theme.reload();  // Force reload from storage

// Custom debounce
stored('key', value, { debounceMs: 0 });  // Immediate`;combinedExample=`// Combining markers with derived state
const tree = signalTree({
  users: {
    entities: entityMap<User>(),
    status: status(),
  },
  lastViewedUserId: stored('lastViewed', null),
})
.with(entities())
.derived(($) => ({
  isReady: computed(() => 
    $.users.status.isLoaded() && 
    $.users.entities.all().length > 0
  ),
  selectedUser: computed(() => {
    const id = $.lastViewedUserId();
    return id != null 
      ? $.users.entities.byId(id)?.() 
      : null;
  }),
}));`;static \u0275fac=function(o){return new(o||s)};static \u0275cmp=E({type:s,selectors:[["app-markers-demo"]],decls:147,vars:37,consts:[[1,"markers-demo"],[1,"demo-header"],[1,"subtitle"],[1,"demo-section"],[1,"section-desc"],[1,"demo-card"],[1,"card-header"],[1,"status-indicators"],[1,"status-badge"],[1,"status-badge","error"],[1,"card-content"],[1,"button-group"],[1,"btn","primary",3,"click","disabled"],[1,"btn","secondary",3,"click","disabled"],[1,"error-message"],[1,"users-list"],[1,"state-display"],[1,"code-example"],[1,"demo-card",3,"ngStyle"],[1,"persistence-badge"],[1,"preference-controls"],[1,"control-group"],[1,"control-label"],[1,"btn",3,"click"],[1,"value"],[1,"btn","danger",3,"click"],[1,"storage-display"],[1,"performance-grid"],[1,"perf-card"],[1,"spinner"],[1,"btn","small",3,"click"],["tabindex","0",3,"selected"],["tabindex","0",3,"click","keydown.enter"],[1,"user-name"],[1,"user-email"]],template:function(o,r){if(o&1&&(n(0,"div",0)(1,"div",1)(2,"h1"),e(3,"Markers Demo"),t(),n(4,"p",2),e(5," v7.0 introduces "),n(6,"code"),e(7,"status()"),t(),e(8," and "),n(9,"code"),e(10,"stored()"),t(),e(11," markers for async state tracking and localStorage persistence. "),t()(),n(12,"section",3)(13,"h2"),e(14,"status() Marker - Async Operation State"),t(),n(15,"p",4),e(16," Track loading states for async operations with automatic derived signals and helper methods. "),t(),n(17,"div",5)(18,"div",6)(19,"h3"),e(20,"User Loading Demo"),t(),n(21,"div",7)(22,"span",8),e(23," NotLoaded "),t(),n(24,"span",8),e(25," Loading "),t(),n(26,"span",8),e(27," Loaded "),t(),n(28,"span",9),e(29," Error "),t()()(),n(30,"div",10)(31,"div",11)(32,"button",12),l("click",function(){return r.loadUsers()}),g(33,W,2,0)(34,J,1,0),t(),n(35,"button",13),l("click",function(){return r.resetUsers()}),e(36," Reset "),t()(),g(37,q,6,1,"div",14),g(38,G,6,1,"div",15),n(39,"div",16)(40,"h4"),e(41,"Current State"),t(),n(42,"pre"),e(43),O(44,"json"),t()()()(),n(45,"div",17)(46,"h4"),e(47,"Code Example"),t(),n(48,"pre")(49,"code"),e(50),t()()()(),n(51,"section",3)(52,"h2"),e(53,"stored() Marker - localStorage Persistence"),t(),n(54,"p",4),e(55," Auto-sync signals to localStorage with debounced writes. Changes persist across page reloads. "),t(),n(56,"div",18)(57,"div",6)(58,"h3"),e(59,"Preferences Demo"),t(),n(60,"span",19),e(61," \u{1F4E6} Persisted to localStorage "),t()(),n(62,"div",10)(63,"div",20)(64,"div",21)(65,"span",22),e(66,"Theme"),t(),n(67,"div",11)(68,"button",23),l("click",function(){return r.store.$.theme.set("light")}),e(69," \u2600\uFE0F Light "),t(),n(70,"button",23),l("click",function(){return r.store.$.theme.set("dark")}),e(71," \u{1F319} Dark "),t()()(),n(72,"div",21)(73,"span",22),e(74),t(),n(75,"div",11)(76,"button",23),l("click",function(){return r.decreaseFontSize()}),e(77,"A-"),t(),n(78,"button",23),l("click",function(){return r.increaseFontSize()}),e(79,"A+"),t()()(),n(80,"div",21)(81,"span",22),e(82,"Last Viewed User"),t(),n(83,"span",24),g(84,K,1,1)(85,Q,1,0),t()()(),n(86,"div",11)(87,"button",25),l("click",function(){return r.clearPreferences()}),e(88," Clear All Preferences "),t()(),n(89,"div",26)(90,"h4"),e(91,"localStorage Values"),t(),n(92,"pre"),e(93),O(94,"json"),t()()()(),n(95,"div",17)(96,"h4"),e(97,"Code Example"),t(),n(98,"pre")(99,"code"),e(100),t()()()(),n(101,"section",3)(102,"h2"),e(103,"Combining Markers with Derived State"),t(),n(104,"p",4),e(105," Use markers together with "),n(106,"code"),e(107,".derived()"),t(),e(108," for powerful patterns. "),t(),n(109,"div",17)(110,"h4"),e(111,"Code Example"),t(),n(112,"pre")(113,"code"),e(114),t()()()(),n(115,"section",3)(116,"h2"),e(117,"Performance Optimizations"),t(),n(118,"div",27)(119,"div",28)(120,"h3"),e(121,"status()"),t(),n(122,"ul")(123,"li")(124,"strong"),e(125,"Lazy Computed:"),t(),e(126," Derived signals (isLoading, etc.) only created on first access "),t(),n(127,"li")(128,"strong"),e(129,"Performance Budget:"),t(),e(130," 100 markers initialize in <50ms "),t()()(),n(131,"div",28)(132,"h3"),e(133,"stored()"),t(),n(134,"ul")(135,"li")(136,"strong"),e(137,"Debounced Writes:"),t(),e(138," Default 100ms debounce prevents localStorage hammering "),t(),n(139,"li")(140,"strong"),e(141,"Non-blocking:"),t(),e(142," Writes use queueMicrotask() for responsive UI "),t(),n(143,"li")(144,"strong"),e(145,"Coalesced Updates:"),t(),e(146," Rapid updates result in single storage write "),t()()()()()()),o&2){let d;a(22),m("active",r.store.$.users.status.isNotLoaded()),a(2),m("active",r.store.$.users.status.isLoading()),a(2),m("active",r.store.$.users.status.isLoaded()),a(2),m("active",r.store.$.users.status.isError()),a(4),b("disabled",r.store.$.users.status.isLoading()),a(),u(r.store.$.users.status.isLoading()?33:34),a(2),b("disabled",r.store.$.users.status.isNotLoaded()),a(2),u(r.store.$.users.status.isError()?37:-1),a(),u(r.store.$.users.status.isLoaded()?38:-1),a(5),c(S(44,25,k(29,N,r.store.$.users.status.state(),r.store.$.isReady(),r.store.$.users.entities.all().length))),a(7),c(r.statusExample),a(6),b("ngStyle",r.store.$.themeStyles()),a(12),m("active",r.store.$.theme()==="light"),a(2),m("active",r.store.$.theme()==="dark"),a(4),f("Font Size: ",r.store.$.fontSize(),"px"),a(10),u((d=r.store.$.selectedUser())?84:85,d),a(9),c(S(94,27,k(33,B,r.store.$.theme(),r.store.$.fontSize(),r.store.$.lastViewedUserId()))),a(7),c(r.storedExample),a(14),c(r.combinedExample)}},dependencies:[U,D,T,z],styles:[".markers-demo[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:2rem}.demo-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:3rem}.demo-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5rem;margin-bottom:.5rem}.demo-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:#666;font-size:1.1rem}.demo-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background:#f0f0f0;padding:.2rem .5rem;border-radius:4px;font-weight:600}.demo-section[_ngcontent-%COMP%]{margin-bottom:3rem}.demo-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.75rem;margin-bottom:.5rem;border-bottom:2px solid #007bff;padding-bottom:.5rem}.demo-section[_ngcontent-%COMP%]   .section-desc[_ngcontent-%COMP%]{color:#666;margin-bottom:1.5rem}.demo-section[_ngcontent-%COMP%]   .section-desc[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background:#f0f0f0;padding:.15rem .4rem;border-radius:3px}.demo-card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 2px 8px #0000001a;margin-bottom:1.5rem;overflow:hidden;transition:background .3s,color .3s}.demo-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{background:#f8f9fa;padding:1rem 1.5rem;border-bottom:1px solid #e9ecef;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem}.demo-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.25rem}.demo-card[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{padding:1.5rem}.status-indicators[_ngcontent-%COMP%]{display:flex;gap:.5rem;flex-wrap:wrap}.status-badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:20px;font-size:.85rem;background:#e9ecef;color:#6c757d;transition:all .2s}.status-badge.active[_ngcontent-%COMP%]{background:#007bff;color:#fff}.status-badge.error.active[_ngcontent-%COMP%]{background:#dc3545}.persistence-badge[_ngcontent-%COMP%]{background:#28a745;color:#fff;padding:.25rem .75rem;border-radius:20px;font-size:.85rem}.button-group[_ngcontent-%COMP%]{display:flex;gap:.5rem;flex-wrap:wrap;margin-bottom:1rem}.btn[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;border-radius:4px;cursor:pointer;font-size:.9rem;transition:all .2s;display:inline-flex;align-items:center;gap:.5rem}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn.primary[_ngcontent-%COMP%]{background:#007bff;color:#fff}.btn.primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#0056b3}.btn.secondary[_ngcontent-%COMP%]{background:#6c757d;color:#fff}.btn.secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#545b62}.btn.danger[_ngcontent-%COMP%]{background:#dc3545;color:#fff}.btn.danger[_ngcontent-%COMP%]:hover:not(:disabled){background:#c82333}.btn.small[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.8rem}.btn.active[_ngcontent-%COMP%]{background:#007bff;color:#fff}.spinner[_ngcontent-%COMP%]{width:14px;height:14px;border:2px solid transparent;border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.error-message[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24;padding:1rem;border-radius:4px;margin-bottom:1rem;display:flex;align-items:center;gap:1rem;flex-wrap:wrap}.error-message[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{margin-right:.5rem}.users-list[_ngcontent-%COMP%]{margin-bottom:1rem}.users-list[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:.5rem}.users-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;border:1px solid #e9ecef;border-radius:4px;overflow:hidden}.users-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:.75rem 1rem;border-bottom:1px solid #e9ecef;display:flex;justify-content:space-between;cursor:pointer;transition:background .2s}.users-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{border-bottom:none}.users-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background:#f8f9fa}.users-list[_ngcontent-%COMP%]   li.selected[_ngcontent-%COMP%]{background:#e7f1ff;border-left:3px solid #007bff}.users-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .user-name[_ngcontent-%COMP%]{font-weight:500}.users-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .user-email[_ngcontent-%COMP%]{color:#6c757d;font-size:.9rem}.state-display[_ngcontent-%COMP%], .storage-display[_ngcontent-%COMP%]{background:#f8f9fa;border-radius:4px;padding:1rem;margin-top:1rem}.state-display[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .storage-display[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:.9rem;color:#6c757d}.state-display[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%], .storage-display[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{margin:0;font-size:.85rem;white-space:pre-wrap}.preference-controls[_ngcontent-%COMP%]{display:grid;gap:1.5rem;margin-bottom:1.5rem}.preference-controls[_ngcontent-%COMP%]   .control-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:500;margin-bottom:.5rem}.preference-controls[_ngcontent-%COMP%]   .control-group[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#666}.code-example[_ngcontent-%COMP%]{background:#282c34;border-radius:8px;padding:1.5rem;margin-top:1rem}.code-example[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#9cdcfe;margin:0 0 1rem;font-size:.9rem}.code-example[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{margin:0;overflow-x:auto}.code-example[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{color:#abb2bf;font-size:.85rem;line-height:1.6}.performance-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:1.5rem}.perf-card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 2px 8px #0000001a;padding:1.5rem}.perf-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1rem;color:#007bff;font-family:monospace;font-size:1.25rem}.perf-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0;padding-left:1.25rem}.perf-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:.5rem;line-height:1.5}.perf-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#28a745}@media (max-width: 768px){.markers-demo[_ngcontent-%COMP%]{padding:1rem}.demo-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.75rem}.card-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}}"]})};export{A as MarkersDemoComponent};
