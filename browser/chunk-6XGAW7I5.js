import{i as I,v as T}from"./chunk-3DDI6FWM.js";import{Bb as d,Cb as p,Hc as k,Ja as r,Jb as v,Lb as n,Mb as c,Nb as E,Ob as z,Ya as P,ha as u,hc as h,ia as g,ib as b,jb as _,lb as D,mb as x,nb as M,sa as f,sb as e,tb as t,yb as C,zb as S}from"./chunk-YYEXL5C7.js";import{a as y,b as O}from"./chunk-A3ECCK3J.js";var A=(s,i)=>i.id;function N(s,i){if(s&1&&(e(0,"span",42),n(1),t()),s&2){let o=i.$implicit;r(),c(o)}}function J(s,i){if(s&1){let o=C();e(0,"div",20)(1,"div",38)(2,"span",39),n(3),t(),e(4,"span",40),n(5),t()(),e(6,"div",41),x(7,N,2,1,"span",42,D),t(),e(9,"div",43)(10,"button",15),d("click",function(){let m=u(o).$implicit,l=p();return g(l.addTagToItem(m.id,"extra"))}),n(11," + Tag "),t(),e(12,"button",44),d("click",function(){let m=u(o).$implicit,l=p();return g(l.removeItem(m.id))}),n(13," Remove "),t()()()}if(s&2){let o=i.$implicit;r(3),c(o.name),r(2),c(o.value),r(2),M(o.tags)}}function L(s,i){if(s&1){let o=C();e(0,"button",15),d("click",function(){u(o);let m=p();return g(m.copyToClipboard())}),n(1," \u{1F4CB} Copy "),t()}}function $(s,i){if(s&1){let o=C();e(0,"button",45),d("click",function(){u(o);let m=p();return g(m.useOutputAsInput())}),n(1," \u2B07\uFE0F Use as Import "),t()}}function j(s,i){if(s&1&&(e(0,"div",34)(1,"span",46),n(2,"Last Action:"),t(),e(3,"span",47),n(4),t()()),s&2){let o=p();r(4),c(o.lastAction())}}function V(s,i){if(s&1&&(e(0,"div",36)(1,"div",48)(2,"span",49),n(3,"createdAt:"),t(),e(4,"span",50),n(5),t()(),e(6,"div",48)(7,"span",49),n(8,"lastModified:"),t(),e(9,"span",50),n(10),t()(),e(11,"div",48)(12,"span",49),n(13,"tags:"),t(),e(14,"span",50),n(15),t()(),e(16,"div",48)(17,"span",49),n(18,"items:"),t(),e(19,"span",50),n(20),t()()()),s&2){let o=p();r(5),c(o.typeInfo().createdAtType),r(5),c(o.typeInfo().lastModifiedType),r(5),c(o.typeInfo().tagsType),r(5),c(o.typeInfo().itemsIsArray)}}var w=class s{store;constructor(){let i=I({user:{name:"John Doe",email:"john@example.com",createdAt:new Date},preferences:{theme:"dark",language:"en",notifications:!0},items:[{id:1,name:"Item One",value:100,tags:["important","urgent"]},{id:2,name:"Item Two",value:250,tags:["archived"]}],metadata:{version:1,lastModified:new Date}});this.store=i.with(T({preserveTypes:!0,includeMetadata:!0}))}serializedOutput=f("");importInput=f("");lastAction=f("");showTypePreservation=f(!1);get userName(){return this.store.$.user.name}get userEmail(){return this.store.$.user.email}createdAt=h(()=>{let i=this.store.$.user.createdAt();return i instanceof Date?i.toLocaleString():String(i)});get theme(){return this.store.$.preferences.theme}get language(){return this.store.$.preferences.language}get notifications(){return this.store.$.preferences.notifications}get items(){return this.store.$.items}itemsCount=h(()=>this.store.$.items().length);get metadataVersion(){return this.store.$.metadata.version}lastModified=h(()=>{let i=this.store.$.metadata.lastModified();return i instanceof Date?i.toLocaleString():String(i)});typeInfo=h(()=>{let i=this.store(),o=i.items,a=o[0];return{createdAtType:i.user.createdAt instanceof Date?"Date \u2713":typeof i.user.createdAt,lastModifiedType:i.metadata.lastModified instanceof Date?"Date \u2713":typeof i.metadata.lastModified,tagsType:Array.isArray(a?.tags)?"Array \u2713":typeof a?.tags,itemsIsArray:Array.isArray(o)?"Array \u2713":typeof o}});serializeToJSON(){let i=this.store.serialize();this.serializedOutput.set(i),this.lastAction.set("Serialized state to JSON with type markers")}serializeSimple(){let i=this.store.toJSON();this.serializedOutput.set(JSON.stringify(i,null,2)),this.lastAction.set("Converted to plain JSON (no type preservation)")}deserializeFromJSON(){let i=this.importInput();if(!i.trim()){this.lastAction.set("Error: No JSON to import");return}try{this.store.deserialize(i),this.lastAction.set("Deserialized JSON back into store"),this.updateMetadata()}catch(o){this.lastAction.set(`Error: ${o instanceof Error?o.message:"Invalid JSON"}`)}}loadSampleJSON(){let i={data:{user:{name:"Jane Smith",email:"jane@example.com",createdAt:{__date__:new Date(2024,0,15).toISOString()}},preferences:{theme:"light",language:"fr",notifications:!1},items:[{id:10,name:"Imported Item",value:500,tags:["new","featured"]}],metadata:{version:2,lastModified:{__date__:new Date().toISOString()}}},metadata:{timestamp:Date.now(),version:"1.0.0"}};this.importInput.set(JSON.stringify(i,null,2)),this.lastAction.set("Loaded sample JSON with type markers")}copyToClipboard(){let i=this.serializedOutput();i&&(navigator.clipboard.writeText(i),this.lastAction.set("Copied to clipboard"))}useOutputAsInput(){let i=this.serializedOutput();i&&(this.importInput.set(i),this.lastAction.set("Copied serialized output to import field"))}updateUserName(i){let o=i.target;this.userName.set(o.value),this.updateMetadata()}updateUserEmail(i){let o=i.target;this.userEmail.set(o.value),this.updateMetadata()}setTheme(i){this.theme.set(i),this.updateMetadata()}toggleNotifications(){this.notifications.set(!this.notifications()),this.updateMetadata()}addItem(){let i=this.items(),o=Math.max(0,...i.map(a=>a.id))+1;this.items.set([...i,{id:o,name:`Item ${o}`,value:Math.floor(Math.random()*1e3),tags:["new"]}]),this.updateMetadata()}removeItem(i){this.items.set(this.items().filter(o=>o.id!==i)),this.updateMetadata()}addTagToItem(i,o){let m=this.items().map(l=>l.id===i?O(y({},l),{tags:[...l.tags,o]}):l);this.items.set(m),this.updateMetadata()}updateMetadata(){this.store.$.metadata.lastModified.set(new Date),this.store.$.metadata.version.set(this.metadataVersion()+1)}resetToDefaults(){this.store.$.user.name.set("John Doe"),this.store.$.user.email.set("john@example.com"),this.store.$.user.createdAt.set(new Date),this.store.$.preferences.theme.set("dark"),this.store.$.preferences.language.set("en"),this.store.$.preferences.notifications.set(!0),this.store.$.items.set([{id:1,name:"Item One",value:100,tags:["important","urgent"]},{id:2,name:"Item Two",value:250,tags:["archived"]}]),this.store.$.metadata.version.set(1),this.store.$.metadata.lastModified.set(new Date),this.lastAction.set("Reset to default values"),this.serializedOutput.set(""),this.importInput.set("")}updateImportInput(i){let o=i.target;this.importInput.set(o.value)}toggleTypePreservation(){this.showTypePreservation.set(!this.showTypePreservation())}static \u0275fac=function(o){return new(o||s)};static \u0275cmp=P({type:s,selectors:[["app-serialization-demo"]],decls:112,vars:24,consts:[[1,"demo-container"],[1,"demo-title"],[1,"intro"],[1,"content-grid"],[1,"panel","state-panel"],[1,"section"],[1,"form-group"],["for","user-name-input"],["id","user-name-input","type","text",1,"input-field",3,"input","value"],["for","user-email-input"],["id","user-email-input","type","email",1,"input-field",3,"input","value"],[1,"info-row"],[1,"label"],[1,"value"],[1,"button-group","theme-buttons"],[1,"btn","btn-sm",3,"click"],[1,"toggle-row"],["for","notifications-toggle-btn"],["id","notifications-toggle-btn",1,"toggle-btn",3,"click"],[1,"items-list"],[1,"item-card"],[1,"btn","btn-sm","btn-primary",2,"margin-top","0.5rem",3,"click"],[1,"panel","serialization-panel"],[1,"action-buttons"],[1,"btn","btn-primary",3,"click"],[1,"btn",3,"click"],[1,"output-section"],[1,"btn","btn-sm"],[1,"json-output"],[1,"btn","btn-sm",2,"margin-top","0.5rem"],[1,"import-section"],["placeholder","Paste JSON here to import...",1,"json-input",3,"input","value"],[1,"import-actions"],[1,"btn","btn-success",3,"click"],[1,"status-bar"],[1,"type-info"],[1,"type-grid"],[1,"code-section"],[1,"item-header"],[1,"item-name"],[1,"item-value"],[1,"item-tags"],[1,"tag"],[1,"item-actions"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"btn","btn-sm",2,"margin-top","0.5rem",3,"click"],[1,"status-label"],[1,"status-value"],[1,"type-item"],[1,"type-label"],[1,"type-value"]],template:function(o,a){o&1&&(e(0,"div",0)(1,"h2",1),n(2,"\u{1F4E6} Serialization Demo"),t(),e(3,"div",2)(4,"p")(5,"strong"),n(6,"serialization"),t(),n(7," enables JSON import/export with automatic handling of special JavaScript types like "),e(8,"code"),n(9,"Date"),t(),n(10,", "),e(11,"code"),n(12,"Set"),t(),n(13,", "),e(14,"code"),n(15,"Map"),t(),n(16,", and more. "),t()(),e(17,"div",3)(18,"div",4)(19,"h3"),n(20,"\u{1F4DD} Current State"),t(),e(21,"div",5)(22,"h4"),n(23,"User"),t(),e(24,"div",6)(25,"label",7),n(26,"Name:"),t(),e(27,"input",8),d("input",function(l){return a.updateUserName(l)}),t()(),e(28,"div",6)(29,"label",9),n(30,"Email:"),t(),e(31,"input",10),d("input",function(l){return a.updateUserEmail(l)}),t()(),e(32,"div",11)(33,"span",12),n(34,"Created:"),t(),e(35,"span",13),n(36),t()()(),e(37,"div",5)(38,"h4"),n(39,"Preferences"),t(),e(40,"div",14)(41,"button",15),d("click",function(){return a.setTheme("light")}),n(42," \u2600\uFE0F Light "),t(),e(43,"button",15),d("click",function(){return a.setTheme("dark")}),n(44," \u{1F319} Dark "),t(),e(45,"button",15),d("click",function(){return a.setTheme("auto")}),n(46," \u{1F504} Auto "),t()(),e(47,"div",16)(48,"label",17),n(49,"Notifications:"),t(),e(50,"button",18),d("click",function(){return a.toggleNotifications()}),n(51),t()()(),e(52,"div",5)(53,"h4"),n(54),t(),e(55,"div",19),x(56,J,14,2,"div",20,A),t(),e(58,"button",21),d("click",function(){return a.addItem()}),n(59," + Add Item "),t()(),e(60,"div",5)(61,"h4"),n(62,"Metadata"),t(),e(63,"div",11)(64,"span",12),n(65,"Version:"),t(),e(66,"span",13),n(67),t()(),e(68,"div",11)(69,"span",12),n(70,"Last Modified:"),t(),e(71,"span",13),n(72),t()()(),e(73,"button",15),d("click",function(){return a.resetToDefaults()}),n(74," \u{1F504} Reset to Defaults "),t()(),e(75,"div",22)(76,"h3"),n(77,"\u{1F4BE} Serialization"),t(),e(78,"div",23)(79,"button",24),d("click",function(){return a.serializeToJSON()}),n(80," \u{1F4E4} Serialize (with types) "),t(),e(81,"button",25),d("click",function(){return a.serializeSimple()}),n(82,"\u{1F4E4} Simple JSON"),t()(),e(83,"div",26)(84,"h4"),n(85," Output "),b(86,L,2,0,"button",27),t(),e(87,"div",28),n(88),t(),b(89,$,2,0,"button",29),t(),e(90,"div",30)(91,"h4"),n(92,"Import JSON"),t(),e(93,"textarea",31),d("input",function(l){return a.updateImportInput(l)}),t(),e(94,"div",32)(95,"button",33),d("click",function(){return a.deserializeFromJSON()}),n(96," \u{1F4E5} Import "),t(),e(97,"button",25),d("click",function(){return a.loadSampleJSON()}),n(98,"\u{1F4C4} Load Sample"),t()()(),b(99,j,5,1,"div",34),e(100,"div",35)(101,"h4"),n(102," Type Preservation "),e(103,"button",15),d("click",function(){return a.toggleTypePreservation()}),n(104),t()(),b(105,V,21,4,"div",36),t()(),e(106,"div",37)(107,"h3"),n(108,"\u{1F4BB} Using serialization"),t(),e(109,"pre")(110,"code"),n(111),t()()()()()),o&2&&(r(27),S("value",a.userName()),r(4),S("value",a.userEmail()),r(5),c(a.createdAt()),r(5),v("active",a.theme()==="light"),r(2),v("active",a.theme()==="dark"),r(2),v("active",a.theme()==="auto"),r(5),v("on",a.notifications()),r(),E(" ",a.notifications()?"\u2713 On":"\u2717 Off"," "),r(3),E("Items (",a.itemsCount(),")"),r(2),M(a.items()),r(11),c(a.metadataVersion()),r(5),c(a.lastModified()),r(14),_(a.serializedOutput()?86:-1),r(2),E(" ",a.serializedOutput()||"Click serialize to see output..."," "),r(),_(a.serializedOutput()?89:-1),r(4),S("value",a.importInput()),r(6),_(a.lastAction()?99:-1),r(5),E(" ",a.showTypePreservation()?"Hide":"Show"," "),r(),_(a.showTypePreservation()?105:-1),r(6),z(`// Create store with serialization enhancer
store = signalTree<AppState>(initialState)
  .with(serialization(`,"{",`
    preserveTypes: true,  // Preserve Date, Set, Map types
    includeMetadata: true // Include timestamp in output
  `,"}",`));

// Export state to JSON
const json = store.serialize();

// Import state from JSON
store.deserialize(json);

// Get plain object (no type markers)
const obj = store.toJSON();`))},dependencies:[k],styles:[".demo-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:1rem}.demo-title[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:1rem;color:var(--text-primary, #333)}.intro[_ngcontent-%COMP%]{background:var(--bg-secondary, #f5f5f5);padding:1rem;border-radius:8px;margin-bottom:1.5rem}.intro[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;line-height:1.6}.intro[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background:var(--bg-tertiary, #e0e0e0);padding:.125rem .375rem;border-radius:4px;font-family:monospace}.content-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1.5rem}@media (max-width: 900px){.content-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.panel[_ngcontent-%COMP%]{background:var(--bg-card, #fff);border:1px solid var(--border-color, #ddd);border-radius:8px;padding:1rem}.panel[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1rem;font-size:1.125rem;color:var(--text-primary, #333)}.panel[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:.75rem 0 .5rem;font-size:.875rem;color:var(--text-secondary, #666);text-transform:uppercase;letter-spacing:.5px}.section[_ngcontent-%COMP%]{margin-bottom:1rem;padding-bottom:1rem;border-bottom:1px solid var(--border-light, #eee)}.section[_ngcontent-%COMP%]:last-child{border-bottom:none;margin-bottom:0;padding-bottom:0}.form-group[_ngcontent-%COMP%]{margin-bottom:.75rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:.75rem;color:var(--text-secondary, #666);margin-bottom:.25rem}.input-field[_ngcontent-%COMP%]{width:100%;padding:.5rem;border:1px solid var(--border-color, #ddd);border-radius:4px;font-size:.875rem;box-sizing:border-box}.input-field[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-color, #007bff);box-shadow:0 0 0 2px #007bff1a}.info-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:.875rem;padding:.25rem 0}.info-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:var(--text-secondary, #666)}.info-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--text-primary, #333);font-weight:500}.button-group[_ngcontent-%COMP%]{display:flex;gap:.5rem;flex-wrap:wrap}.theme-buttons[_ngcontent-%COMP%]{margin-bottom:.75rem}.btn[_ngcontent-%COMP%]{padding:.5rem 1rem;border:1px solid var(--border-color, #ddd);border-radius:4px;background:var(--bg-secondary, #f5f5f5);color:var(--text-primary, #333);cursor:pointer;font-size:.875rem;transition:all .2s}.btn[_ngcontent-%COMP%]:hover{background:var(--bg-tertiary, #e0e0e0)}.btn.active[_ngcontent-%COMP%]{background:var(--primary-color, #007bff);border-color:var(--primary-color, #007bff);color:#fff}.btn.btn-sm[_ngcontent-%COMP%]{padding:.375rem .75rem;font-size:.75rem}.btn.btn-primary[_ngcontent-%COMP%]{background:var(--primary-color, #007bff);border-color:var(--primary-color, #007bff);color:#fff}.btn.btn-primary[_ngcontent-%COMP%]:hover{background:var(--primary-hover, #0056b3)}.btn.btn-success[_ngcontent-%COMP%]{background:var(--success-color, #28a745);border-color:var(--success-color, #28a745);color:#fff}.btn.btn-success[_ngcontent-%COMP%]:hover{background:var(--success-hover, #1e7e34)}.btn.btn-danger[_ngcontent-%COMP%]{background:var(--danger-color, #dc3545);border-color:var(--danger-color, #dc3545);color:#fff}.btn.btn-danger[_ngcontent-%COMP%]:hover{background:var(--danger-hover, #c82333)}.toggle-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;font-size:.875rem}.toggle-btn[_ngcontent-%COMP%]{padding:.375rem .75rem;border:1px solid var(--border-color, #ddd);border-radius:4px;background:var(--bg-secondary, #f5f5f5);cursor:pointer;font-size:.75rem}.toggle-btn.on[_ngcontent-%COMP%]{background:var(--success-color, #28a745);border-color:var(--success-color, #28a745);color:#fff}.items-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.item-card[_ngcontent-%COMP%]{background:var(--bg-secondary, #f5f5f5);border-radius:4px;padding:.75rem}.item-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:.5rem}.item-header[_ngcontent-%COMP%]   .item-name[_ngcontent-%COMP%]{font-weight:500}.item-header[_ngcontent-%COMP%]   .item-value[_ngcontent-%COMP%]{color:var(--primary-color, #007bff);font-weight:600}.item-tags[_ngcontent-%COMP%]{display:flex;gap:.25rem;flex-wrap:wrap;margin-bottom:.5rem}.tag[_ngcontent-%COMP%]{background:var(--bg-tertiary, #e0e0e0);padding:.125rem .5rem;border-radius:12px;font-size:.75rem;color:var(--text-secondary, #666)}.item-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.serialization-panel[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.action-buttons[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:1rem}.output-section[_ngcontent-%COMP%], .import-section[_ngcontent-%COMP%]{margin-bottom:1rem}.output-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .import-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.json-output[_ngcontent-%COMP%], .json-input[_ngcontent-%COMP%]{width:100%;min-height:200px;padding:.75rem;border:1px solid var(--border-color, #ddd);border-radius:4px;font-family:Monaco,Menlo,Ubuntu Mono,monospace;font-size:.75rem;line-height:1.4;resize:vertical;box-sizing:border-box;background:var(--bg-code, #f8f9fa)}.json-output[_ngcontent-%COMP%]{background:var(--bg-code, #f8f9fa);white-space:pre-wrap;word-break:break-all;overflow-y:auto;max-height:300px}.import-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-top:.5rem}.status-bar[_ngcontent-%COMP%]{margin-top:1rem;padding:.75rem;background:var(--bg-secondary, #f5f5f5);border-radius:4px;font-size:.875rem}.status-bar[_ngcontent-%COMP%]   .status-label[_ngcontent-%COMP%]{color:var(--text-secondary, #666);margin-right:.5rem}.status-bar[_ngcontent-%COMP%]   .status-value[_ngcontent-%COMP%]{color:var(--text-primary, #333)}.type-info[_ngcontent-%COMP%]{margin-top:1rem}.type-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:.5rem}.type-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:.5rem}.type-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.5rem;background:var(--bg-secondary, #f5f5f5);border-radius:4px;font-size:.75rem}.type-item[_ngcontent-%COMP%]   .type-label[_ngcontent-%COMP%]{color:var(--text-secondary, #666)}.type-item[_ngcontent-%COMP%]   .type-value[_ngcontent-%COMP%]{font-weight:500;color:var(--success-color, #28a745)}.code-section[_ngcontent-%COMP%]{margin-top:1.5rem;grid-column:1/-1}.code-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:.75rem;font-size:1rem}.code-section[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{background:var(--bg-code, #1e1e1e);color:var(--text-code, #d4d4d4);padding:1rem;border-radius:8px;overflow-x:auto;font-size:.8rem;line-height:1.5}.code-section[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{font-family:Monaco,Menlo,Ubuntu Mono,monospace}"]})};export{w as a};
