import{c as T,d as N,i as L,r as $,s as F,w as A}from"./chunk-AQ5ZLTRX.js";import{i as z,w as I}from"./chunk-3DDI6FWM.js";import{Ab as d,Cb as u,Hc as k,Ja as s,Jb as E,Kb as w,Lb as i,Mb as g,Nb as h,Sb as O,Tb as x,Ub as y,Ya as D,ha as v,ia as P,ib as p,jb as _,mb as C,nb as b,ob as m,pb as n,qb as t,sa as M,yb as S}from"./chunk-YYEXL5C7.js";import{j as f}from"./chunk-A3ECCK3J.js";var V=(r,e)=>e.value,B=(r,e)=>e.code,G=(r,e)=>e.id;function K(r,e){r&1&&i(0," Ready ")}function W(r,e){r&1&&i(0," Saving... ")}function Y(r,e){r&1&&i(0," \u2713 Saved ")}function U(r,e){r&1&&i(0," \u26A0\uFE0F Error ")}function H(r,e){if(r&1){let a=S();n(0,"button",34),d("click",function(){let l=v(a).$implicit,c=u();return P(c.updateTheme(l.value))}),i(1),t()}if(r&2){let a=e.$implicit,o=u();E("active",o.user().theme===a.value),s(),h(" ",a.label," ")}}function j(r,e){if(r&1&&(n(0,"option",23),i(1),t()),r&2){let a=e.$implicit;m("value",a.code),s(),g(a.name)}}function J(r,e){r&1&&(n(0,"p",29),i(1,"No notes yet. Add one above!"),t())}function q(r,e){if(r&1&&(n(0,"p",40),i(1),t()),r&2){let a=u().$implicit;s(),g(a.content)}}function Q(r,e){if(r&1){let a=S();n(0,"div",37)(1,"div",38)(2,"h4"),i(3),t(),n(4,"button",39),d("click",function(){let l=v(a).$implicit,c=u(2);return P(c.deleteNote(l.id))}),i(5," \u{1F5D1}\uFE0F "),t()(),p(6,q,2,1,"p",40),n(7,"span",41),i(8),t()()}if(r&2){let a=e.$implicit,o=u(2);s(3),g(a.title),s(3),_(a.content?6:-1),s(2),g(o.formatDate(a.createdAt))}}function X(r,e){if(r&1&&C(0,Q,9,3,"div",37,G),r&2){let a=u();b(a.notes())}}function Z(r,e){if(r&1&&(n(0,"div",36),i(1),t()),r&2){let a=u();s(),h("Error: ",a.lastError())}}var R=class r{STORAGE_KEY="signaltree-persistence-demo";saveStatus=M("idle");lastError=M(null);newNoteTitle="";newNoteContent="";store=z({user:{name:"",email:"",theme:"system"},preferences:{notifications:!0,autoSave:!0,language:"en"},notes:[],lastSaved:null}).with(I({key:this.STORAGE_KEY,autoSave:!0,autoLoad:!0,debounceMs:500,includeMetadata:!0}));user=this.store.$.user;preferences=this.store.$.preferences;notes=this.store.$.notes;lastSaved=this.store.$.lastSaved;languages=[{code:"en",name:"English"},{code:"es",name:"Spanish"},{code:"fr",name:"French"},{code:"de",name:"German"},{code:"ja",name:"Japanese"}];themes=[{value:"light",label:"\u2600\uFE0F Light"},{value:"dark",label:"\u{1F319} Dark"},{value:"system",label:"\u{1F4BB} System"}];constructor(){console.log("\u{1F504} Persistence Demo initialized"),console.log("\u{1F4E6} Storage key:",this.STORAGE_KEY)}ngOnDestroy(){this.manualSave()}updateName(e){let a=e.target;this.store.$.user.name.set(a.value),this.updateLastSaved()}updateEmail(e){let a=e.target;this.store.$.user.email.set(a.value),this.updateLastSaved()}updateTheme(e){this.store.$.user.theme.set(e),this.updateLastSaved()}toggleNotifications(){this.store.$.preferences.notifications.update(e=>!e),this.updateLastSaved()}toggleAutoSave(){this.store.$.preferences.autoSave.update(e=>!e),this.updateLastSaved()}updateLanguage(e){let a=e.target;this.store.$.preferences.language.set(a.value),this.updateLastSaved()}addNote(){if(!this.newNoteTitle.trim())return;let e={id:Date.now(),title:this.newNoteTitle.trim(),content:this.newNoteContent.trim(),createdAt:new Date().toISOString()};this.store.$.notes.update(a=>[...a,e]),this.newNoteTitle="",this.newNoteContent="",this.updateLastSaved()}deleteNote(e){this.store.$.notes.update(a=>a.filter(o=>o.id!==e)),this.updateLastSaved()}manualSave(){return f(this,null,function*(){try{this.saveStatus.set("saving"),yield this.store.save(),this.saveStatus.set("saved"),this.updateLastSaved(),setTimeout(()=>{this.saveStatus()==="saved"&&this.saveStatus.set("idle")},2e3)}catch(e){this.saveStatus.set("error"),this.lastError.set(e instanceof Error?e.message:"Unknown error")}})}manualLoad(){return f(this,null,function*(){try{this.saveStatus.set("saving"),yield this.store.load(),this.saveStatus.set("saved"),setTimeout(()=>{this.saveStatus()==="saved"&&this.saveStatus.set("idle")},2e3)}catch(e){this.saveStatus.set("error"),this.lastError.set(e instanceof Error?e.message:"Unknown error")}})}clearStorage(){return f(this,null,function*(){if(confirm("Clear all saved data? This cannot be undone."))try{yield this.store.clear(),this.store.$.user({name:"",email:"",theme:"system"}),this.store.$.preferences({notifications:!0,autoSave:!0,language:"en"}),this.store.$.notes.set([]),this.store.$.lastSaved.set(null),this.saveStatus.set("idle")}catch(e){this.saveStatus.set("error"),this.lastError.set(e instanceof Error?e.message:"Unknown error")}})}updateLastSaved(){this.store.$.lastSaved.set(new Date().toISOString())}formatDate(e){return e?new Date(e).toLocaleString():"Never"}getStorageSize(){let e=localStorage.getItem(this.STORAGE_KEY);if(!e)return"0 bytes";let a=new Blob([e]).size;return a<1024?`${a} bytes`:`${(a/1024).toFixed(2)} KB`}viewRawStorage(){let e=localStorage.getItem(this.STORAGE_KEY);e?(console.log("\u{1F4E6} Raw storage data:",JSON.parse(e)),alert("Check browser console for raw storage data")):alert("No data in storage")}static \u0275fac=function(a){return new(a||r)};static \u0275cmp=D({type:r,selectors:[["app-persistence-demo"]],decls:87,vars:16,consts:[[1,"persistence-demo"],[1,"demo-header"],[1,"description"],[1,"status-bar"],[1,"status-item"],[1,"label"],[1,"value"],[1,"demo-content"],[1,"section"],[1,"form-group"],["for","name"],["id","name","type","text","placeholder","Enter your name",3,"input","value"],["for","email"],["id","email","type","email","placeholder","Enter your email",3,"input","value"],["id","theme-label",1,"form-label"],["role","group","aria-labelledby","theme-label",1,"theme-buttons"],["type","button",3,"active"],[1,"toggle-group"],[1,"toggle"],["type","checkbox",3,"change","checked"],[1,"toggle-label"],["for","language"],["id","language",3,"change","value"],[3,"value"],[1,"add-note"],["type","text","placeholder","Note title...",3,"ngModelChange","keyup.enter","ngModel"],["placeholder","Note content (optional)...","rows","2",3,"ngModelChange","ngModel"],["type","button",3,"click","disabled"],[1,"notes-list"],[1,"empty-state"],[1,"demo-footer"],[1,"hint"],[1,"control-buttons"],["type","button",1,"primary",3,"click"],["type","button",3,"click"],["type","button",1,"danger",3,"click"],[1,"error-message"],[1,"note-card"],[1,"note-header"],["type","button","title","Delete note",1,"delete-btn",3,"click"],[1,"note-content"],[1,"note-date"]],template:function(a,o){if(a&1&&(n(0,"div",0)(1,"header",1)(2,"h2"),i(3,"\u{1F4BE} Persistence Demo"),t(),n(4,"p",2),i(5," State automatically saves to localStorage. Try making changes and refreshing the page! "),t(),n(6,"div",3)(7,"div",4)(8,"span",5),i(9,"Status:"),t(),n(10,"span",6),p(11,K,1,0)(12,W,1,0)(13,Y,1,0)(14,U,1,0),t()(),n(15,"div",4)(16,"span",5),i(17,"Last Saved:"),t(),n(18,"span",6),i(19),t()(),n(20,"div",4)(21,"span",5),i(22,"Storage Size:"),t(),n(23,"span",6),i(24),t()()()(),n(25,"div",7)(26,"section",8)(27,"h3"),i(28,"\u{1F464} User Profile"),t(),n(29,"div",9)(30,"label",10),i(31,"Name"),t(),n(32,"input",11),d("input",function(c){return o.updateName(c)}),t()(),n(33,"div",9)(34,"label",12),i(35,"Email"),t(),n(36,"input",13),d("input",function(c){return o.updateEmail(c)}),t()(),n(37,"div",9)(38,"span",14),i(39,"Theme"),t(),n(40,"div",15),C(41,H,2,3,"button",16,V),t()()(),n(43,"section",8)(44,"h3"),i(45,"\u2699\uFE0F Preferences"),t(),n(46,"div",17)(47,"label",18)(48,"input",19),d("change",function(){return o.toggleNotifications()}),t(),n(49,"span",20),i(50,"\u{1F514} Enable Notifications"),t()(),n(51,"label",18)(52,"input",19),d("change",function(){return o.toggleAutoSave()}),t(),n(53,"span",20),i(54,"\u{1F4BE} Auto-Save Enabled"),t()()(),n(55,"div",9)(56,"label",21),i(57,"Language"),t(),n(58,"select",22),d("change",function(c){return o.updateLanguage(c)}),C(59,j,2,2,"option",23,B),t()()(),n(61,"section",8)(62,"h3"),i(63),t(),n(64,"div",24)(65,"input",25),y("ngModelChange",function(c){return x(o.newNoteTitle,c)||(o.newNoteTitle=c),c}),d("keyup.enter",function(){return o.addNote()}),t(),n(66,"textarea",26),y("ngModelChange",function(c){return x(o.newNoteContent,c)||(o.newNoteContent=c),c}),t(),n(67,"button",27),d("click",function(){return o.addNote()}),i(68," Add Note "),t()(),n(69,"div",28),p(70,J,2,0,"p",29)(71,X,2,0),t()()(),n(72,"footer",30)(73,"h3"),i(74,"\u{1F3AE} Manual Controls"),t(),n(75,"p",31),i(76," Auto-save handles most cases, but you can manually control persistence: "),t(),n(77,"div",32)(78,"button",33),d("click",function(){return o.manualSave()}),i(79," \u{1F4BE} Save Now "),t(),n(80,"button",34),d("click",function(){return o.manualLoad()}),i(81," \u{1F4E5} Reload from Storage "),t(),n(82,"button",34),d("click",function(){return o.viewRawStorage()}),i(83,"\u{1F441}\uFE0F View Raw Data"),t(),n(84,"button",35),d("click",function(){return o.clearStorage()}),i(85," \u{1F5D1}\uFE0F Clear Storage "),t()(),p(86,Z,2,1,"div",36),t()()),a&2){let l;s(10),w(o.saveStatus()),s(),_((l=o.saveStatus())==="idle"?11:l==="saving"?12:l==="saved"?13:l==="error"?14:-1),s(8),g(o.formatDate(o.lastSaved())),s(5),g(o.getStorageSize()),s(8),m("value",o.user().name),s(4),m("value",o.user().email),s(5),b(o.themes),s(7),m("checked",o.preferences().notifications),s(4),m("checked",o.preferences().autoSave),s(6),m("value",o.preferences().language),s(),b(o.languages),s(4),h("\u{1F4DD} Notes (",o.notes().length,")"),s(2),O("ngModel",o.newNoteTitle),s(),O("ngModel",o.newNoteContent),s(),m("disabled",!o.newNoteTitle.trim()),s(3),_(o.notes().length===0?70:71),s(16),_(o.lastError()?86:-1)}},dependencies:[k,A,$,F,T,N,L],styles:[".persistence-demo[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:1rem}.demo-header[_ngcontent-%COMP%]{margin-bottom:2rem}.demo-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 .5rem;color:#1a1a2e}.demo-header[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{color:#666;margin-bottom:1rem}.status-bar[_ngcontent-%COMP%]{display:flex;gap:2rem;padding:1rem;background:#f8f9fa;border-radius:8px;flex-wrap:wrap}.status-bar[_ngcontent-%COMP%]   .status-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.status-bar[_ngcontent-%COMP%]   .status-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:#666}.status-bar[_ngcontent-%COMP%]   .status-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:monospace}.status-bar[_ngcontent-%COMP%]   .status-item[_ngcontent-%COMP%]   .value.saving[_ngcontent-%COMP%]{color:#f59e0b}.status-bar[_ngcontent-%COMP%]   .status-item[_ngcontent-%COMP%]   .value.saved[_ngcontent-%COMP%]{color:#10b981}.status-bar[_ngcontent-%COMP%]   .status-item[_ngcontent-%COMP%]   .value.error[_ngcontent-%COMP%]{color:#ef4444}.demo-content[_ngcontent-%COMP%]{display:grid;gap:1.5rem}.section[_ngcontent-%COMP%]{padding:1.5rem;background:#fff;border-radius:8px;border:1px solid #e5e7eb}.section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1rem;color:#1a1a2e;font-size:1.1rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{display:block;margin-bottom:.25rem;font-weight:500;color:#374151}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:.5rem;border:1px solid #d1d5db;border-radius:4px;font-size:1rem}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#6366f1;box-shadow:0 0 0 3px #6366f11a}.theme-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem}.theme-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:.5rem 1rem;border:1px solid #d1d5db;background:#fff;border-radius:4px;cursor:pointer;transition:all .2s}.theme-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#f3f4f6}.theme-buttons[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#6366f1;color:#fff;border-color:#6366f1}.toggle-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem;margin-bottom:1rem}.toggle[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer}.toggle[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:1.25rem;height:1.25rem;cursor:pointer}.toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%]{font-size:.95rem}.add-note[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;margin-bottom:1rem}.add-note[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .add-note[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{padding:.5rem;border:1px solid #d1d5db;border-radius:4px;font-size:1rem;font-family:inherit}.add-note[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .add-note[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#6366f1}.add-note[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{align-self:flex-start;padding:.5rem 1rem;background:#6366f1;color:#fff;border:none;border-radius:4px;cursor:pointer}.add-note[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:#4f46e5}.add-note[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.notes-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.empty-state[_ngcontent-%COMP%]{color:#9ca3af;text-align:center;padding:2rem;font-style:italic}.note-card[_ngcontent-%COMP%]{padding:1rem;background:#f9fafb;border-radius:6px;border:1px solid #e5e7eb}.note-card[_ngcontent-%COMP%]   .note-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.note-card[_ngcontent-%COMP%]   .note-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:1rem;color:#1f2937}.note-card[_ngcontent-%COMP%]   .note-header[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;padding:.25rem;font-size:1rem;opacity:.6}.note-card[_ngcontent-%COMP%]   .note-header[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]:hover{opacity:1}.note-card[_ngcontent-%COMP%]   .note-content[_ngcontent-%COMP%]{margin:.5rem 0;color:#4b5563;font-size:.9rem}.note-card[_ngcontent-%COMP%]   .note-date[_ngcontent-%COMP%]{display:block;font-size:.75rem;color:#9ca3af}.demo-footer[_ngcontent-%COMP%]{margin-top:2rem;padding:1.5rem;background:#f8f9fa;border-radius:8px}.demo-footer[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1rem}.demo-footer[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{color:#666;margin-bottom:1rem;font-size:.9rem}.control-buttons[_ngcontent-%COMP%]{display:flex;gap:.75rem;flex-wrap:wrap}.control-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.5rem 1rem;border:1px solid #d1d5db;background:#fff;border-radius:4px;cursor:pointer;transition:all .2s}.control-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#f3f4f6}.control-buttons[_ngcontent-%COMP%]   button.primary[_ngcontent-%COMP%]{background:#6366f1;color:#fff;border-color:#6366f1}.control-buttons[_ngcontent-%COMP%]   button.primary[_ngcontent-%COMP%]:hover{background:#4f46e5}.control-buttons[_ngcontent-%COMP%]   button.danger[_ngcontent-%COMP%]{color:#dc2626;border-color:#dc2626}.control-buttons[_ngcontent-%COMP%]   button.danger[_ngcontent-%COMP%]:hover{background:#fef2f2}.error-message[_ngcontent-%COMP%]{margin-top:1rem;padding:.75rem;background:#fef2f2;color:#dc2626;border-radius:4px;font-size:.9rem}"]})};export{R as a};
