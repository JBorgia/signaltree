import{a as Y}from"./chunk-FZJ2FUJ6.js";import{b as E,c as C,d as X}from"./chunk-YLUDIB2Y.js";import{a as W,b as V,c as j,d as L,e as q,i as H,j as G,k as J}from"./chunk-A6RTFK75.js";import{e as K}from"./chunk-3XX2APIE.js";import{Fb as w,Gb as r,Hb as g,Ib as u,Ja as M,Jb as y,La as o,Lb as x,Mb as _,Nb as S,Rb as D,Sb as k,Va as U,Yb as Q,Za as m,Zb as O,a as h,b as P,j as B,ma as I,mc as z,na as T,nb as l,nc as R,ob as a,oc as N,pb as n,qb as v,tb as F,tc as A,vb as p,xb as f}from"./chunk-M6ZH6AMU.js";function ne(d,i){d&1&&(a(0,"div",50),v(1,"div",51),a(2,"span",52),r(3,"Processing batch..."),n()())}function ae(d,i){if(d&1){let t=F();a(0,"div",53)(1,"div",54),v(2,"div",55),a(3,"div")(4,"div",56),r(5),D(6,"titlecase"),D(7,"titlecase"),n(),a(8,"div",57),r(9),n()()(),a(10,"button",58),p("click",function(){let s=I(t).$implicit,c=f();return T(c.removeOperation(s.id))}),r(11," Remove "),n()()}if(d&2){let t=i.$implicit,e=f();w(e.getOperationStatusClass(t)),o(2),w(e.getOperationStatusDot(t)),o(3),y(" ",k(6,9,t.type)," ",k(7,11,t.entity)," "),o(4),y(" ",t.id," \u2022 ",e.formatTimestamp(t.timestamp)," "),o(),l("disabled",e.processing()||t.status==="processing")}}function re(d,i){d&1&&(a(0,"div",59),r(1," No operations in queue. Add some operations to get started. "),n())}function oe(d,i){if(d&1&&(a(0,"div",60),v(1,"img",61),a(2,"div",62)(3,"div",56),r(4),n(),a(5,"div",57),r(6),n()()()),d&2){let t=i.$implicit;o(),l("src",t.avatar,M)("alt",t.name),o(3),g(t.name),o(2),g(t.email)}}function se(d,i){d&1&&(a(0,"div",63),r(1," No users yet. Create some users to see them here. "),n())}function de(d,i){if(d&1&&(a(0,"div",64)(1,"div",56),r(2),n(),a(3,"div",65),r(4),n()()),d&2){let t=i.$implicit,e=f();o(2),g(t.title),o(2),y(" by ",e.getUserName(t.authorId)," \u2022 ",t.content.length," chars ")}}function le(d,i){d&1&&(a(0,"div",63),r(1," No posts yet. Create some posts to see them here. "),n())}function ce(d,i){if(d&1&&(a(0,"div",17)(1,"div",66)(2,"div",67),r(3),n(),a(4,"div",68),r(5),n()(),a(6,"div",69)(7,"div")(8,"div",70),r(9,"Operations"),n(),a(10,"div"),r(11),n()(),a(12,"div")(13,"div",71),r(14,"Success"),n(),a(15,"div"),r(16),n()(),a(17,"div")(18,"div",72),r(19,"Failed"),n(),a(20,"div"),r(21),n()(),a(22,"div")(23,"div",73),r(24,"Duration"),n(),a(25,"div"),r(26),n()()(),a(27,"div",74),r(28),n()()),d&2){let t=i.$implicit,e=f();o(3),g(t.batchId),o(2),u(" ",e.formatTimestamp(t.timestamp)," "),o(6),g(t.operations.length),o(5),g(t.successCount),o(5),g(t.failureCount),o(5),u("",t.duration.toFixed(0),"ms"),o(2),u(" ",e.getOperationsSummary(t.operations)," ")}}function pe(d,i){d&1&&(a(0,"div",59),r(1," No batch processing history yet. Process some batches to see results here. "),n())}var $=class{processBatch(i,t=1e3){return B(this,null,function*(){let e=performance.now(),s=`batch_${Date.now()}`;yield X(t);let c=i.map(b=>P(h({},b),{status:Math.random()>.1?"completed":"failed",error:Math.random()>.1?void 0:"Simulated processing error"})),ee=performance.now()-e,te=c.filter(b=>b.status==="completed").length,ie=c.filter(b=>b.status==="failed").length;return{batchId:s,operations:c,duration:ee,successCount:te,failureCount:ie,timestamp:Date.now()}})}},Z=class d{store=K({users:E(5),posts:C(10,5),batchQueue:[],processing:!1,completedOperations:[],batchResults:[],autoProcess:!0,batchSize:5,processingDelay:1e3}).with(Y({enabled:!0,maxBatchSize:50,autoFlushDelay:16,batchTimeoutMs:100}));batchProcessor=new $;users=this.store.$.users;posts=this.store.$.posts;batchQueue=this.store.$.batchQueue;processing=this.store.$.processing;completedOperations=this.store.$.completedOperations;batchResults=this.store.$.batchResults;batchSize=this.store.$.batchSize();processingDelay=this.store.$.processingDelay();autoProcess=this.store.$.autoProcess();pendingOperationsCount=Q(()=>this.batchQueue().filter(i=>i.status==="pending").length);constructor(){O(()=>{this.autoProcess&&this.batchQueue().length>=this.batchSize&&!this.processing()&&this.processBatch()}),O(()=>{this.store.$.batchSize.set(this.batchSize),this.store.$.processingDelay.set(this.processingDelay),this.store.$.autoProcess.set(this.autoProcess)})}generateOperationId(){return`op_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}addCreateUserOperation(){let i={id:this.generateOperationId(),type:"create",entity:"user",data:{name:`User ${Date.now()}`,email:`user${Date.now()}@example.com`,avatar:`https://api.dicebear.com/7.x/avataaars/svg?seed=${Date.now()}`},timestamp:Date.now(),status:"pending"};this.store.$.batchQueue.update(t=>[...t,i])}addUpdateUserOperation(){let i=this.users();if(i.length===0)return;let t=i[Math.floor(Math.random()*i.length)],e={id:this.generateOperationId(),type:"update",entity:"user",data:{id:t.id,name:`${t.name} (updated)`,email:t.email,avatar:t.avatar},timestamp:Date.now(),status:"pending"};this.store.$.batchQueue.update(s=>[...s,e])}addDeleteUserOperation(){let i=this.users();if(i.length===0)return;let t=i[Math.floor(Math.random()*i.length)],e={id:this.generateOperationId(),type:"delete",entity:"user",data:{id:t.id},timestamp:Date.now(),status:"pending"};this.store.$.batchQueue.update(s=>[...s,e])}addBulkUserOperations(){let i=[];for(let e=0;e<3;e++)i.push({id:Date.now()+e,name:`Bulk User ${Date.now()}_${e}`,email:`bulk${Date.now()}_${e}@example.com`,avatar:`https://api.dicebear.com/7.x/avataaars/svg?seed=bulk${Date.now()}_${e}`});this.store.$.users.update(e=>[...e,...i]),this.store.$.batchQueue.set([]),this.store.$.processing.set(!1);let t=i.map(e=>({id:this.generateOperationId(),type:"create",entity:"user",data:e,timestamp:Date.now(),status:"completed"}));this.store.$.completedOperations.update(e=>[...e,...t])}addCreatePostOperation(){let i=this.users();if(i.length===0)return;let t=i[Math.floor(Math.random()*i.length)],e={id:this.generateOperationId(),type:"create",entity:"post",data:{title:`Post ${Date.now()}`,content:`This is a new post created at ${new Date().toLocaleTimeString()}`,authorId:t.id,tags:["demo"],likes:0,createdAt:new Date},timestamp:Date.now(),status:"pending"};this.store.$.batchQueue.update(s=>[...s,e])}addUpdatePostOperation(){let i=this.posts();if(i.length===0)return;let t=i[Math.floor(Math.random()*i.length)],e={id:this.generateOperationId(),type:"update",entity:"post",data:{id:t.id,title:`${t.title} (updated)`,content:t.content,authorId:t.authorId,tags:t.tags,likes:t.likes,createdAt:t.createdAt},timestamp:Date.now(),status:"pending"};this.store.$.batchQueue.update(s=>[...s,e])}addDeletePostOperation(){let i=this.posts();if(i.length===0)return;let t=i[Math.floor(Math.random()*i.length)],e={id:this.generateOperationId(),type:"delete",entity:"post",data:{id:t.id},timestamp:Date.now(),status:"pending"};this.store.$.batchQueue.update(s=>[...s,e])}addBulkPostOperations(){let i=this.users();if(i.length===0)return;let t=[];for(let s=0;s<4;s++){let c=i[Math.floor(Math.random()*i.length)];t.push({id:Date.now()+s,title:`Bulk Post ${Date.now()}_${s}`,content:`This is bulk post ${s} created at ${new Date().toLocaleTimeString()}`,authorId:c.id,tags:["bulk","demo"],likes:0,createdAt:new Date})}this.store.$.posts.update(s=>[...s,...t]),this.store.$.batchQueue.set([]),this.store.$.processing.set(!1);let e=t.map(s=>({id:this.generateOperationId(),type:"create",entity:"post",data:s,timestamp:Date.now(),status:"completed"}));this.store.$.completedOperations.update(s=>[...s,...e])}processBatch(){return B(this,null,function*(){let i=this.batchQueue();if(i.length!==0){this.store.$.processing.set(!0);try{let t=yield this.batchProcessor.processBatch(i,this.processingDelay);t.operations.forEach(e=>{e.status==="completed"&&this.applyOperationToState(e)}),this.store.$.batchResults.update(e=>[...e,t]),this.store.$.completedOperations.update(e=>[...e,...t.operations]),this.store.$.batchQueue.set([])}catch(t){console.error("Batch processing failed:",t)}finally{this.store.$.processing.set(!1)}}})}applyOperationToState(i){switch(i.entity){case"user":{switch(i.type){case"create":{let t=E(1)[0];t.id=Math.max(...this.users().map(e=>e.id),0)+1,this.store.$.users.update(e=>[...e,t]);break}case"update":{this.store.$.users.update(t=>t.map(e=>e.id===i.data.id?h(h({},e),i.data):e));break}case"delete":{this.store.$.users.update(t=>t.filter(e=>e.id!==i.data.id)),this.store.$.posts.update(t=>t.filter(e=>e.authorId!==i.data.id));break}}break}case"post":{switch(i.type){case"create":{let t=this.users();if(t.length===0)break;let e=C(1,t.length)[0];e.id=Math.max(...this.posts().map(s=>s.id),0)+1,e.authorId=t[Math.floor(Math.random()*t.length)].id,this.store.$.posts.update(s=>[...s,e]);break}case"update":{this.store.$.posts.update(t=>t.map(e=>e.id===i.data.id?h(h({},e),i.data):e));break}case"delete":{this.store.$.posts.update(t=>t.filter(e=>e.id!==i.data.id));break}}break}}}removeOperation(i){this.store.$.batchQueue.update(t=>t.filter(e=>e.id!==i))}clearBatch(){this.store.$.batchQueue.set([])}getOperationStatusClass(i){switch(i.status){case"pending":return"bg-gray-50 border-gray-200";case"processing":return"bg-yellow-50 border-yellow-200";case"completed":return"bg-green-50 border-green-200";case"failed":return"bg-red-50 border-red-200";default:return"bg-gray-50 border-gray-200"}}getOperationStatusDot(i){switch(i.status){case"pending":return"bg-gray-400";case"processing":return"bg-yellow-400";case"completed":return"bg-green-400";case"failed":return"bg-red-400";default:return"bg-gray-400"}}getUserName(i){let t=this.users().find(e=>e.id===i);return t?t.name:"Unknown User"}getOperationsSummary(i){return i.map(t=>`${t.type} ${t.entity}`).join(", ")}formatTimestamp(i){return new Date(i).toLocaleTimeString()}trackOperation(i,t){return t.id}trackUser(i,t){return t.id}trackPost(i,t){return t.id}trackBatchResult(i,t){return t.batchId}static \u0275fac=function(t){return new(t||d)};static \u0275cmp=U({type:d,selectors:[["app-batching-demo"]],decls:124,vars:31,consts:[[1,"container","mx-auto","p-6"],[1,"text-3xl","font-bold","mb-6"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-8"],[1,"bg-white","rounded-lg","shadow","p-6"],[1,"text-xl","font-semibold","mb-4"],[1,"mb-6","p-4","bg-gray-50","rounded-lg"],[1,"font-medium","mb-3"],[1,"grid","grid-cols-2","gap-4"],["for","batchSize",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","batchSize","type","number","min","1","max","50",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["for","processingDelay",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","processingDelay","type","number","min","100","max","5000","step","100",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],[1,"mt-3"],[1,"flex","items-center"],["type","checkbox",1,"rounded","border-gray-300","text-blue-600","focus:ring-blue-500",3,"ngModelChange","ngModel"],[1,"ml-2","text-sm","text-gray-700"],[1,"space-y-4"],[1,"border","rounded-lg","p-4"],[1,"font-medium","mb-2"],[1,"grid","grid-cols-2","gap-2"],[1,"px-3","py-2","bg-green-500","text-white","rounded","text-sm","hover:bg-green-600",3,"click"],[1,"px-3","py-2","bg-blue-500","text-white","rounded","text-sm","hover:bg-blue-600","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"px-3","py-2","bg-red-500","text-white","rounded","text-sm","hover:bg-red-600","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"px-3","py-2","bg-purple-500","text-white","rounded","text-sm","hover:bg-purple-600",3,"click"],[1,"px-3","py-2","bg-green-500","text-white","rounded","text-sm","hover:bg-green-600","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"px-3","py-2","bg-purple-500","text-white","rounded","text-sm","hover:bg-purple-600","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","gap-2"],[1,"px-4","py-2","bg-orange-500","text-white","rounded","hover:bg-orange-600","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"px-4","py-2","bg-gray-500","text-white","rounded","hover:bg-gray-600","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"mb-4","p-3","bg-blue-50","rounded-lg"],[1,"grid","grid-cols-3","gap-4","text-sm"],[1,"text-center"],[1,"font-semibold","text-blue-800"],[1,"text-blue-600"],["class","mb-4 flex items-center justify-center py-4",4,"ngIf"],[1,"space-y-2","max-h-64","overflow-y-auto"],["class","flex items-center justify-between p-3 border rounded-lg",3,"class",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center text-gray-500 py-8",4,"ngIf"],[1,"mt-8","grid","grid-cols-1","lg:grid-cols-2","gap-8"],[1,"space-y-2","max-h-48","overflow-y-auto"],["class","flex items-center gap-3 p-2 rounded bg-gray-50",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center text-gray-500 py-4",4,"ngIf"],["class","p-3 rounded bg-gray-50",4,"ngFor","ngForOf","ngForTrackBy"],[1,"mt-8","bg-white","rounded-lg","shadow","p-6"],[1,"space-y-3"],["class","border rounded-lg p-4",4,"ngFor","ngForOf","ngForTrackBy"],[1,"mt-8","bg-green-50","rounded-lg","p-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"font-medium","text-green-800","mb-2"],[1,"text-sm","text-green-700"],[1,"mb-4","flex","items-center","justify-center","py-4"],[1,"animate-spin","rounded-full","h-6","w-6","border-b-2","border-orange-500"],[1,"ml-2","text-orange-600"],[1,"flex","items-center","justify-between","p-3","border","rounded-lg"],[1,"flex","items-center","gap-3"],[1,"w-2","h-2","rounded-full"],[1,"font-medium","text-sm"],[1,"text-xs","text-gray-500"],[1,"px-2","py-1","text-xs","bg-red-500","text-white","rounded","hover:bg-red-600","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"text-center","text-gray-500","py-8"],[1,"flex","items-center","gap-3","p-2","rounded","bg-gray-50"],[1,"w-8","h-8","rounded-full",3,"src","alt"],[1,"flex-1"],[1,"text-center","text-gray-500","py-4"],[1,"p-3","rounded","bg-gray-50"],[1,"text-xs","text-gray-500","mt-1"],[1,"flex","items-center","justify-between","mb-2"],[1,"font-medium"],[1,"text-sm","text-gray-500"],[1,"grid","grid-cols-4","gap-4","text-sm"],[1,"font-medium","text-gray-700"],[1,"font-medium","text-green-700"],[1,"font-medium","text-red-700"],[1,"font-medium","text-blue-700"],[1,"mt-2","text-xs","text-gray-600"]],template:function(t,e){t&1&&(a(0,"div",0)(1,"h1",1),r(2,"SignalTree Batching Demo"),n(),a(3,"div",2)(4,"div",3)(5,"h2",4),r(6,"Batch Operations"),n(),a(7,"div",5)(8,"h3",6),r(9,"Batch Settings"),n(),a(10,"div",7)(11,"div")(12,"label",8),r(13,"Batch Size"),n(),a(14,"input",9),S("ngModelChange",function(c){return _(e.batchSize,c)||(e.batchSize=c),c}),n()(),a(15,"div")(16,"label",10),r(17,"Delay (ms)"),n(),a(18,"input",11),S("ngModelChange",function(c){return _(e.processingDelay,c)||(e.processingDelay=c),c}),n()()(),a(19,"div",12)(20,"label",13)(21,"input",14),S("ngModelChange",function(c){return _(e.autoProcess,c)||(e.autoProcess=c),c}),n(),a(22,"span",15),r(23,"Auto-process when batch is full"),n()()()(),a(24,"div",16)(25,"div",17)(26,"h3",18),r(27,"User Operations"),n(),a(28,"div",19)(29,"button",20),p("click",function(){return e.addCreateUserOperation()}),r(30," + Create User "),n(),a(31,"button",21),p("click",function(){return e.addUpdateUserOperation()}),r(32," \u21BB Update User "),n(),a(33,"button",22),p("click",function(){return e.addDeleteUserOperation()}),r(34," \xD7 Delete User "),n(),a(35,"button",23),p("click",function(){return e.addBulkUserOperations()}),r(36," \u26A1 Bulk Users "),n()()(),a(37,"div",17)(38,"h3",18),r(39,"Post Operations"),n(),a(40,"div",19)(41,"button",24),p("click",function(){return e.addCreatePostOperation()}),r(42," + Create Post "),n(),a(43,"button",21),p("click",function(){return e.addUpdatePostOperation()}),r(44," \u21BB Update Post "),n(),a(45,"button",22),p("click",function(){return e.addDeletePostOperation()}),r(46," \xD7 Delete Post "),n(),a(47,"button",25),p("click",function(){return e.addBulkPostOperations()}),r(48," \u26A1 Bulk Posts "),n()()(),a(49,"div",17)(50,"h3",18),r(51,"Batch Control"),n(),a(52,"div",26)(53,"button",27),p("click",function(){return e.processBatch()}),r(54),n(),a(55,"button",28),p("click",function(){return e.clearBatch()}),r(56," Clear Batch "),n()()()()(),a(57,"div",3)(58,"h2",4),r(59,"Batch Queue"),n(),a(60,"div",29)(61,"div",30)(62,"div",31)(63,"div",32),r(64),n(),a(65,"div",33),r(66,"Queued"),n()(),a(67,"div",31)(68,"div",32),r(69),n(),a(70,"div",33),r(71,"Pending"),n()(),a(72,"div",31)(73,"div",32),r(74),n(),a(75,"div",33),r(76,"Completed"),n()()()(),m(77,ne,4,0,"div",34),a(78,"div",35),m(79,ae,12,13,"div",36),n(),m(80,re,2,0,"div",37),n()(),a(81,"div",38)(82,"div",3)(83,"h2",4),r(84),n(),a(85,"div",39),m(86,oe,7,4,"div",40),n(),m(87,se,2,0,"div",41),n(),a(88,"div",3)(89,"h2",4),r(90),n(),a(91,"div",39),m(92,de,5,3,"div",42),n(),m(93,le,2,0,"div",41),n()(),a(94,"div",43)(95,"h2",4),r(96,"Batch Processing History"),n(),a(97,"div",44),m(98,ce,29,7,"div",45),n(),m(99,pe,2,0,"div",37),n(),a(100,"div",46)(101,"h2",4),r(102," Batching Features Demonstrated "),n(),a(103,"div",47)(104,"div")(105,"h3",48),r(106,"Operation Queuing"),n(),a(107,"p",49),r(108," Operations are queued in memory and processed together for efficiency. "),n()(),a(109,"div")(110,"h3",48),r(111," Configurable Batching "),n(),a(112,"p",49),r(113," Batch size and processing delays can be configured for optimal performance. "),n()(),a(114,"div")(115,"h3",48),r(116,"Auto-Processing"),n(),a(117,"p",49),r(118," Batches can be automatically processed when they reach the configured size. "),n()(),a(119,"div")(120,"h3",48),r(121,"Error Handling"),n(),a(122,"p",49),r(123," Individual operation failures don't block the entire batch from processing. "),n()()()()()),t&2&&(o(14),x("ngModel",e.batchSize),o(4),x("ngModel",e.processingDelay),o(3),x("ngModel",e.autoProcess),o(10),l("disabled",e.users().length===0),o(2),l("disabled",e.users().length===0),o(8),l("disabled",e.users().length===0),o(2),l("disabled",e.posts().length===0),o(2),l("disabled",e.posts().length===0),o(2),l("disabled",e.users().length===0),o(6),l("disabled",e.batchQueue().length===0||e.processing()),o(),y(" ",e.processing()?"Processing...":"Process Batch"," (",e.batchQueue().length,") "),o(),l("disabled",e.batchQueue().length===0||e.processing()),o(9),u(" ",e.batchQueue().length," "),o(5),u(" ",e.pendingOperationsCount()," "),o(5),u(" ",e.completedOperations().length," "),o(3),l("ngIf",e.processing()),o(2),l("ngForOf",e.batchQueue())("ngForTrackBy",e.trackOperation),o(),l("ngIf",e.batchQueue().length===0),o(4),u(" Users (",e.users().length,") "),o(2),l("ngForOf",e.users())("ngForTrackBy",e.trackUser),o(),l("ngIf",e.users().length===0),o(3),u(" Posts (",e.posts().length,") "),o(2),l("ngForOf",e.posts())("ngForTrackBy",e.trackPost),o(),l("ngIf",e.posts().length===0),o(5),l("ngForOf",e.batchResults().slice().reverse())("ngForTrackBy",e.trackBatchResult),o(),l("ngIf",e.batchResults().length===0))},dependencies:[A,z,R,J,V,q,W,j,G,H,L,N],encapsulation:2})};export{Z as BatchingDemoComponent};
