import{a as V}from"./chunk-7MB6DANI.js";import{a as b,b as ie}from"./chunk-X4WEGLGO.js";import{a as z,b as N}from"./chunk-YWKZDN6Z.js";import{a as ee,e as T}from"./chunk-75A3EJSS.js";import{$b as x,a as M,b as E,da as oe,j as y,ya as D}from"./chunk-IT4IGUIF.js";var Ie=5*60*1e3,ye=new Map;function we(c,e){if(c===e)return!0;if(c==null||e==null||typeof c!=typeof e)return!1;if(typeof c=="object"&&typeof e=="object"){let r=c,a=e,i=0;for(let n in r)if(Object.prototype.hasOwnProperty.call(r,n)&&(i++,!(n in a)||r[n]!==a[n]))return!1;let t=0;for(let n in a)Object.prototype.hasOwnProperty.call(a,n)&&t++;return i===t}return!1}function se(c,e){if(c===e)return!0;if(c==null||e==null||typeof c!=typeof e)return!1;if(typeof c=="object"){let r=Object.keys(c),a=Object.keys(e);if(r.length!==a.length)return!1;for(let i of r)if(!a.includes(i)||!se(c[i],e[i]))return!1;return!0}return!1}function Se(c,e){try{return`${c.name||"anonymous"}_${JSON.stringify(e)}`}catch{return`${c.name||"anonymous"}_${e.length}`}}function be(c){switch(c){case"shallow":return we;case"reference":return(e,r)=>e===r;case"deep":default:return se}}var ce={selector:{equality:"reference",maxCacheSize:10,enableLRU:!1,ttl:void 0},computed:{equality:"shallow",maxCacheSize:100,enableLRU:!1,ttl:void 0},deepState:{equality:"deep",maxCacheSize:1e3,enableLRU:!0,ttl:5*60*1e3},highFrequency:{equality:"reference",maxCacheSize:5,enableLRU:!1,ttl:void 0}};function le(){return O(ce.selector)}function ue(){return O(ce.computed)}function O(c={}){let{enabled:e=!0,maxCacheSize:r=1e3,ttl:a,equality:i="deep",enableLRU:t=!0}=c;return n=>{if(!e)return n;let o=new Map;ye.set(n,o);let s=be(i),l=()=>{if(!t||o.size<=r)return;let u=Array.from(o.entries());u.sort((h,f)=>(h[1].timestamp||0)-(f[1].timestamp||0)),u.slice(0,o.size-r+1).forEach(([h])=>o.delete(h))},m=n.bind(n);n.memoizedUpdate=(u,d)=>{let h=m(),f=d||Se(u,[h]),g=o.get(f);if(g&&s(g.deps,[h])){let k=g.value;Object.entries(k).forEach(([I,A])=>{let R=n.state[I];R&&"set"in R?R.set(A):ee(R)&&R(A)});return}let S=u(h);o.set(f,{value:S,deps:[h],timestamp:Date.now(),hitCount:1}),Object.entries(S).forEach(([k,I])=>{let A=n.state[k];A&&"set"in A?A.set(I):ee(A)&&A(I)}),l()},n.clearMemoCache=u=>{u?o.delete(u):o.clear()},n.getCacheStats=()=>{let u=0,d=0;for(let f of o.values())u+=f.hitCount||0,d+=Math.floor((f.hitCount||0)/2);let h=u+d>0?u/(u+d):0;return{size:o.size,hitRate:h,totalHits:u,totalMisses:d,keys:Array.from(o.keys())}};let p=n._memoCleanupInterval;if(p&&typeof p=="number"){let u=n.clearMemoCache.bind(n);n.clearMemoCache=d=>{u(d);try{clearInterval(p)}catch{}}}if(a){let d=setInterval(()=>{let h=Date.now();for(let[f,g]of o.entries())g.timestamp&&h-g.timestamp>a&&o.delete(f)},a);n._memoCleanupInterval=d}return n}}function L(){return O({enabled:!0,maxCacheSize:100,ttl:void 0,equality:"reference",enableLRU:!1})}function Y(){return O({enabled:!0,maxCacheSize:1e3,ttl:6e4,equality:"shallow",enableLRU:!0})}var w={DATE:"\xA7d",REGEXP:"\xA7r",MAP:"\xA7m",SET:"\xA7s",UNDEFINED:"\xA7u",NAN:"\xA7n",INFINITY:"\xA7i",NEG_INFINITY:"\xA7-i",BIGINT:"\xA7b",SYMBOL:"\xA7y",FUNCTION:"\xA7f",CIRCULAR:"\xA7c"};var me={includeMetadata:!0,replacer:void 0,reviver:void 0,preserveTypes:!0,maxDepth:50,handleCircular:!0};function U(c,e=new WeakSet,r=0,a=50,i=!0){if(r>a)return"[Max Depth Exceeded]";if(c===null||typeof c!="object")return i?c===void 0?{[w.UNDEFINED]:!0}:typeof c=="number"?Number.isNaN(c)?{[w.NAN]:!0}:c===1/0?{[w.INFINITY]:!0}:c===-1/0?{[w.NEG_INFINITY]:!0}:c:typeof c=="bigint"?{[w.BIGINT]:String(c)}:typeof c=="symbol"?{[w.SYMBOL]:String(c)}:c:c;if(typeof c=="function")try{let t=c();return U(t,e,r+1,a,i)}catch{return"[Function]"}if(e.has(c))return"[Circular Reference]";if(D(c))return c();if(i){if(c instanceof Date)return{[w.DATE]:c.toISOString()};if(c instanceof RegExp)return{[w.REGEXP]:{source:c.source,flags:c.flags}};if(c instanceof Map)return{[w.MAP]:Array.from(c.entries())};if(c instanceof Set)return{[w.SET]:Array.from(c.values())}}else if(c instanceof Date||c instanceof RegExp)return c;e.add(c);try{if(Array.isArray(c)){let n=c.map(o=>U(o,e,r+1,a,i));return e.delete(c),n}let t={};for(let[n,o]of Object.entries(c))if(!((n==="set"||n==="update")&&typeof o=="function"&&!D(o)))if(D(o))t[n]=U(o(),e,r+1,a,i);else if(typeof o=="function"&&n!=="set"&&n!=="update")try{let s=o();t[n]=U(s,e,r+1,a,i)}catch{continue}else t[n]=U(o,e,r+1,a,i);return e.delete(c),t}catch{return e.delete(c),"[Serialization Error]"}}function J(c,e="",r=new WeakSet,a=new Map){let i=[];if(c===null||typeof c!="object")return i;if(r.has(c)){let t=a.get(c)||"";return i.push({path:e,targetPath:t}),i}if(r.add(c),a.set(c,e),Array.isArray(c)){let t=c;for(let n=0;n<t.length;n++){let o=e?`${e}[${n}]`:`[${n}]`,s=J(t[n],o,r,a);i.push(...s)}}else for(let[t,n]of Object.entries(c)){let o=e?`${e}.${t}`:t,s=J(n,o,r,a);i.push(...s)}return r.delete(c),i}function Te(c){let e=new WeakSet,r=new Map;return function(i,t){if(c.replacer&&(t=c.replacer.call(this,i,t)),D(t))return t();if(t&&typeof t=="object"){if(e.has(t)){if(c.handleCircular){let o=r.get(t)||"";return{[w.CIRCULAR]:o}}return}e.add(t);let n=i||"";r.set(t,n)}return t}}function de(c,e){for(let{path:r,targetPath:a}of e){let i=r.split(/\.|\[|\]/).filter(Boolean),t=a.split(/\.|\[|\]/).filter(Boolean),n=c;for(let s=0;s<i.length-1&&(n=n[i[s]],!!n);s++);let o=c;for(let s of t)if(o=o[s],!o)break;n&&o&&(n[i[i.length-1]]=o)}}function te(c={}){let e=r=>{let a=r;a.toJSON=()=>r(),a.fromJSON=(t,n)=>{let o=u=>{if(!u||typeof u!="object")return u;if(w.UNDEFINED in u)return;if(w.NAN in u)return NaN;if(w.INFINITY in u)return 1/0;if(w.NEG_INFINITY in u)return-1/0;if(w.BIGINT in u)return BigInt(u[w.BIGINT]);if(w.SYMBOL in u)return Symbol.for(u[w.SYMBOL]);if(w.DATE in u)return new Date(u[w.DATE]);if(w.REGEXP in u){let h=u[w.REGEXP];return new RegExp(h.source,h.flags)}if(w.MAP in u)return new Map(u[w.MAP]);if(w.SET in u)return new Set(u[w.SET]);if(Array.isArray(u))return u.map(o);let d={};for(let[h,f]of Object.entries(u))d[h]=o(f);return d},s=o(t);function l(u,d){let h=r.$;if(u&&h)for(let g of u.split(".")){if(!g)continue;let S=h[g];if(!S||typeof S!="object"&&typeof S!="function"){h=void 0;break}h=S}let f=h?.[d];return D(f)?f:void 0}function m(u,d,h=""){if(!(!u||!d))for(let f in d){if(!Object.prototype.hasOwnProperty.call(d,f))continue;let g=d[f],S=u[f],k=D(S)||typeof S=="function"&&"set"in S&&typeof S.set=="function"?S:l(h,f);if(k){k.set(g);continue}g&&typeof g=="object"&&!Array.isArray(g)&&S&&(typeof S=="object"||typeof S=="function"&&!("set"in S))&&!D(S)&&m(S,g,h?`${h}.${f}`:f)}}let p=n?.nodeMap;if(p&&Object.keys(p).length>0){if(p[""]==="r"){let u=r.$;u&&typeof u.set=="function"&&u.set(s)}for(let[u,d]of Object.entries(p)){if(u===""||d!=="b")continue;let h=u.split(/\.|\[|\]/).filter(Boolean),f=r.$;for(let g of h){if(!f)break;f=f[g]??void 0}if(f&&(D(f)||typeof f=="function"&&"set"in f&&typeof f.set=="function")){let g=s;for(let S of h){if(g==null){g=void 0;break}if(typeof g=="object")g=g[S];else{g=void 0;break}}try{f.set(g)}catch{}}}m(r.state,s);return}m(r.state,s)};function i(t,n){if(!n)return t;if(t===void 0)return{[w.UNDEFINED]:!0};if(typeof t=="number")return Number.isNaN(t)?{[w.NAN]:!0}:t===1/0?{[w.INFINITY]:!0}:t===-1/0?{[w.NEG_INFINITY]:!0}:t;if(typeof t=="bigint")return{[w.BIGINT]:String(t)};if(typeof t=="symbol")return{[w.SYMBOL]:String(t)};if(t instanceof Date)return{[w.DATE]:t.toISOString()};if(t instanceof RegExp)return{[w.REGEXP]:{source:t.source,flags:t.flags}};if(t instanceof Map)return{[w.MAP]:Array.from(t.entries())};if(t instanceof Set)return{[w.SET]:Array.from(t.values())};if(Array.isArray(t))return t.map(o=>i(o,n));if(t&&typeof t=="object"){let o={};for(let[s,l]of Object.entries(t))o[s]=i(l,n);return o}return t}return a.serialize=t=>{let n=M(M(M({},me),c),t),o=U(r.state,new WeakSet,0,n.maxDepth,n.preserveTypes),s=i(o,n.preserveTypes),l=n.handleCircular?J(s):[],m={data:s},p={};try{let h=r.$;h&&typeof h.set=="function"&&(p[""]="r");let f=new WeakSet,g=k=>D(k)||typeof k=="function"&&"set"in k&&typeof k.set=="function",S=(k,I="")=>{if(!k||typeof k!="object"&&typeof k!="function")return;let A=k;if(!f.has(A)){f.add(A),I&&g(k)&&(p[I]="b");for(let[R,C]of Object.entries(k)){let K=I?`${I}.${R}`:R;S(C,K)}}};h&&S(h)}catch{}n.includeMetadata&&(m.metadata=M(M({timestamp:Date.now(),version:"1.0.0"},l.length>0&&{circularRefs:l}),Object.keys(p).length>0&&{nodeMap:p}));let u=Te(n);return JSON.stringify(m,u,2)},a.deserialize=(t,n)=>{let o=M(M(M({},me),c),n);try{let s=JSON.parse(t),{data:l,metadata:m}=s;m?.circularRefs&&o.handleCircular&&de(l,m.circularRefs),a.fromJSON(l,m),r.__config?.debugMode&&console.log("[SignalTree] State restored from serialized data",{timestamp:m?.timestamp,version:m?.version})}catch(s){throw console.error("[SignalTree] Failed to deserialize:",s),new Error(`Failed to deserialize SignalTree state: ${s instanceof Error?s.message:"Unknown error"}`)}},a.snapshot=()=>{let t=a.toJSON(),n=J(t);return{data:JSON.parse(JSON.stringify(t)),metadata:M({timestamp:Date.now(),version:"1.0.0"},n.length>0&&{circularRefs:n})}},a.restore=t=>{let{data:n,metadata:o}=t;o?.circularRefs&&de(n,o.circularRefs),a.fromJSON(n,o)},a};return e.metadata={name:"serialization"},e}var F=performance,fe=new Set;function ke(c,e,r){if(e==null)return c;let a=Math.min(c,e);return a<c&&r&&!fe.has(r)&&(console.warn(`[BenchRunner] Cap applied to ${r}: requested=${c}, cap=${e}. You can raise this in configuration for scaling tests.`),fe.add(r)),a}function Me(c){if(typeof queueMicrotask=="function"){queueMicrotask(c);return}if(typeof MessageChannel<"u"){let e=new MessageChannel;e.port1.onmessage=()=>{c()},e.port2.postMessage(0);return}setTimeout(c,0)}function ne(){let c=window.requestIdleCallback;return typeof c=="function"?new Promise(e=>{c(()=>e(),{timeout:50})}):new Promise(e=>Me(e))}function ve(){let c=!1,e;function r(a,i){e=a,!c&&(c=!0,requestAnimationFrame(()=>{c=!1;try{i?.(e)}finally{e=void 0}}))}return{schedule:r}}var Ee=ve(),B=class{static percentile(e,r){if(e.length===0)return 0;let a=Math.ceil(r/100*e.length)-1;return e[Math.max(0,Math.min(a,e.length-1))]}static standardDeviation(e){if(e.length===0)return 0;let r=e.reduce((t,n)=>t+n,0)/e.length,i=e.map(t=>Math.pow(t-r,2)).reduce((t,n)=>t+n,0)/e.length;return Math.sqrt(i)}static removeStatisticalOutliers(e,r=.2){if(e.length<4)return e;let a=[...e].sort((m,p)=>m-p),i=this.percentile(a,25),t=this.percentile(a,75),n=t-i,o=i-1.5*n,s=t+1.5*n,l=e.filter(m=>m>=o&&m<=s);return l.length<e.length*(1-r)?e:l}static assessReliability(e,r){if(e.length<10)return{reliability:"low",coefficientOfVariation:0,recommendation:"Sample size too small for reliable measurement"};if(r<50)return{reliability:"low",coefficientOfVariation:0,recommendation:"Total runtime too short for reliable timing measurement"};let a=e.reduce((o,s)=>o+s,0)/e.length,i=a>0?this.standardDeviation(e)/a:0,t,n;return i<.05?(t="high",n="Excellent measurement stability - high confidence in results"):i<.15?(t="medium",n="Good measurement stability - results are likely reliable"):(t="low",n="High variability detected - consider checking for system interference or increasing sample size"),{reliability:t,coefficientOfVariation:i,recommendation:n}}static detectAnomalies(e){if(e.length<10)return{outliers:[],anomalyCount:0,anomalyRate:0,recommendation:"Sample size too small for reliable anomaly detection"};let r=[...e].sort((p,u)=>p-u),a=this.percentile(r,25),i=this.percentile(r,75),t=i-a,n=a-1.5*t,o=i+1.5*t,s=e.filter(p=>p<n||p>o),l=s.length/e.length,m;return l>.2?m="High anomaly rate detected - check for system interference, GC pressure, or thermal throttling":l>.1?m="Moderate anomaly rate - consider increasing sample size or checking environment":l>.05?m="Low anomaly rate - results are likely reliable":m="Very low anomaly rate - high confidence in results",{outliers:s,anomalyCount:s.length,anomalyRate:l,recommendation:m}}};function he(){return y(this,null,function*(){"gc"in window&&typeof window.gc=="function"&&window.gc?.();let c=new Array(1e6).fill(0);yield ne(),c.length=0,yield new Promise(e=>setTimeout(e,100))})}function W(c,e){return y(this,null,function*(){let{warmup:r=5,operations:a,yieldEvery:i=0,trackMemory:t=!1,label:n="benchmark",measurementSamples:o=30,maxRuntimeMs:s=3e4,removeOutliers:l=!0,minSamples:m=10,forceGC:p=!1,operationsCap:u,minDurationMs:d=100,onProgress:h}=e,f=ke(a,u,n);p&&(yield he()),console.debug(`[${n}] Starting warmup (${r} iterations)`);for(let v=0;v<r;v++)yield c(v),i&&(v+1)%i===0&&(yield ne());p&&(yield he());let g=[],S=t&&F.memory?F.memory.usedJSHeapSize:void 0,k=0,I=0;for(console.debug(`[${n}] Starting measurement phase`);g.length<o&&k<s||k<d&&g.length<o*3;){let v=performance.now();for(let P=0;P<f;P++)yield c(P);let _=performance.now()-v;g.push(_),k+=_,I+=f,typeof h=="function"&&Ee.schedule({samplesCollected:g.length,elapsedMs:k},P=>h(P)),g.length%10===0&&(yield ne())}let A=t&&F.memory?F.memory.usedJSHeapSize:void 0,R=l?B.removeStatisticalOutliers(g):g;R.length<m&&(console.warn(`[${n}] Insufficient samples after outlier removal, using raw samples`),R=g);let C=[...R].sort((v,_)=>v-_),K=C.reduce((v,_)=>v+_,0)/C.length,Q=B.assessReliability(R,k),re=B.detectAnomalies(g),H=E(M({median:B.percentile(C,50),mean:K,min:C[0],max:C[C.length-1],p95:B.percentile(C,95),p99:B.percentile(C,99),stdDev:B.standardDeviation(C),samples:R,sampleCount:R.length,totalIterations:I,totalRuntimeMs:k},t&&S!==void 0&&A!==void 0&&{memoryDeltaMB:(A-S)/(1024*1024)}),{reliability:Q.reliability,coefficientOfVariation:Q.coefficientOfVariation,outlierCount:re.anomalyCount,anomalyRate:re.anomalyRate,recommendation:Q.recommendation});function pe(v,_){if(!v||v.length===0)return!1;let P=v.length;if(v.filter($=>$===0).length/P>=.25)return!0;let q=new Map;for(let $ of v){let ae=Math.round($*10)/10;q.set(ae,(q.get(ae)??0)+1)}let j=0;for(let $ of q.values())$>j&&(j=$);return j/P>=.35&&_<.5}try{if(!!!e.__adaptiveAttempted&&pe(g,H.median)){let P=Math.max(d*4,500),Z=Math.max(o*2,o+10);console.warn(`[${n}] Quantization detected in samples \u2014 rerunning with minDurationMs=${P} and measurementSamples=${Z}`);let q=E(M({},e),{minDurationMs:P,measurementSamples:Z,__adaptiveAttempted:!0});return yield W(c,q)}}catch(v){console.warn(`[${n}] Adaptive re-measure failed: ${v.message}`)}return console.debug(`[${n}] Completed: ${I} total iterations, ${g.length} samples, ${k.toFixed(1)}ms total, reliability: ${H.reliability}, CV: ${(H.coefficientOfVariation*100).toFixed(1)}%`),H})}var X=class{static compareBenchmarks(e,r,a,i,t=.95){let n=e.median-a.median,o=a.median>0?(a.median-e.median)/a.median*100:0,s=this.bootstrapMedianDifference(e.samples,a.samples,1e3,t),l=this.mannWhitneyUTest(e.samples,a.samples),m=this.cohensD(e.samples,a.samples),p;return l.isSignificant?n<0?p=`${r} is significantly faster than ${i}`:p=`${i} is significantly faster than ${r}`:p="No statistically significant difference detected",{library1:r,library2:i,medianDifference:n,percentageImprovement:o,isStatisticallySignificant:l.isSignificant,confidenceInterval:[s.lowerBound,s.upperBound],effectSize:m.effectSize,effectSizeInterpretation:m.interpretation,conclusion:p}}static bootstrapMedianDifference(e,r,a=1e3,i=.95){let t=[];for(let l=0;l<a;l++){let m=this.bootstrapSample(e),p=this.bootstrapSample(r),u=B.percentile([...m].sort((d,h)=>d-h),50)-B.percentile([...p].sort((d,h)=>d-h),50);t.push(u)}t.sort((l,m)=>l-m);let n=1-i,o=Math.floor(n/2*a),s=Math.floor((1-n/2)*a);return{lowerBound:t[o],upperBound:t[s]}}static mannWhitneyUTest(e,r){let a=e.length,i=r.length,t=[...e.map(l=>({value:l,group:1})),...r.map(l=>({value:l,group:2}))].sort((l,m)=>l.value-m.value),n=0;for(let l=0;l<t.length;l++)t[l].group===1&&(n+=l+1);let o=n-a*(a+1)/2,s=Math.min(o,a*i-o);if(a>20&&i>20){let l=a*i/2,m=Math.sqrt(a*i*(a+i+1)/12),p=Math.abs((s-l)/m),u=2*(1-this.normalCDF(p));return{isSignificant:u<.05,pValue:u}}return{isSignificant:!1,pValue:1}}static cohensD(e,r){let a=e.reduce((p,u)=>p+u,0)/e.length,i=r.reduce((p,u)=>p+u,0)/r.length,t=this.variance(e),n=this.variance(r),o=Math.sqrt(((e.length-1)*t+(r.length-1)*n)/(e.length+r.length-2)),s=(a-i)/o,l=Math.abs(s),m;return l<.2?m="Negligible effect":l<.5?m="Small effect":l<.8?m="Medium effect":m="Large effect",{effectSize:s,interpretation:m}}static normalCDF(e){return .5*(1+this.erf(e/Math.sqrt(2)))}static erf(e){let r=.254829592,a=-.284496736,i=1.421413741,t=-1.453152027,n=1.061405429,o=.3275911,s=e<0?-1:1;e=Math.abs(e);let l=1/(1+o*e),m=1-((((n*l+t)*l+i)*l+a)*l+r)*l*Math.exp(-e*e);return s*m}static variance(e){let r=e.reduce((a,i)=>a+i,0)/e.length;return e.reduce((a,i)=>a+Math.pow(i-r,2),0)/(e.length-1)}static bootstrapSample(e){let r=[];for(let a=0;a<e.length;a++){let i=Math.floor(Math.random()*e.length);r.push(e[i])}return r}},G=class{static detectPerformanceThrottling(){return y(this,null,function*(){let r=performance.now(),a=0;for(let s=0;s<1e5;s++)a+=Math.sqrt(s)*Math.sin(s);let t=1e5/(performance.now()-r),n=t<300,o;return n?o="Performance throttling detected. Consider: closing other tabs, plugging in laptop, checking thermal throttling, or running in incognito mode.":t<500?o="Moderate performance detected. Results may have higher variance.":o="Good performance environment detected.",a===1/0&&console.log("Calibration complete"),{isThrottled:n,opsPerMs:t,recommendation:o}})}static validateEnvironment(){return y(this,null,function*(){let e=[],r=[],a=yield this.detectPerformanceThrottling();if(a.isThrottled&&(e.push("Performance throttling detected"),r.push(a.recommendation)),F.memory){let t=F.memory;t.usedJSHeapSize/t.jsHeapSizeLimit*100>80&&(e.push("High memory usage detected"),r.push("Consider closing other tabs or refreshing the page to free memory"))}return"requestIdleCallback"in window||r.push("Browser lacks requestIdleCallback support - timing may be less accurate"),window.outerHeight-window.innerHeight>160&&r.push("Developer tools appear to be open - this may affect performance measurements"),{isReady:e.length===0,issues:e,recommendations:r}})}};var ge=class c{yieldBetweenBenchmarks(){return y(this,null,function*(){return new Promise(e=>{requestAnimationFrame(()=>{setTimeout(e,0)})})})}yieldToUI=ie();getRuntimeMemoMode(){try{let e=window.__SIGNALTREE_MEMO_MODE;if(e==="off"||e==="light"||e==="shallow"||e==="full")return e}catch{}return"light"}runDeepNestedBenchmark(e,r=15){return y(this,null,function*(){let a=performance.now(),i=n=>n===0?{value:0,data:"test"}:{level:i(n-1)},t=T(i(r)).with(z(),Y());for(let n=0;n<Math.min(e,b.ITERATIONS.DEEP_NESTED);n++){let o=t.state;for(let s=0;s<r&&o?.level;s++)o=o.level;o?.value&&typeof o.value.set=="function"?o.value.set(n):typeof o?.value=="function"&&o.value(n)}return performance.now()-a})}runArrayBenchmark(e){return y(this,null,function*(){let r=performance.now(),a=T({items:Array.from({length:e},(t,n)=>({id:n,value:Math.random()*1e3}))}).with(N()),i=Math.min(b.ITERATIONS.ARRAY_UPDATES,e);for(let t=0;t<i;t++){let n=t%e;a.state.items.update(o=>(o[n].value=Math.random()*1e3,o))}return performance.now()-r})}runComputedBenchmark(e){return y(this,null,function*(){let r=performance.now(),a=T({value:0,factors:Array.from({length:50},(t,n)=>n+1)}).with(z()).with(ue()),i=x(()=>{let t=a.state.value(),n=0;for(let o of a.state.factors())n+=Math.sin(t*o)*Math.cos(o);return n});for(let t=0;t<Math.min(e,b.ITERATIONS.COMPUTED);t++)a.state.value.set(t),i(),t&1023;return performance.now()-r})}runBatchUpdatesBenchmark(e=100,r=1e3){return y(this,null,function*(){let a=performance.now(),i=T({items:Array.from({length:r},(t,n)=>n)}).with(N());for(let t=0;t<e;t++)i.state.items.update(n=>{for(let o=0;o<r;o++)n[o]=n[o]+1|0;return n});return performance.now()-a})}runSelectorBenchmark(e){return y(this,null,function*(){let r=performance.now(),a=T({items:Array.from({length:e},(o,s)=>({id:s,flag:s%2===0,value:Math.random()*100,metadata:{category:s%5,priority:s%3}}))}).with(le()),i=x(()=>a.state.items().filter(o=>o.flag).length),t=x(()=>a.state.items().filter(o=>o.value>50).length),n=x(()=>a.state.items().reduce((s,l)=>{let m=l.metadata.category;return s[m]=(s[m]||0)+1,s},{}));for(let o=0;o<b.ITERATIONS.SELECTOR;o++)i(),t(),n(),(o&b.YIELD_FREQUENCY.SELECTOR)===0&&a.state.items.update(s=>{let l=o%s.length;return s[l].flag=!s[l].flag,s});return performance.now()-r})}runSerializationBenchmark(e){return y(this,null,function*(){let r=T({users:Array.from({length:Math.max(b.DATA_SIZE_LIMITS.USER_SIMULATION.MIN,Math.min(b.DATA_SIZE_LIMITS.USER_SIMULATION.MAX,e))},(o,s)=>({id:s,name:`User ${s}`,roles:s%5===0?["admin","user"]:["user"],active:s%3===0,meta:{createdAt:new Date(2020,0,1+s%28)}})),settings:{theme:"dark",flags:{a:!0,b:!1,c:a(8).reduce((o,s)=>E(M({},o),{[s]:s%2===0}),{})}}}).with(O(),N(),te({preserveTypes:!1,includeMetadata:!1}));function a(o){return Array.from({length:o},(s,l)=>l)}for(let o=0;o<10;o++)r.state.users.update(s=>{let l=o%s.length;return s[l].active=!s[l].active,s});let i=performance.now(),t=r.snapshot();return JSON.stringify({data:t.data}),performance.now()-i})}runConcurrentUpdatesBenchmark(e=50,r=200){return y(this,null,function*(){let a=T({counters:Array.from({length:e},()=>({value:0}))}).with(z()),i=performance.now();for(let t=0;t<r;t++)for(let n=0;n<e;n++){let o=n;a.state.counters.update(s=>s.map((l,m)=>m===o?E(M({},l),{value:l.value+1|0}):l))}return performance.now()-i})}runMemoryEfficiencyBenchmark(e){return y(this,null,function*(){let r=Math.max(b.DATA_SIZE_LIMITS.ENTITY_COUNT.MIN,Math.min(b.DATA_SIZE_LIMITS.ENTITY_COUNT.MAX,e)),a=Math.max(10,Math.min(200,Math.floor(r/250))),i=T({groups:Array.from({length:a},(o,s)=>({id:s,items:Array.from({length:Math.floor(r/a)},(l,m)=>({id:s*1e6+m,score:m*13%997,tags:m%7===0?["hot","new"]:["cold"]}))}))}).with(L(),z()),t=performance.now(),n=Math.max(100,Math.floor(r*.01));for(let o=0;o<n;o++){let s=o%a;i.state.groups.update(l=>{let m=[...l],p=m[s];return p&&p.items&&(m[s]=E(M({},p),{items:p.items.map((u,d)=>{let h=o%p.items.length;return d===h?E(M({},u),{score:u.score+1|0,tags:(o&63)===0?u.tags.includes("hot")?["cold"]:["hot"]:u.tags}):u})})),m})}return performance.now()-t})}runDataFetchingBenchmark(e){return y(this,null,function*(){let r=performance.now(),a=Array.from({length:Math.min(e,b.DATA_SIZE_LIMITS.USER_SIMULATION.MAX)},(t,n)=>({id:n,title:`Item ${n}`,description:`Description for item ${n}`,tags:[`tag${n%10}`,`category${n%5}`],meta:{createdAt:new Date(2023,0,1+n%365),updatedAt:new Date(2023,6,1+n%180),views:Math.floor(Math.random()*1e3),rating:Math.random()*5},relations:{authorId:Math.floor(n/10),parentId:n>0?n-1:null,childIds:n<e-1?[n+1]:[]}})),i=T({items:[],metadata:{total:0,loaded:!1,lastFetch:null},filters:{search:"",category:"",tags:[]},pagination:{page:1,size:50,total:0}}).with(z(),Y());i.state.metadata.loaded.set(!1),i.state.items.set(a),i.state.metadata.total.set(a.length),i.state.metadata.lastFetch.set(new Date),i.state.metadata.loaded.set(!0);for(let t=0;t<Math.min(b.ITERATIONS.BATCH_UPDATES,e/10);t++){i.state.filters.search.set(`search${t}`),i.state.filters.category.set(`cat${t%5}`);let n=i.state.items().filter(o=>o.title.includes(i.state.filters.search())||o.tags.includes(i.state.filters.category()));i.state.pagination.total.set(n.length)}return performance.now()-r})}runRealTimeUpdatesBenchmark(e){return y(this,null,function*(){let r=performance.now(),a=T({liveMetrics:{activeUsers:0,totalSessions:0,pageViews:0,serverLoad:0,responseTime:0},recentEvents:[],notifications:[],alerts:[]}).with(N(),L()),i=Math.min(b.ITERATIONS.REAL_TIME_UPDATES,e);for(let t=0;t<i;t++)a.state.liveMetrics.activeUsers.update(n=>n+Math.floor(Math.random()*10-5)),a.state.liveMetrics.pageViews.update(n=>n+Math.floor(Math.random()*20)),a.state.liveMetrics.serverLoad.set(Math.random()),a.state.liveMetrics.responseTime.set(50+Math.random()*200),(t&b.YIELD_FREQUENCY.DATA_FETCHING)===0&&a.state.recentEvents.update(n=>[...n.slice(-99),{id:t,type:"user_action",timestamp:Date.now(),data:`event${t}`}]),(t&b.YIELD_FREQUENCY.REAL_TIME_UPDATES)===0&&a.state.notifications.update(n=>[...n.slice(-9),{id:t,message:`Notification ${t}`,priority:"normal",timestamp:Date.now()}]);return performance.now()-r})}runStateSizeScalingBenchmark(e){return y(this,null,function*(){let r=performance.now(),a=Array.from({length:Math.min(e*b.DATA_SIZE_LIMITS.LARGE_DATASET.MULTIPLIER,b.DATA_SIZE_LIMITS.LARGE_DATASET.MAX)},(n,o)=>({id:o,name:`Entity ${o}`,properties:Array.from({length:20},(s,l)=>({key:`prop_${l}`,value:`value_${o}_${l}`,metadata:{type:"string",indexed:l%3===0}})),relations:Array.from({length:Math.min(5,o)},(s,l)=>({targetId:o-l-1,type:"reference"}))})),i=T({entities:a,indices:{},cache:{},stats:{size:0,lastUpdate:null}}).with(L(),z());i.state.stats.size.set(a.length),i.state.stats.lastUpdate.set(new Date);let t=Math.min(b.ITERATIONS.STATE_SIZE_SCALING,e/5);for(let n=0;n<t;n++){let o=n%a.length;i.state.entities.update(s=>{let l=s[o];return l&&(l.properties[0].value=`updated_${Date.now()}`),s}),(n&b.YIELD_FREQUENCY.REAL_TIME_UPDATES)===0&&i.state.cache.update(s=>E(M({},s),{[`cache_${n}`]:{computed:Math.random(),timestamp:Date.now()}}))}return performance.now()-r})}runAsyncWorkflowBenchmark(e){return y(this,null,function*(){let r=T({items:[],loading:!1,error:null}).with(N()),a=d=>y(null,null,function*(){return yield new Promise(h=>setTimeout(h,b.TIMING.ASYNC_DELAY_MS)),Array.from({length:d},(h,f)=>({id:f,value:f}))}),i=performance.now(),t=Math.min(Math.max(1,Math.floor(e/10)),b.ITERATIONS.ASYNC_WORKFLOW),n=Math.min(8,Math.max(1,t)),o=Math.max(1,Math.floor(e/Math.max(t,10))),s=new Array(e),l=0;function m(d,h){return y(this,null,function*(){let f=0;for(;f<d.length;){let g=d.slice(f,f+n);yield Promise.all(g.map(S=>h(S))),f+=n}})}r.state.loading.set(!0),r.state.error.set(null);let p=()=>y(null,null,function*(){try{let d=yield a(Math.min(o,e)),h=r.preallocateArray;if(h){let f=h("items",s.length);for(let g=0;g<d.length;g++){let S=(l+g)%s.length;f.update(S,d[g])}f.commit(),l=(l+d.length)%s.length}else if(r.batch)r.batch(()=>{for(let f=0;f<d.length;f++){let g=(l+f)%s.length;s[g]=d[f]}r.state.items.set(s),l=(l+d.length)%s.length});else{let f=l;for(let g=0;g<d.length;g++){let S=(f+g)%s.length;s[S]=d[g]}r.state.items.set(s.slice()),l=(l+d.length)%s.length}}catch(d){r.state.error.set(d?.message??String(d))}}),u=Array.from({length:t},(d,h)=>h);return yield m(u,p),r.state.loading.set(!1),performance.now()-i})}runConcurrentAsyncBenchmark(e){return y(this,null,function*(){let r=T({results:[],activeOperations:0}),a=n=>y(null,null,function*(){r.state.activeOperations.update(s=>s+1),yield new Promise(s=>setTimeout(s,Math.random()*b.TIMING.RANDOM_DELAY_MAX_MS));let o={id:n,value:Math.random()};r.state.results.update(s=>[...s,o]),r.state.activeOperations.update(s=>s-1)}),i=performance.now(),t=Array.from({length:e},(n,o)=>a(o));return yield Promise.all(t),performance.now()-i})}runAsyncCancellationBenchmark(e){return y(this,null,function*(){let r=T({activeRequest:null,result:null,cancelled:0}),a=performance.now();for(let i=0;i<e;i++){let t=r.state.activeRequest();t&&(t.abort(),r.state.cancelled.update(o=>o+1));let n=new AbortController;r.state.activeRequest.set(n);try{yield new Promise((o,s)=>{let l=setTimeout(()=>{n.signal.aborted||(r.state.result.set({id:i,data:"completed"}),o(null))},5);n.signal.addEventListener("abort",()=>{clearTimeout(l),s(new Error("Cancelled"))})})}catch{}}return performance.now()-a})}runUndoRedoBenchmark(e){return y(this,null,function*(){let r=T({counter:0,data:{value:"initial"}}).with(V()),a=performance.now();for(let i=0;i<e;i++)r.state.counter.set(i),r.state.data({value:`step_${i}`});for(let i=0;i<e/2;i++)r.undo?.();for(let i=0;i<e/4;i++)r.redo?.();return performance.now()-a})}runHistorySizeBenchmark(e){return y(this,null,function*(){let r=T({value:0,data:{content:"initial"}}).with(V({maxHistorySize:e})),a=performance.now();for(let i=0;i<e;i++)r.state.value.set(i),r.state.data({content:`step_${i}`});return performance.now()-a})}runJumpToStateBenchmark(e){return y(this,null,function*(){let r=T({currentState:0,data:{value:"initial"}}).with(V()),a=performance.now();for(let i=0;i<e;i++)r.state.currentState.set(i),r.state.data({value:`state_${i}`});for(let i=0;i<e;i++){let t=Math.floor(Math.random()*e);r.jumpToStep?.(t)}return performance.now()-a})}runSingleMiddlewareBenchmark(e){return y(this,null,function*(){let r=T({value:0,middlewareLog:[]}),a=(t,n)=>{r.state.middlewareLog.update(o=>[...o.slice(-100),`${t}:${n}`])},i=performance.now();for(let t=0;t<e;t++)a("setValue",t),r.state.value.set(t);return performance.now()-i})}runMultipleMiddlewareBenchmark(e,r){return y(this,null,function*(){let a=T({value:0,logs:Array.from({length:e},()=>[])}),i=Array.from({length:e},(n,o)=>(s,l)=>{a.state.logs()[o].push(`MW${o}:${s}:${l}`)}),t=performance.now();for(let n=0;n<r;n++)i.forEach(o=>o("setValue",n)),a.state.value.set(n);return performance.now()-t})}runConditionalMiddlewareBenchmark(e){return y(this,null,function*(){let r=T({value:0,conditionalLog:[],condition:!0}),a=(t,n)=>{r.state.condition()&&r.state.conditionalLog.update(o=>[...o.slice(-50),`${t}:${n}`])},i=performance.now();for(let t=0;t<e;t++)(t&b.YIELD_FREQUENCY.DATA_FETCHING)===0&&r.state.condition.set(!r.state.condition()),a("setValue",t),r.state.value.set(t);return performance.now()-i})}runAllFeaturesEnabledBenchmark(e){return y(this,null,function*(){let r=T({data:[],loading:!1,history:[],middlewareLog:[]}).with(O(),z(),te()),a=performance.now(),i=Math.min(e/100,b.ITERATIONS.ASYNC_WORKFLOW);for(let t=0;t<i;t++)r.state.loading.set(!0),yield new Promise(n=>setTimeout(n,b.TIMING.TIMEOUT_DELAY_MS)),r.state.data.update(n=>[...n,{id:t,value:Math.random()}]),r.state.loading.set(!1),r.state.history.update(n=>[...n.slice(-20),{action:"update",id:t}]),r.state.middlewareLog.update(n=>[...n.slice(-30),`action_${t}`]);return performance.now()-a})}runEnhancedArrayBenchmark(e){return y(this,null,function*(){let r={operations:Math.min(b.ITERATIONS.ARRAY_UPDATES,e),warmup:10,measurementSamples:30,yieldEvery:b.YIELD_FREQUENCY.ARRAY_UPDATES,trackMemory:!0,removeOutliers:!0,forceGC:!0,label:"SignalTree Array Updates",minDurationMs:100},a=T({items:Array.from({length:e},(i,t)=>({id:t,value:Math.random()*1e3}))}).with(N());return W(i=>y(null,null,function*(){let t=i%e;a.state.items.update(n=>{let o=[...n];return o[t]=E(M({},o[t]),{value:Math.random()*1e3}),o})}),r)})}runEnhancedSelectorBenchmark(e){return y(this,null,function*(){let r=T({items:Array.from({length:e},(t,n)=>({id:n,flag:n%2===0}))}).with(L()),a=x(()=>r.state.items().filter(t=>t.flag).length);return W(()=>y(null,null,function*(){a()}),{operations:1e3,warmup:5,measurementSamples:50,yieldEvery:64,trackMemory:!1,removeOutliers:!0,label:"SignalTree Selector (Memoized)",minDurationMs:50})})}runEnhancedDeepNestedBenchmark(e,r=15){return y(this,null,function*(){let a=n=>n===0?{value:0,data:"test"}:{level:a(n-1)},i=T(a(r)).with(z(),Y()),t={operations:Math.min(e,1e3),warmup:5,measurementSamples:20,yieldEvery:1024,trackMemory:!0,removeOutliers:!0,forceGC:!0,label:"SignalTree Deep Nested Updates",minDurationMs:100};return W(n=>y(null,null,function*(){i.update(o=>{let s=(l,m)=>m===0?E(M({},l),{value:n}):E(M({},l),{level:s(l.level??{},m-1)});return s(o,r-1)})}),t)})}runPureArrayBenchmark(e){return y(this,null,function*(){let r=T({items:Array.from({length:e},(t,n)=>({id:n,value:Math.random()*1e3}))}).with(N()),a=Math.min(b.ITERATIONS.ARRAY_UPDATES,e),i=performance.now();for(let t=0;t<a;t++){let n=t%e;r.state.items.update(o=>{let s=[...o];return s[n]=E(M({},s[n]),{value:Math.random()*1e3}),s})}return performance.now()-i})}runPureSelectorBenchmark(e){return y(this,null,function*(){let r=T({items:Array.from({length:e},(t,n)=>({id:n,flag:n%2===0}))}).with(L()),a=x(()=>r.state.items().filter(t=>t.flag).length),i=performance.now();for(let t=0;t<b.ITERATIONS.SELECTOR;t++)a();return performance.now()-i})}runPureDeepNestedBenchmark(e,r=15){return y(this,null,function*(){let a=o=>o===0?{value:0,data:"test"}:{level:a(o-1)},i=T(a(r)).with(z(),Y()),t=Math.min(e,b.ITERATIONS.DEEP_NESTED),n=performance.now();for(let o=0;o<t;o++)i.update(s=>{let l=(m,p)=>p===0?E(M({},m),{value:o}):E(M({},m),{level:l(m.level??{},p-1)});return l(s,r-1)});return performance.now()-n})}runPureBenchmarkSuite(e){return y(this,null,function*(){let r=performance.now();yield this.yieldBetweenBenchmarks(),console.log("\u{1F3AF} Starting Pure Array Benchmark...");let a=yield this.runPureArrayBenchmark(e);yield this.yieldBetweenBenchmarks(),console.log("\u{1F3AF} Starting Pure Selector Benchmark...");let i=yield this.runPureSelectorBenchmark(e);yield this.yieldBetweenBenchmarks(),console.log("\u{1F3AF} Starting Pure Deep Nested Benchmark...");let t=yield this.runPureDeepNestedBenchmark(e),n=performance.now()-r;return console.log(`\u2705 Pure Benchmark Suite Complete:
      \u2022 Array: ${a.toFixed(2)}ms
      \u2022 Selector: ${i.toFixed(2)}ms
      \u2022 Deep Nested: ${t.toFixed(2)}ms
      \u2022 Total: ${n.toFixed(2)}ms`),{arrayBenchmark:a,selectorBenchmark:i,deepNestedBenchmark:t,totalTime:n}})}validateBenchmarkEnvironment(){return y(this,null,function*(){let e=yield G.validateEnvironment(),r=yield G.detectPerformanceThrottling();return E(M({},e),{performanceMetrics:{isThrottled:r.isThrottled,opsPerMs:r.opsPerMs}})})}static compareWithLibrary(e,r,a){return X.compareBenchmarks(e,"SignalTree",r,a,.95)}runComprehensiveBenchmarkSuite(e){return y(this,null,function*(){let r=yield this.validateBenchmarkEnvironment();r.isReady||console.warn("Benchmark environment validation failed:",r.issues);let[a,i,t]=yield Promise.all([this.runEnhancedArrayBenchmark(e),this.runEnhancedSelectorBenchmark(e),this.runEnhancedDeepNestedBenchmark(e)]),n=[a,i,t],o=n.map(u=>u.reliability),s=o.includes("low")?"low":o.includes("medium")?"medium":"high",l=n.reduce((u,d)=>u+d.sampleCount,0),m=n.reduce((u,d)=>u+d.totalRuntimeMs,0),p=[];return n.forEach(u=>{u.reliability==="low"&&p.push(u.recommendation),u.anomalyRate>.1&&p.push(`High anomaly rate in ${u.samples.length>0?"benchmark":"unknown benchmark"} - check for interference`)}),r.performanceMetrics.isThrottled&&p.push("Performance throttling detected - results may not reflect optimal performance"),{arrayBenchmark:a,selectorBenchmark:i,deepNestedBenchmark:t,environment:r,summary:{overallReliability:s,totalSamples:l,totalRuntime:m,recommendations:[...new Set(p)]}}})}demonstrateEnhancedBenchmarking(e=1e3){return y(this,null,function*(){console.log("\u{1F680} Starting Enhanced SignalTree Benchmark Demonstration");let r=yield this.validateBenchmarkEnvironment();console.log("Environment Check:",r),r.isReady||(console.warn("\u26A0\uFE0F Environment issues detected:",r.issues),console.log("\u{1F4A1} Recommendations:",r.recommendations)),console.log(`
\u{1F4CA} Running Enhanced Array Benchmark...`);let a=yield this.runEnhancedArrayBenchmark(e);console.log(`\u2705 Array Benchmark Complete:
      \u2022 Median: ${a.median.toFixed(2)}ms
      \u2022 Reliability: ${a.reliability}
      \u2022 CV: ${(a.coefficientOfVariation*100).toFixed(1)}%
      \u2022 Samples: ${a.sampleCount}
      \u2022 Memory \u0394: ${a.memoryDeltaMB?.toFixed(2)??"N/A"}MB`),console.log(`
\u{1F3AF} Running Enhanced Selector Benchmark...`);let i=yield this.runEnhancedSelectorBenchmark(e);console.log(`\u2705 Selector Benchmark Complete:
      \u2022 Median: ${i.median.toFixed(2)}ms
      \u2022 Reliability: ${i.reliability}
      \u2022 CV: ${(i.coefficientOfVariation*100).toFixed(1)}%
      \u2022 Samples: ${i.sampleCount}`),console.log(`
\u{1F4C8} Statistical Comparison Example:`);let t=c.compareWithLibrary(a,i,"Selector Benchmark");console.log(`Comparison Result:
      \u2022 Difference: ${t.medianDifference.toFixed(2)}ms
      \u2022 Improvement: ${t.percentageImprovement.toFixed(1)}%
      \u2022 Significant: ${t.isStatisticallySignificant}
      \u2022 Effect Size: ${t.effectSizeInterpretation}
      \u2022 Conclusion: ${t.conclusion}`),console.log(`
\u{1F389} Enhanced Benchmark Demonstration Complete!`)})}static \u0275fac=function(r){return new(r||c)};static \u0275prov=oe({token:c,factory:c.\u0275fac,providedIn:"root"})};export{ge as a};
